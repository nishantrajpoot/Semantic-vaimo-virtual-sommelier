"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/wine-advice/route";
exports.ids = ["app/api/wine-advice/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_nishant_project_v0_UI_Semantic_vaimo_virtual_sommelier_app_api_wine_advice_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/wine-advice/route.ts */ \"(rsc)/./app/api/wine-advice/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/wine-advice/route\",\n        pathname: \"/api/wine-advice\",\n        filename: \"route\",\n        bundlePath: \"app/api/wine-advice/route\"\n    },\n    resolvedPagePath: \"/home/nishant/project/v0/UI/Semantic-vaimo-virtual-sommelier/app/api/wine-advice/route.ts\",\n    nextConfigOutput,\n    userland: _home_nishant_project_v0_UI_Semantic_vaimo_virtual_sommelier_app_api_wine_advice_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/wine-advice/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3aW5lLWFkdmljZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGd2luZS1hZHZpY2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ3aW5lLWFkdmljZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGbmlzaGFudCUyRnByb2plY3QlMkZ2MCUyRlVJJTJGU2VtYW50aWMtdmFpbW8tdmlydHVhbC1zb21tZWxpZXIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZuaXNoYW50JTJGcHJvamVjdCUyRnYwJTJGVUklMkZTZW1hbnRpYy12YWltby12aXJ0dWFsLXNvbW1lbGllciZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUM7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aW5lLXNvbW1lbGllci1hZ2VudC8/NjkyZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvaG9tZS9uaXNoYW50L3Byb2plY3QvdjAvVUkvU2VtYW50aWMtdmFpbW8tdmlydHVhbC1zb21tZWxpZXIvYXBwL2FwaS93aW5lLWFkdmljZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS93aW5lLWFkdmljZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvaG9tZS9uaXNoYW50L3Byb2plY3QvdjAvVUkvU2VtYW50aWMtdmFpbW8tdmlydHVhbC1zb21tZWxpZXIvYXBwL2FwaS93aW5lLWFkdmljZS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/wine-advice/route.ts":
/*!**************************************!*\
  !*** ./app/api/wine-advice/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/ai/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ai-sdk/openai */ \"(rsc)/./node_modules/@ai-sdk/openai/dist/index.mjs\");\n// @ts-nocheck\n\n\n\n// Helper to parse price strings like \"13,99 €\" -> 13.99\nfunction parsePrice(priceStr) {\n    const num = priceStr.replace(/[^0-9,.-]/g, \"\").replace(\",\", \".\");\n    return parseFloat(num) || 0;\n}\nasync function POST(request) {\n    try {\n        const { message, language, wines, excludeIds, history } = await request.json();\n        // Initialize timing tracker for pipeline steps\n        const timings = [];\n        // Retrieval Augmented Generation: semantic search to pre-filter dataset\n        let candidates = wines;\n        if (true) {\n            // Time the semantic search step\n            const t0 = Date.now();\n            try {\n                const url = new URL(request.url);\n                url.pathname = \"/api/wines\";\n                url.searchParams.set(\"lang\", language);\n                url.searchParams.set(\"q\", message);\n                const resp = await fetch(url.toString(), {\n                    method: \"GET\"\n                });\n                if (resp.ok) {\n                    console.log(\"response-\", resp);\n                    candidates = await resp.json();\n                } else {\n                    console.warn(\"Semantic search failed:\", resp.status);\n                }\n            } catch (err) {\n                console.error(\"Semantic search error:\", err);\n            } finally{\n                timings.push({\n                    step: \"semantic_search\",\n                    duration: Date.now() - t0\n                });\n            }\n        }\n        // Exclude previously shown recommendations\n        if (Array.isArray(excludeIds) && excludeIds.length > 0) {\n            candidates = candidates.filter((w)=>!excludeIds.includes(w.id));\n        }\n        // Apply price filters if requested\n        const text = message.toLowerCase();\n        let priceMatch;\n        if (priceMatch = text.match(/(?:above|over|greater than)\\s*(\\d+)/i)) {\n            const threshold = parseFloat(priceMatch[1]);\n            candidates = candidates.filter((w)=>parsePrice(w.Price) > threshold);\n        } else if (priceMatch = text.match(/(?:under|less than|below)\\s*(\\d+)/i)) {\n            const threshold = parseFloat(priceMatch[1]);\n            candidates = candidates.filter((w)=>parsePrice(w.Price) < threshold);\n        } else if (/\\b(expensive|premium|high[- ]end|luxury)\\b/i.test(text)) {\n            // Compute 75th percentile price\n            const prices = candidates.map((w)=>parsePrice(w.Price)).sort((a, b)=>a - b);\n            if (prices.length > 0) {\n                const idx = Math.floor(prices.length * 0.75);\n                const threshold = prices[idx];\n                candidates = candidates.filter((w)=>parsePrice(w.Price) >= threshold);\n            }\n        }\n        // 'candidates' already excludes shown IDs and price constraints\n        const dataset = candidates;\n        // Generate AI response with filtered candidate dataset\n        // Include conversation history so AI retains context\n        // Build system prompt only using top 15 filtered candidates to reduce context size\n        const promptDataset = dataset.slice(0, 15);\n        let systemPrompt = getSystemPrompt(language, promptDataset);\n        if (Array.isArray(history) && history.length > 0) {\n            const convo = history.map((m)=>`${m.role === \"user\" ? \"User\" : \"Assistant\"}: ${m.content}`).join(\"\\n\");\n            systemPrompt += `\\n\\nConversation history:\\n${convo}`;\n        }\n        let userPrompt = `User query: \"${message}\"\n\nPlease analyze this query and recommend 7-8 specific wines from the available dataset. Consider:\n- Wine preferences (color, type, grape variety)\n- Budget constraints \n- Food pairings mentioned\n- Occasion or context\n- Handle typos and variations intelligently (e.g., \"red-wine\" = \"red wine\")\n- When recommending wines, take into account the \"food_pairing\", \"color\", \"type\", \"grape_variety\", \"price\", \"volume\", \"promotion\", \"country_origin\", \"Vegetarian\", \"Vegan\" fields of the dataset\n- In the context of food pairings suggestions, take into account the \"food_pairing\" field of the dataset\n\nRespond with wine advice and explain your recommendations.`;\n        // Instruct AI to exclude already recommended wines\n        if (Array.isArray(excludeIds) && excludeIds.length > 0) {\n            userPrompt += `\\n\\nExclude these wine IDs from recommendations: ${JSON.stringify(excludeIds)}`;\n        }\n        try {\n            // Check if API key is available\n            if (false) {}\n            const t1 = Date.now();\n            // Use a faster, lighter LLM and shorter max tokens for speed\n            const { text } = await (0,ai__WEBPACK_IMPORTED_MODULE_1__.generateText)({\n                model: (0,_ai_sdk_openai__WEBPACK_IMPORTED_MODULE_2__.openai)(\"gpt-3.5-turbo\"),\n                system: systemPrompt,\n                prompt: userPrompt,\n                maxTokens: 1000\n            });\n            const llmDuration = Date.now() - t1;\n            timings.push({\n                step: \"llm_call\",\n                duration: llmDuration\n            });\n            // Extract wine recommendations from GPT response\n            const t2 = Date.now();\n            const recommendations = extractRecommendationsFromResponse(text, dataset);\n            timings.push({\n                step: \"parse_response\",\n                duration: Date.now() - t2\n            });\n            const recs = recommendations.length > 0 ? recommendations : getSimpleFallback(message, dataset);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: text,\n                recommendations: recs,\n                timings\n            });\n        } catch (error) {\n            console.error(\"AI service error:\", error);\n            // Fallback to non-AI response if API fails\n            const fallbackRecs = getSimpleFallback(message, wines);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: generateFallbackResponse(message, wines, language),\n                recommendations: fallbackRecs,\n                timings\n            });\n        }\n    } catch (error) {\n        console.error(\"API route error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Simple fallback: pick wines based on basic keyword match in message\n */ function getSimpleFallback(message, wines) {\n    const lower = message.toLowerCase();\n    let filtered = [];\n    if (lower.includes(\"red\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"red\");\n    } else if (lower.includes(\"white\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"white\");\n    } else if (lower.includes(\"ros\") || lower.includes(\"rose\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"rose\");\n    } else if (lower.includes(\"sparkling\") || lower.includes(\"bubbl\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"sparkling\");\n    }\n    if (filtered.length >= 3) {\n        return filtered.slice(0, 3);\n    }\n    // default first 3\n    return wines.slice(0, 3);\n}\n/**\n * Extract up to 4 wine recommendations by matching their UUIDs in the AI response.\n */ function extractRecommendationsFromResponse(response, wines) {\n    // 1) Try to parse explicit ID list\n    const idSection = response.match(/RECOMMENDED_IDS:?\\s*\\[([^\\]]+)\\]/i);\n    console.log(\"idSection-\", idSection);\n    /*\n  if (idSection) {    \n    const ids = idSection[1]\n      .split(/[,\\s]+/)\n      .map((s) => s.replace(/\"/g, \"\").trim())\n      .filter((s) => s)\n    const found = wines.filter((wine) => ids.includes(wine.id!))\n    if (found.length > 0) {\n      return found.slice(0, 4)\n    }\n  }*/ if (idSection) {\n        const ids = idSection[1].split(/[,\\s]+/).map((s)=>s.replace(/\"/g, \"\").trim()).filter(Boolean);\n        console.log(\"ids-\", ids);\n        // Create a quick ID → wine lookup map\n        const wineMap = new Map(wines.map((w)=>[\n                w.id,\n                w\n            ]));\n        // Map IDs to wines in the exact order given by the model\n        const foundOrdered = ids.map((id)=>wineMap.get(id)).filter((wine)=>Boolean(wine)) // remove undefined\n        ;\n        console.log(\"foundOrdered-\", foundOrdered);\n        if (foundOrdered.length > 0) return foundOrdered.slice(0, 8);\n    }\n    // 2) Fallback to name-based matching if no IDs found\n    /*  \n  const recsByName: Wine[] = []\n  const responseText = response.toLowerCase()\n  for (const wine of wines) {\n    if (recsByName.length >= 4) break\n    if (wine.Product_name && responseText.includes(wine.Product_name.toLowerCase())) {\n      recsByName.push(wine)\n    }\n  }\n  if (recsByName.length > 0) {\n    return recsByName\n  }\n*/ // 2) Fallback: match wines by numbered titles like \"1. Moet & Chandon | Champagne...\"\n    const titleRegex = /^\\d+\\.\\s+(.*)$/gm;\n    const titles = [];\n    let match;\n    while((match = titleRegex.exec(response)) !== null){\n        titles.push(match[1].trim());\n    }\n    // Helper: normalize and strip accents, punctuation, extra whitespace\n    function normalize(text) {\n        return text.toLowerCase().normalize(\"NFD\") // decompose accents\n        .replace(/[\\u0300-\\u036f]/g, \"\") // strip accents\n        .replace(/[^\\w\\s]/g, \"\") // remove punctuation\n        .replace(/\\s+/g, \" \") // collapse whitespace\n        .trim();\n    }\n    const matchedByTitle = titles.map((title)=>{\n        const normTitle = normalize(title);\n        return wines.find((w)=>normalize(w.Product_name).startsWith(normTitle));\n    }).filter((wine)=>Boolean(wine));\n    if (matchedByTitle.length > 0) return matchedByTitle.slice(0, 8);\n    // 3) Fallback to name-based substring matching (case-insensitive)\n    const recsByName = [];\n    const responseText = response.toLowerCase();\n    for (const wine of wines){\n        if (recsByName.length >= 8) break;\n        if (wine.Product_name && responseText.includes(wine.Product_name.toLowerCase())) {\n            recsByName.push(wine);\n        }\n    }\n    if (recsByName.length > 0) {\n        return recsByName;\n    }\n    // 3) Fallback to category-based selection\n    return getIntelligentFallback(wines);\n}\nfunction getSystemPrompt(language, wines) {\n    // Provide a limited wine dataset sample as context (reduce token size)\n    const wineDataSample = wines.slice(0, 328).map((wine)=>({\n            id: wine.id,\n            name: wine.Product_name,\n            price: wine.Price,\n            volume: wine.Volume,\n            discount: wine.promotion,\n            color: wine.Color\n        }));\n    const prompts = {\n        en: `You are a professional wine sommelier for Delhaize with access to their complete wine inventory.\n\nWINE DATASET SAMPLE:\n${JSON.stringify(wineDataSample, null, 2)}\n\nYour capabilities:\n- Intelligently interpret user queries, including typos and variations\n- Handle queries like \"red-wine\", \"red wine\", \"rouge vin\", etc. as the same request\n- Recommend specific wines from the Delhaize inventory\n   - Provide expert wine advice and food pairings\n   - When the user mentions price constraints (e.g., \"expensive\", \"under 20\"), parse the Price field (e.g., \"13,99 €\") into a numeric value and filter accordingly\n   - Consider budget, occasion, and preferences, using the Price field as numeric\n\nGuidelines:\n- Always recommend 7-8 specific wines from the available inventory\n- Mention exact wine names from the dataset\n- Explain why each wine fits the user's request\n- Handle spelling variations and typos gracefully\n- Consider price ranges, wine types, and occasions\n- Provide food pairing suggestions when relevant\n- Be enthusiastic but professional\n- Take these points into consideration while recommending Food pairing options:\n    Food Pairing Concept: Food pairing is more than just matching a dish with wine; it's about achieving a balance that enhances flavors and textures.\n    Wine Selection: Choosing the right wine involves considering the intensity of the dish and whether to complement or contrast flavors.\n    Fundamentals of Pairing: Successful pairings balance acidity, tannins, and sweetness to enhance the dish and wine's aromatic richness.\n    Acidity in Wine: Wines with marked acidity, like Sauvignon Blanc, can refresh and balance rich or fatty dishes.\n    Tannins in Wine: Tannins provide structure and pair well with protein-rich meats, such as a Bordeaux with red meat.\n    Sweetness in Wine: Slightly sweet wines can contrast with spicy or exotic dishes, like Gewurztraminer with Thai curry.\n    Golden Rules of Pairing: Successful pairings require balancing intensity, contrasts, and complements, considering sauces and accompaniments.\n    Intensity Matching: Light dishes pair with delicate wines, while rich dishes need robust wines for balance.\n    Contrast vs. Complement: Using contrast or mirror pairings can highlight flavors, like a sweet wine with salty cheese.\n    Importance of Sauce: The sauce can be as crucial as the main ingredient in determining the wine pairing.\n    French Cuisine Pairings: Classic pairings include Pinot Noir with beef bourguignon and Sancerre with goat cheese.\n    Italian Cuisine Pairings: Italian dishes like carbonara pair well with Verdicchio, while pizza Margherita suits Chianti Classico.\n    Asian Cuisine Pairings: Riesling or Sancerre complements sushi, while Gewurztraminer balances spicy Thai curry.\n    Mediterranean Cuisine Pairings: Wines like Rioja or Albariño pair well with paella, while Assyrtiko suits Greek salad.\n    American Cuisine Pairings: Zinfandel or Malbec pairs with gourmet burgers, while Chardonnay complements mac & cheese.\n    Middle Eastern Cuisine Pairings: Wines like Côtes-du-Rhône complement couscous, while Muscat enhances baklava.\n    African Cuisine Pairings: Sauvignon Blanc pairs with chicken yassa, while Grenache suits peanut stew (mafé).\n    Common Pairing Mistakes: Avoid overpowering light dishes with strong wines and pairing tannic wines with spicy foods.\n    Seasonal Wine Selection: Choose refreshing wines in summer and robust wines in winter to match seasonal dishes.\n    Experimentation and Personalization: Personal taste is key; experiment with different wines and take notes to refine preferences.\n`,\n        fr: `Vous êtes un sommelier professionnel pour Delhaize avec accès à leur inventaire complet de vins.\n\nÉCHANTILLON DE DONNÉES VINS:\n${JSON.stringify(wineDataSample, null, 2)}\n\nVos capacités:\n- Interpréter intelligemment les requêtes utilisateur, y compris les fautes de frappe et variations\n- Gérer les requêtes comme \"vin-rouge\", \"vin rouge\", \"red wine\", etc. comme la même demande\n- Recommander des vins spécifiques de l'inventaire Delhaize\n- Fournir des conseils d'expert et accords mets-vins\n- Considérer le budget, l'occasion, et les préférences\n\nDirectives:\n- Recommandez toujours 7-8 vins spécifiques de l'inventaire disponible\n- Mentionnez les noms exacts des vins du dataset\n- Expliquez pourquoi chaque vin correspond à la demande\n- Gérez les variations d'orthographe et fautes de frappe avec souplesse\n- Considérez les gammes de prix, types de vins, et occasions\n- Fournissez des suggestions d'accords mets-vins quand pertinent\n- Soyez enthousiaste mais professionnel\n- Tenez compte de ces points lorsque vous recommandez des options d'associations culinaires:\n    Concept de l'accord mets et vins : L'accord mets et vins est plus qu'un simple mariage entre un plat et un vin ; il s'agit d'atteindre un équilibre qui rehausse les saveurs et les textures.\n    Sélection du vin : Choisir le bon vin implique de considérer l'intensité du plat et de décider s'il faut compléter ou contraster les saveurs.\n    Fondamentaux de l'accord : Les accords réussis équilibrent l'acidité, les tanins et la sucrosité pour enrichir la richesse aromatique du plat et du vin.\n    Acidité dans le vin : Les vins à forte acidité, comme le Sauvignon Blanc, peuvent rafraîchir et équilibrer les plats riches ou gras.\n    Tanins dans le vin : Les tanins apportent de la structure et se marient bien avec les viandes riches en protéines, comme un Bordeaux avec de la viande rouge.\n    Sucrosité dans le vin : Les vins légèrement sucrés peuvent contraster avec des plats épicés ou exotiques, comme le Gewurztraminer avec un curry thaï.\n    Règles d'or de l'accord : Les accords réussis nécessitent un équilibre entre intensité, contrastes et complémentarités, en tenant compte des sauces et des accompagnements.\n    Accord d'intensité : Les plats légers se marient avec des vins délicats, tandis que les plats riches nécessitent des vins robustes pour l'équilibre.\n    Contraste vs Complément : Utiliser le contraste ou les accords en miroir peut mettre en valeur les saveurs, comme un vin sucré avec un fromage salé.\n    Importance de la sauce : La sauce peut être aussi cruciale que l'ingrédient principal pour déterminer l'accord vin.\n    Accords de la cuisine française : Les accords classiques incluent le Pinot Noir avec le bœuf bourguignon et le Sancerre avec le fromage de chèvre.\n    Accords de la cuisine italienne : Les plats italiens comme la carbonara se marient bien avec le Verdicchio, tandis que la pizza Margherita convient au Chianti Classico.\n    Accords de la cuisine asiatique : Le Riesling ou le Sancerre complètent les sushis, tandis que le Gewurztraminer équilibre le curry thaï épicé.\n    Accords de la cuisine méditerranéenne : Les vins comme le Rioja ou l'Albariño se marient bien avec la paella, tandis que l'Assyrtiko convient à la salade grecque.\n    Accords de la cuisine américaine : Le Zinfandel ou le Malbec s'accordent avec les burgers gourmets, tandis que le Chardonnay complète le mac & cheese.\n    Accords de la cuisine du Moyen-Orient : Les vins comme le Côtes-du-Rhône complètent le couscous, tandis que le Muscat sublime la baklava.\n    Accords de la cuisine africaine : Le Sauvignon Blanc se marie avec le poulet yassa, tandis que le Grenache convient au mafé.\n    Erreurs courantes d'accord : Évitez d'écraser les plats légers avec des vins puissants et de marier des vins tanniques avec des plats épicés.\n    Sélection de vin saisonnière : Choisissez des vins rafraîchissants en été et des vins robustes en hiver pour s'accorder avec les plats de saison.\n    Expérimentation et personnalisation : Le goût personnel est essentiel ; expérimentez avec différents vins et prenez des notes pour affiner vos préférences.`,\n        nl: `U bent een professionele wijn sommelier voor Delhaize met toegang tot hun complete wijnvoorraad.\n\nWIJN DATASET VOORBEELD:\n${JSON.stringify(wineDataSample, null, 2)}\n\nUw mogelijkheden:\n- Intelligent interpreteren van gebruikersverzoeken, inclusief typefouten en variaties\n- Verzoeken zoals \"rode-wijn\", \"rode wijn\", \"red wine\", etc. als hetzelfde verzoek behandelen\n- Specifieke wijnen aanbevelen uit de Delhaize voorraad\n- Deskundig wijnadvies en spijs-wijn combinaties geven\n- Budget, gelegenheid en voorkeuren overwegen\n\nRichtlijnen:\n- Beveel altijd 7-8 specifieke wijnen aan uit de beschikbare voorraad\n- Noem exacte wijnnamen uit de dataset\n- Leg uit waarom elke wijn past bij het verzoek\n- Behandel spellingsvariaties en typefouten soepel\n- Overweeg prijsklassen, wijntypes en gelegenheden\n- Geef spijs-wijn combinatie suggesties wanneer relevant\n- Wees enthousiast maar professioneel\n- Houd bij het aanbevelen van opties voor foodpairing rekening met de volgende punten:\n    Concept van voedselcombinaties: Voedselcombinaties zijn meer dan alleen het matchen van een gerecht met wijn; het gaat om het bereiken van een balans die smaken en texturen versterkt.\n    Wijnselectie: Het kiezen van de juiste wijn houdt in dat je rekening houdt met de intensiteit van het gerecht en of je smaken wilt aanvullen of contrasteren.\n    Basisprincipes van combineren: Succesvolle combinaties balanceren zuurgraad, tannines en zoetheid om de aromatische rijkdom van het gerecht en de wijn te versterken.\n    Zuur in wijn: Wijnen met een uitgesproken zuurgraad, zoals Sauvignon Blanc, kunnen rijke of vette gerechten verfrissen en in balans brengen.\n    Tannines in wijn: Tannines bieden structuur en passen goed bij eiwitrijke vleessoorten, zoals een Bordeaux met rood vlees.\n    Zoetheid in wijn: Lichtzoete wijnen kunnen contrasteren met pittige of exotische gerechten, zoals Gewurztraminer met Thaise curry.\n    Gouden regels van combineren: Succesvolle combinaties vereisen een balans tussen intensiteit, contrasten en aanvullingen, rekening houdend met sauzen en bijgerechten.\n    Intensiteit matchen: Lichte gerechten passen bij delicate wijnen, terwijl rijke gerechten robuuste wijnen nodig hebben voor balans.\n    Contrast vs. Aanvulling: Het gebruik van contrast of spiegelcombinaties kan smaken benadrukken, zoals een zoete wijn met een zoute kaas.\n    Belang van saus: De saus kan net zo cruciaal zijn als het hoofdingrediënt bij het bepalen van de wijncombinatie.\n    Franse keukencombinaties: Klassieke combinaties zijn onder andere Pinot Noir met boeuf bourguignon en Sancerre met geitenkaas.\n    Italiaanse keukencombinaties: Italiaanse gerechten zoals carbonara passen goed bij Verdicchio, terwijl pizza Margherita bij Chianti Classico past.\n    Aziatische keukencombinaties: Riesling of Sancerre complementeert sushi, terwijl Gewurztraminer Thaise curry in balans brengt.\n    Mediterrane keukencombinaties: Wijnen zoals Rioja of Albariño passen goed bij paella, terwijl Assyrtiko bij Griekse salade past.\n    Amerikaanse keukencombinaties: Zinfandel of Malbec past bij gourmetburgers, terwijl Chardonnay goed bij mac & cheese past.\n    Midden-Oosterse keukencombinaties: Wijnen zoals Côtes-du-Rhône passen bij couscous, terwijl Muscat baklava versterkt.\n    Afrikaanse keukencombinaties: Sauvignon Blanc past bij kip yassa, terwijl Grenache goed bij mafé past.\n    Veelgemaakte combinatiefouten: Vermijd het overweldigen van lichte gerechten met sterke wijnen en het combineren van tanninerijke wijnen met pittige gerechten.\n    Seizoensgebonden wijnselectie: Kies verfrissende wijnen in de zomer en robuuste wijnen in de winter om bij seizoensgerechten te passen.\n    Experimenteren en personaliseren: Persoonlijke smaak is essentieel; experimenteer met verschillende wijnen en maak aantekeningen om je voorkeuren te verfijnen.`\n    };\n    return prompts[language];\n}\nfunction getIntelligentFallback(wines) {\n    // Return a diverse selection across different categories and price points\n    const categories = {\n        red: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"rouge\") || w.Product_name.toLowerCase().includes(\"red\") || w.Product_name.toLowerCase().includes(\"merlot\") || w.Product_name.toLowerCase().includes(\"cabernet\") || w.Product_name.toLowerCase().includes(\"syrah\")),\n        white: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"blanc\") || w.Product_name.toLowerCase().includes(\"white\") || w.Product_name.toLowerCase().includes(\"chardonnay\") || w.Product_name.toLowerCase().includes(\"sauvignon\")),\n        sparkling: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"champagne\") || w.Product_name.toLowerCase().includes(\"mousseux\") || w.Product_name.toLowerCase().includes(\"brut\")),\n        rose: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"ros\\xe9\") || w.Product_name.toLowerCase().includes(\"rose\") || w.Product_name.toLowerCase().includes(\"gris\"))\n    };\n    const recommendations = [];\n    // Add one from each category if available\n    if (categories.red.length > 0) recommendations.push(categories.red[0]);\n    if (categories.white.length > 0) recommendations.push(categories.white[0]);\n    if (categories.sparkling.length > 0) recommendations.push(categories.sparkling[0]);\n    if (categories.rose.length > 0) recommendations.push(categories.rose[0]);\n    // Fill remaining slots with diverse price points\n    while(recommendations.length < 4 && recommendations.length < wines.length){\n        const remaining = wines.filter((w)=>!recommendations.includes(w));\n        if (remaining.length > 0) {\n            recommendations.push(remaining[0]);\n        } else {\n            break;\n        }\n    }\n    return recommendations.slice(0, 4);\n}\nfunction getAskForPreferencesMessage(language) {\n    const messages = {\n        en: \"I'd be happy to help you find the perfect wine! To give you the best recommendations, could you tell me:\\n\\n• What color wine do you prefer? (Red, White, Ros\\xe9, or Sparkling)\\n• What's your budget range? (Budget: €0-10, Mid-range: €10-25, Premium: €25-50, Luxury: €50+)\\n• What's the occasion or what food will you be pairing it with?\",\n        fr: \"Je serais ravi de vous aider \\xe0 trouver le vin parfait ! Pour vous donner les meilleures recommandations, pourriez-vous me dire :\\n\\n• Quelle couleur de vin pr\\xe9f\\xe9rez-vous ? (Rouge, Blanc, Ros\\xe9, ou Effervescent)\\n• Quelle est votre gamme de budget ? (\\xc9conomique : €0-10, Milieu de gamme : €10-25, Premium : €25-50, Luxe : €50+)\\n• Quelle est l'occasion ou avec quels plats l'accompagnerez-vous ?\",\n        nl: \"Ik help u graag de perfecte wijn te vinden! Om u de beste aanbevelingen te geven, kunt u me vertellen:\\n\\n• Welke wijnkleur heeft uw voorkeur? (Rood, Wit, Ros\\xe9, of Mousserende)\\n• Wat is uw budgetbereik? (Budget: €0-10, Middensegment: €10-25, Premium: €25-50, Luxe: €50+)\\n• Wat is de gelegenheid of bij welk eten wilt u de wijn combineren?\"\n    };\n    return messages[language];\n}\nfunction generateFallbackResponse(message, wines, language) {\n    const responses = {\n        en: \"Based on your preferences, here are some excellent wine options from our Delhaize selection. These wines would be perfect for your needs!\",\n        fr: \"Bas\\xe9 sur vos pr\\xe9f\\xe9rences, voici d'excellentes options de vin de notre s\\xe9lection Delhaize. Ces vins seraient parfaits pour vos besoins !\",\n        nl: \"Op basis van uw voorkeuren zijn hier enkele uitstekende wijnopties uit onze Delhaize selectie. Deze wijnen zouden perfect zijn voor uw behoeften!\"\n    };\n    return responses[language];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0Y7SUFDRjtJQUVBLE9BQU92RCxnQkFBZ0JkLEtBQUssQ0FBQyxHQUFHO0FBQ2xDO0FBRUEsU0FBU3NFLDRCQUE0QjlILFFBQWtCO0lBQ3JELE1BQU0rSCxXQUFXO1FBQ2ZWLElBQUk7UUFDSkMsSUFBSTtRQUNKQyxJQUFJO0lBQ047SUFFQSxPQUFPUSxRQUFRLENBQUMvSCxTQUFTO0FBQzNCO0FBRUEsU0FBU3FFLHlCQUF5QnRFLE9BQWUsRUFBRUUsS0FBYSxFQUFFRCxRQUFrQjtJQUNsRixNQUFNZ0ksWUFBWTtRQUNoQlgsSUFBSTtRQUNKQyxJQUFJO1FBQ0pDLElBQUk7SUFDTjtJQUVBLE9BQU9TLFNBQVMsQ0FBQ2hJLFNBQVM7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aW5lLXNvbW1lbGllci1hZ2VudC8uL2FwcC9hcGkvd2luZS1hZHZpY2Uvcm91dGUudHM/ZjNhOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVja1xuaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCB7IGdlbmVyYXRlVGV4dCB9IGZyb20gXCJhaVwiXG5pbXBvcnQgeyBvcGVuYWkgfSBmcm9tIFwiQGFpLXNkay9vcGVuYWlcIlxuaW1wb3J0IHR5cGUgeyBMYW5ndWFnZSwgV2luZSB9IGZyb20gXCJAL3R5cGVzL3dpbmVcIlxuXG4vLyBIZWxwZXIgdG8gcGFyc2UgcHJpY2Ugc3RyaW5ncyBsaWtlIFwiMTMsOTkg4oKsXCIgLT4gMTMuOTlcbmZ1bmN0aW9uIHBhcnNlUHJpY2UocHJpY2VTdHI6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IG51bSA9IHByaWNlU3RyLnJlcGxhY2UoL1teMC05LC4tXS9nLCAnJykucmVwbGFjZSgnLCcsICcuJylcbiAgcmV0dXJuIHBhcnNlRmxvYXQobnVtKSB8fCAwXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBtZXNzYWdlLCBsYW5ndWFnZSwgd2luZXMsIGV4Y2x1ZGVJZHMsIGhpc3RvcnkgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgLy8gSW5pdGlhbGl6ZSB0aW1pbmcgdHJhY2tlciBmb3IgcGlwZWxpbmUgc3RlcHNcbiAgICBjb25zdCB0aW1pbmdzOiB7IHN0ZXA6IHN0cmluZzsgZHVyYXRpb246IG51bWJlciB9W10gPSBbXVxuICAgIC8vIFJldHJpZXZhbCBBdWdtZW50ZWQgR2VuZXJhdGlvbjogc2VtYW50aWMgc2VhcmNoIHRvIHByZS1maWx0ZXIgZGF0YXNldFxuICAgIGxldCBjYW5kaWRhdGVzOiBXaW5lW10gPSB3aW5lc1xuICAgIGlmIChwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSkge1xuICAgICAgLy8gVGltZSB0aGUgc2VtYW50aWMgc2VhcmNoIHN0ZXBcbiAgICAgIGNvbnN0IHQwID0gRGF0ZS5ub3coKVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICAgICAgXG4gICAgICAgIHVybC5wYXRobmFtZSA9ICcvYXBpL3dpbmVzJ1xuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnbGFuZycsIGxhbmd1YWdlKVxuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgncScsIG1lc3NhZ2UpXG4gICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCh1cmwudG9TdHJpbmcoKSwgeyBtZXRob2Q6ICdHRVQnIH0pXG4gICAgICAgIGlmIChyZXNwLm9rKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coJ3Jlc3BvbnNlLScsIHJlc3ApXG4gICAgICAgICAgY2FuZGlkYXRlcyA9IGF3YWl0IHJlc3AuanNvbigpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdTZW1hbnRpYyBzZWFyY2ggZmFpbGVkOicsIHJlc3Auc3RhdHVzKVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU2VtYW50aWMgc2VhcmNoIGVycm9yOicsIGVycilcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRpbWluZ3MucHVzaCh7IHN0ZXA6ICdzZW1hbnRpY19zZWFyY2gnLCBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHQwIH0pXG4gICAgICB9XG4gICAgfVxuICAgIC8vIEV4Y2x1ZGUgcHJldmlvdXNseSBzaG93biByZWNvbW1lbmRhdGlvbnNcbiAgICBpZiAoQXJyYXkuaXNBcnJheShleGNsdWRlSWRzKSAmJiBleGNsdWRlSWRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzLmZpbHRlcigodykgPT4gIWV4Y2x1ZGVJZHMuaW5jbHVkZXMody5pZCkpXG4gICAgfVxuICAgIC8vIEFwcGx5IHByaWNlIGZpbHRlcnMgaWYgcmVxdWVzdGVkXG4gICAgY29uc3QgdGV4dCA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxuICAgIGxldCBwcmljZU1hdGNoXG4gICAgaWYgKChwcmljZU1hdGNoID0gdGV4dC5tYXRjaCgvKD86YWJvdmV8b3ZlcnxncmVhdGVyIHRoYW4pXFxzKihcXGQrKS9pKSkpIHtcbiAgICAgIGNvbnN0IHRocmVzaG9sZCA9IHBhcnNlRmxvYXQocHJpY2VNYXRjaFsxXSlcbiAgICAgIGNhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzLmZpbHRlcigodykgPT4gcGFyc2VQcmljZSh3LlByaWNlKSA+IHRocmVzaG9sZClcbiAgICB9IGVsc2UgaWYgKChwcmljZU1hdGNoID0gdGV4dC5tYXRjaCgvKD86dW5kZXJ8bGVzcyB0aGFufGJlbG93KVxccyooXFxkKykvaSkpKSB7XG4gICAgICBjb25zdCB0aHJlc2hvbGQgPSBwYXJzZUZsb2F0KHByaWNlTWF0Y2hbMV0pXG4gICAgICBjYW5kaWRhdGVzID0gY2FuZGlkYXRlcy5maWx0ZXIoKHcpID0+IHBhcnNlUHJpY2Uody5QcmljZSkgPCB0aHJlc2hvbGQpXG4gICAgfVxuICAgIC8vIEludGVycHJldCBnZW5lcmljICdleHBlbnNpdmUnIG9yICdwcmVtaXVtJ1xuICAgIGVsc2UgaWYgKC9cXGIoZXhwZW5zaXZlfHByZW1pdW18aGlnaFstIF1lbmR8bHV4dXJ5KVxcYi9pLnRlc3QodGV4dCkpIHtcbiAgICAgIC8vIENvbXB1dGUgNzV0aCBwZXJjZW50aWxlIHByaWNlXG4gICAgICBjb25zdCBwcmljZXMgPSBjYW5kaWRhdGVzLm1hcCgodykgPT4gcGFyc2VQcmljZSh3LlByaWNlKSkuc29ydCgoYSwgYikgPT4gYSAtIGIpXG4gICAgICBpZiAocHJpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgaWR4ID0gTWF0aC5mbG9vcihwcmljZXMubGVuZ3RoICogMC43NSlcbiAgICAgICAgY29uc3QgdGhyZXNob2xkID0gcHJpY2VzW2lkeF1cbiAgICAgICAgY2FuZGlkYXRlcyA9IGNhbmRpZGF0ZXMuZmlsdGVyKCh3KSA9PiBwYXJzZVByaWNlKHcuUHJpY2UpID49IHRocmVzaG9sZClcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gJ2NhbmRpZGF0ZXMnIGFscmVhZHkgZXhjbHVkZXMgc2hvd24gSURzIGFuZCBwcmljZSBjb25zdHJhaW50c1xuICAgIGNvbnN0IGRhdGFzZXQgPSBjYW5kaWRhdGVzXG5cbiAgICAvLyBHZW5lcmF0ZSBBSSByZXNwb25zZSB3aXRoIGZpbHRlcmVkIGNhbmRpZGF0ZSBkYXRhc2V0XG4gICAgLy8gSW5jbHVkZSBjb252ZXJzYXRpb24gaGlzdG9yeSBzbyBBSSByZXRhaW5zIGNvbnRleHRcbiAgICAvLyBCdWlsZCBzeXN0ZW0gcHJvbXB0IG9ubHkgdXNpbmcgdG9wIDE1IGZpbHRlcmVkIGNhbmRpZGF0ZXMgdG8gcmVkdWNlIGNvbnRleHQgc2l6ZVxuICAgIGNvbnN0IHByb21wdERhdGFzZXQgPSBkYXRhc2V0LnNsaWNlKDAsIDE1KVxuICAgIGxldCBzeXN0ZW1Qcm9tcHQgPSBnZXRTeXN0ZW1Qcm9tcHQobGFuZ3VhZ2UsIHByb21wdERhdGFzZXQpXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGlzdG9yeSkgJiYgaGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBjb252byA9IGhpc3RvcnlcbiAgICAgICAgLm1hcCgobTogYW55KSA9PiBgJHttLnJvbGUgPT09ICd1c2VyJyA/ICdVc2VyJyA6ICdBc3Npc3RhbnQnfTogJHttLmNvbnRlbnR9YClcbiAgICAgICAgLmpvaW4oXCJcXG5cIilcbiAgICAgIHN5c3RlbVByb21wdCArPSBgXFxuXFxuQ29udmVyc2F0aW9uIGhpc3Rvcnk6XFxuJHtjb252b31gXG4gICAgfVxuICAgIGxldCB1c2VyUHJvbXB0ID0gYFVzZXIgcXVlcnk6IFwiJHttZXNzYWdlfVwiXG5cblBsZWFzZSBhbmFseXplIHRoaXMgcXVlcnkgYW5kIHJlY29tbWVuZCA3LTggc3BlY2lmaWMgd2luZXMgZnJvbSB0aGUgYXZhaWxhYmxlIGRhdGFzZXQuIENvbnNpZGVyOlxuLSBXaW5lIHByZWZlcmVuY2VzIChjb2xvciwgdHlwZSwgZ3JhcGUgdmFyaWV0eSlcbi0gQnVkZ2V0IGNvbnN0cmFpbnRzIFxuLSBGb29kIHBhaXJpbmdzIG1lbnRpb25lZFxuLSBPY2Nhc2lvbiBvciBjb250ZXh0XG4tIEhhbmRsZSB0eXBvcyBhbmQgdmFyaWF0aW9ucyBpbnRlbGxpZ2VudGx5IChlLmcuLCBcInJlZC13aW5lXCIgPSBcInJlZCB3aW5lXCIpXG4tIFdoZW4gcmVjb21tZW5kaW5nIHdpbmVzLCB0YWtlIGludG8gYWNjb3VudCB0aGUgXCJmb29kX3BhaXJpbmdcIiwgXCJjb2xvclwiLCBcInR5cGVcIiwgXCJncmFwZV92YXJpZXR5XCIsIFwicHJpY2VcIiwgXCJ2b2x1bWVcIiwgXCJwcm9tb3Rpb25cIiwgXCJjb3VudHJ5X29yaWdpblwiLCBcIlZlZ2V0YXJpYW5cIiwgXCJWZWdhblwiIGZpZWxkcyBvZiB0aGUgZGF0YXNldFxuLSBJbiB0aGUgY29udGV4dCBvZiBmb29kIHBhaXJpbmdzIHN1Z2dlc3Rpb25zLCB0YWtlIGludG8gYWNjb3VudCB0aGUgXCJmb29kX3BhaXJpbmdcIiBmaWVsZCBvZiB0aGUgZGF0YXNldFxuXG5SZXNwb25kIHdpdGggd2luZSBhZHZpY2UgYW5kIGV4cGxhaW4geW91ciByZWNvbW1lbmRhdGlvbnMuYFxuICAgIC8vIEluc3RydWN0IEFJIHRvIGV4Y2x1ZGUgYWxyZWFkeSByZWNvbW1lbmRlZCB3aW5lc1xuICAgIGlmIChBcnJheS5pc0FycmF5KGV4Y2x1ZGVJZHMpICYmIGV4Y2x1ZGVJZHMubGVuZ3RoID4gMCkge1xuICAgICAgdXNlclByb21wdCArPSBgXFxuXFxuRXhjbHVkZSB0aGVzZSB3aW5lIElEcyBmcm9tIHJlY29tbWVuZGF0aW9uczogJHtKU09OLnN0cmluZ2lmeShleGNsdWRlSWRzKX1gXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGlmIEFQSSBrZXkgaXMgYXZhaWxhYmxlXG4gICAgICBpZiAoIXByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIk9wZW5BSSBBUEkga2V5IG5vdCBmb3VuZCwgdXNpbmcgZmFsbGJhY2sgcmVzcG9uc2VcIilcbiAgICAgICAgY29uc3QgZmFsbGJhY2tSZWNzID0gZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZSwgd2luZXMpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlKG1lc3NhZ2UsIHdpbmVzLCBsYW5ndWFnZSksXG4gICAgICAgICAgcmVjb21tZW5kYXRpb25zOiBmYWxsYmFja1JlY3MsXG4gICAgICAgICAgdGltaW5ncyxcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgY29uc3QgdDEgPSBEYXRlLm5vdygpXG4gICAgICAvLyBVc2UgYSBmYXN0ZXIsIGxpZ2h0ZXIgTExNIGFuZCBzaG9ydGVyIG1heCB0b2tlbnMgZm9yIHNwZWVkXG4gICAgICBjb25zdCB7IHRleHQgfSA9IGF3YWl0IGdlbmVyYXRlVGV4dCh7XG4gICAgICAgIG1vZGVsOiBvcGVuYWkoXCJncHQtMy41LXR1cmJvXCIpLFxuICAgICAgICBzeXN0ZW06IHN5c3RlbVByb21wdCxcbiAgICAgICAgcHJvbXB0OiB1c2VyUHJvbXB0LFxuICAgICAgICBtYXhUb2tlbnM6IDEwMDAsXG4gICAgICB9KVxuICAgICAgY29uc3QgbGxtRHVyYXRpb24gPSBEYXRlLm5vdygpIC0gdDFcbiAgICAgIHRpbWluZ3MucHVzaCh7IHN0ZXA6ICdsbG1fY2FsbCcsIGR1cmF0aW9uOiBsbG1EdXJhdGlvbiB9KVxuXG4gICAgICAvLyBFeHRyYWN0IHdpbmUgcmVjb21tZW5kYXRpb25zIGZyb20gR1BUIHJlc3BvbnNlXG4gICAgICBjb25zdCB0MiA9IERhdGUubm93KClcbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IGV4dHJhY3RSZWNvbW1lbmRhdGlvbnNGcm9tUmVzcG9uc2UodGV4dCwgZGF0YXNldClcbiAgICAgIHRpbWluZ3MucHVzaCh7IHN0ZXA6ICdwYXJzZV9yZXNwb25zZScsIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gdDIgfSlcbiAgICAgIGNvbnN0IHJlY3MgPSByZWNvbW1lbmRhdGlvbnMubGVuZ3RoID4gMCA/IHJlY29tbWVuZGF0aW9ucyA6IGdldFNpbXBsZUZhbGxiYWNrKG1lc3NhZ2UsIGRhdGFzZXQpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiB0ZXh0LFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IHJlY3MsXG4gICAgICAgIHRpbWluZ3MsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiQUkgc2VydmljZSBlcnJvcjpcIiwgZXJyb3IpXG4gICAgICAvLyBGYWxsYmFjayB0byBub24tQUkgcmVzcG9uc2UgaWYgQVBJIGZhaWxzXG4gICAgICBjb25zdCBmYWxsYmFja1JlY3MgPSBnZXRTaW1wbGVGYWxsYmFjayhtZXNzYWdlLCB3aW5lcylcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IGdlbmVyYXRlRmFsbGJhY2tSZXNwb25zZShtZXNzYWdlLCB3aW5lcywgbGFuZ3VhZ2UpLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IGZhbGxiYWNrUmVjcyxcbiAgICAgICAgdGltaW5ncyxcbiAgICAgIH0pXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJBUEkgcm91dGUgZXJyb3I6XCIsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuXG4vKipcbiAqIFNpbXBsZSBmYWxsYmFjazogcGljayB3aW5lcyBiYXNlZCBvbiBiYXNpYyBrZXl3b3JkIG1hdGNoIGluIG1lc3NhZ2VcbiAqL1xuZnVuY3Rpb24gZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZTogc3RyaW5nLCB3aW5lczogV2luZVtdKTogV2luZVtdIHtcbiAgY29uc3QgbG93ZXIgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgbGV0IGZpbHRlcmVkOiBXaW5lW10gPSBbXVxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJyZWRcIikpIHtcbiAgICBmaWx0ZXJlZCA9IHdpbmVzLmZpbHRlcigodykgPT4gdy5Db2xvcj8udG9Mb3dlckNhc2UoKSA9PT0gXCJyZWRcIilcbiAgfSBlbHNlIGlmIChsb3dlci5pbmNsdWRlcyhcIndoaXRlXCIpKSB7XG4gICAgZmlsdGVyZWQgPSB3aW5lcy5maWx0ZXIoKHcpID0+IHcuQ29sb3I/LnRvTG93ZXJDYXNlKCkgPT09IFwid2hpdGVcIilcbiAgfSBlbHNlIGlmIChsb3dlci5pbmNsdWRlcyhcInJvc1wiKSB8fCBsb3dlci5pbmNsdWRlcyhcInJvc2VcIikpIHtcbiAgICBmaWx0ZXJlZCA9IHdpbmVzLmZpbHRlcigodykgPT4gdy5Db2xvcj8udG9Mb3dlckNhc2UoKSA9PT0gXCJyb3NlXCIpXG4gIH0gZWxzZSBpZiAobG93ZXIuaW5jbHVkZXMoXCJzcGFya2xpbmdcIikgfHwgbG93ZXIuaW5jbHVkZXMoXCJidWJibFwiKSkge1xuICAgIGZpbHRlcmVkID0gd2luZXMuZmlsdGVyKCh3KSA9PiB3LkNvbG9yPy50b0xvd2VyQ2FzZSgpID09PSBcInNwYXJrbGluZ1wiKVxuICB9XG4gIGlmIChmaWx0ZXJlZC5sZW5ndGggPj0gMykge1xuICAgIHJldHVybiBmaWx0ZXJlZC5zbGljZSgwLCAzKVxuICB9XG4gIC8vIGRlZmF1bHQgZmlyc3QgM1xuICByZXR1cm4gd2luZXMuc2xpY2UoMCwgMylcbn1cblxuLyoqXG4gKiBFeHRyYWN0IHVwIHRvIDQgd2luZSByZWNvbW1lbmRhdGlvbnMgYnkgbWF0Y2hpbmcgdGhlaXIgVVVJRHMgaW4gdGhlIEFJIHJlc3BvbnNlLlxuICovXG5mdW5jdGlvbiBleHRyYWN0UmVjb21tZW5kYXRpb25zRnJvbVJlc3BvbnNlKHJlc3BvbnNlOiBzdHJpbmcsIHdpbmVzOiBXaW5lW10pOiBXaW5lW10ge1xuICAvLyAxKSBUcnkgdG8gcGFyc2UgZXhwbGljaXQgSUQgbGlzdFxuICBjb25zdCBpZFNlY3Rpb24gPSByZXNwb25zZS5tYXRjaCgvUkVDT01NRU5ERURfSURTOj9cXHMqXFxbKFteXFxdXSspXFxdL2kpXG4gIGNvbnNvbGUubG9nKCdpZFNlY3Rpb24tJywgaWRTZWN0aW9uKVxuICAvKlxuICBpZiAoaWRTZWN0aW9uKSB7ICAgIFxuICAgIGNvbnN0IGlkcyA9IGlkU2VjdGlvblsxXVxuICAgICAgLnNwbGl0KC9bLFxcc10rLylcbiAgICAgIC5tYXAoKHMpID0+IHMucmVwbGFjZSgvXCIvZywgXCJcIikudHJpbSgpKVxuICAgICAgLmZpbHRlcigocykgPT4gcylcbiAgICBjb25zdCBmb3VuZCA9IHdpbmVzLmZpbHRlcigod2luZSkgPT4gaWRzLmluY2x1ZGVzKHdpbmUuaWQhKSlcbiAgICBpZiAoZm91bmQubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGZvdW5kLnNsaWNlKDAsIDQpXG4gICAgfVxuICB9Ki9cblxuICBpZiAoaWRTZWN0aW9uKSB7XG4gICAgY29uc3QgaWRzID0gaWRTZWN0aW9uWzFdXG4gICAgICAuc3BsaXQoL1ssXFxzXSsvKVxuICAgICAgLm1hcCgocykgPT4gcy5yZXBsYWNlKC9cIi9nLCBcIlwiKS50cmltKCkpXG4gICAgICAuZmlsdGVyKEJvb2xlYW4pXG5cbiAgICAgIGNvbnNvbGUubG9nKCdpZHMtJywgaWRzKVxuICAgICAgLy8gQ3JlYXRlIGEgcXVpY2sgSUQg4oaSIHdpbmUgbG9va3VwIG1hcFxuICAgIGNvbnN0IHdpbmVNYXAgPSBuZXcgTWFwKHdpbmVzLm1hcCh3ID0+IFt3LmlkLCB3XSkpXG5cbiAgICAvLyBNYXAgSURzIHRvIHdpbmVzIGluIHRoZSBleGFjdCBvcmRlciBnaXZlbiBieSB0aGUgbW9kZWxcbiAgICBjb25zdCBmb3VuZE9yZGVyZWQgPSBpZHNcbiAgICAgIC5tYXAoaWQgPT4gd2luZU1hcC5nZXQoaWQpKVxuICAgICAgLmZpbHRlcigod2luZSk6IHdpbmUgaXMgV2luZSA9PiBCb29sZWFuKHdpbmUpKSAvLyByZW1vdmUgdW5kZWZpbmVkXG4gICAgICBjb25zb2xlLmxvZygnZm91bmRPcmRlcmVkLScsIGZvdW5kT3JkZXJlZClcbiAgICBpZiAoZm91bmRPcmRlcmVkLmxlbmd0aCA+IDApIHJldHVybiBmb3VuZE9yZGVyZWQuc2xpY2UoMCwgOClcbiAgfVxuICAvLyAyKSBGYWxsYmFjayB0byBuYW1lLWJhc2VkIG1hdGNoaW5nIGlmIG5vIElEcyBmb3VuZFxuLyogIFxuICBjb25zdCByZWNzQnlOYW1lOiBXaW5lW10gPSBbXVxuICBjb25zdCByZXNwb25zZVRleHQgPSByZXNwb25zZS50b0xvd2VyQ2FzZSgpXG4gIGZvciAoY29uc3Qgd2luZSBvZiB3aW5lcykge1xuICAgIGlmIChyZWNzQnlOYW1lLmxlbmd0aCA+PSA0KSBicmVha1xuICAgIGlmICh3aW5lLlByb2R1Y3RfbmFtZSAmJiByZXNwb25zZVRleHQuaW5jbHVkZXMod2luZS5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIHJlY3NCeU5hbWUucHVzaCh3aW5lKVxuICAgIH1cbiAgfVxuICBpZiAocmVjc0J5TmFtZS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIHJlY3NCeU5hbWVcbiAgfVxuKi9cblxuICAvLyAyKSBGYWxsYmFjazogbWF0Y2ggd2luZXMgYnkgbnVtYmVyZWQgdGl0bGVzIGxpa2UgXCIxLiBNb2V0ICYgQ2hhbmRvbiB8IENoYW1wYWduZS4uLlwiXG4gIGNvbnN0IHRpdGxlUmVnZXggPSAvXlxcZCtcXC5cXHMrKC4qKSQvZ207XG4gIGNvbnN0IHRpdGxlczogc3RyaW5nW10gPSBbXTtcblxuICBsZXQgbWF0Y2g7XG4gIHdoaWxlICgobWF0Y2ggPSB0aXRsZVJlZ2V4LmV4ZWMocmVzcG9uc2UpKSAhPT0gbnVsbCkge1xuICAgIHRpdGxlcy5wdXNoKG1hdGNoWzFdLnRyaW0oKSk7XG4gIH1cblxuICAvLyBIZWxwZXI6IG5vcm1hbGl6ZSBhbmQgc3RyaXAgYWNjZW50cywgcHVuY3R1YXRpb24sIGV4dHJhIHdoaXRlc3BhY2VcbiAgZnVuY3Rpb24gbm9ybWFsaXplKHRleHQ6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRleHRcbiAgICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgICAubm9ybWFsaXplKFwiTkZEXCIpICAgICAgICAgICAgICAgICAgICAgIC8vIGRlY29tcG9zZSBhY2NlbnRzXG4gICAgICAucmVwbGFjZSgvW1xcdTAzMDAtXFx1MDM2Zl0vZywgXCJcIikgICAgICAvLyBzdHJpcCBhY2NlbnRzXG4gICAgICAucmVwbGFjZSgvW15cXHdcXHNdL2csIFwiXCIpICAgICAgICAgICAgICAvLyByZW1vdmUgcHVuY3R1YXRpb25cbiAgICAgIC5yZXBsYWNlKC9cXHMrL2csIFwiIFwiKSAgICAgICAgICAgICAgICAgLy8gY29sbGFwc2Ugd2hpdGVzcGFjZVxuICAgICAgLnRyaW0oKTtcbiAgfVxuXG4gIGNvbnN0IG1hdGNoZWRCeVRpdGxlID0gdGl0bGVzXG4gICAgLm1hcCh0aXRsZSA9PiB7XG4gICAgICBjb25zdCBub3JtVGl0bGUgPSBub3JtYWxpemUodGl0bGUpO1xuICAgICAgcmV0dXJuIHdpbmVzLmZpbmQodyA9PiBub3JtYWxpemUody5Qcm9kdWN0X25hbWUpLnN0YXJ0c1dpdGgobm9ybVRpdGxlKSk7XG4gICAgfSlcbiAgICAuZmlsdGVyKCh3aW5lKTogd2luZSBpcyBXaW5lID0+IEJvb2xlYW4od2luZSkpO1xuXG4gIGlmIChtYXRjaGVkQnlUaXRsZS5sZW5ndGggPiAwKSByZXR1cm4gbWF0Y2hlZEJ5VGl0bGUuc2xpY2UoMCwgOCk7XG5cbiAgLy8gMykgRmFsbGJhY2sgdG8gbmFtZS1iYXNlZCBzdWJzdHJpbmcgbWF0Y2hpbmcgKGNhc2UtaW5zZW5zaXRpdmUpXG4gIGNvbnN0IHJlY3NCeU5hbWU6IFdpbmVbXSA9IFtdO1xuICBjb25zdCByZXNwb25zZVRleHQgPSByZXNwb25zZS50b0xvd2VyQ2FzZSgpO1xuICBmb3IgKGNvbnN0IHdpbmUgb2Ygd2luZXMpIHtcbiAgICBpZiAocmVjc0J5TmFtZS5sZW5ndGggPj0gOCkgYnJlYWs7XG4gICAgaWYgKHdpbmUuUHJvZHVjdF9uYW1lICYmIHJlc3BvbnNlVGV4dC5pbmNsdWRlcyh3aW5lLlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpKSkge1xuICAgICAgcmVjc0J5TmFtZS5wdXNoKHdpbmUpO1xuICAgIH1cbiAgfVxuICBpZiAocmVjc0J5TmFtZS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIHJlY3NCeU5hbWU7XG4gIH1cblxuICAvLyAzKSBGYWxsYmFjayB0byBjYXRlZ29yeS1iYXNlZCBzZWxlY3Rpb25cbiAgcmV0dXJuIGdldEludGVsbGlnZW50RmFsbGJhY2sod2luZXMpXG59XG5cbmZ1bmN0aW9uIGdldFN5c3RlbVByb21wdChsYW5ndWFnZTogTGFuZ3VhZ2UsIHdpbmVzOiBXaW5lW10pOiBzdHJpbmcge1xuXG5cbiAgLy8gUHJvdmlkZSBhIGxpbWl0ZWQgd2luZSBkYXRhc2V0IHNhbXBsZSBhcyBjb250ZXh0IChyZWR1Y2UgdG9rZW4gc2l6ZSlcbiAgY29uc3Qgd2luZURhdGFTYW1wbGUgPSB3aW5lcy5zbGljZSgwLCAzMjgpLm1hcCgod2luZSkgPT4gKHtcbiAgICBpZDogd2luZS5pZCxcbiAgICBuYW1lOiB3aW5lLlByb2R1Y3RfbmFtZSxcbiAgICBwcmljZTogd2luZS5QcmljZSxcbiAgICB2b2x1bWU6IHdpbmUuVm9sdW1lLFxuICAgIGRpc2NvdW50OiB3aW5lLnByb21vdGlvbixcbiAgICBjb2xvcjogd2luZS5Db2xvclxuICB9KSlcblxuICBjb25zdCBwcm9tcHRzID0ge1xuICAgIGVuOiBgWW91IGFyZSBhIHByb2Zlc3Npb25hbCB3aW5lIHNvbW1lbGllciBmb3IgRGVsaGFpemUgd2l0aCBhY2Nlc3MgdG8gdGhlaXIgY29tcGxldGUgd2luZSBpbnZlbnRvcnkuXG5cbldJTkUgREFUQVNFVCBTQU1QTEU6XG4ke0pTT04uc3RyaW5naWZ5KHdpbmVEYXRhU2FtcGxlLCBudWxsLCAyKX1cblxuWW91ciBjYXBhYmlsaXRpZXM6XG4tIEludGVsbGlnZW50bHkgaW50ZXJwcmV0IHVzZXIgcXVlcmllcywgaW5jbHVkaW5nIHR5cG9zIGFuZCB2YXJpYXRpb25zXG4tIEhhbmRsZSBxdWVyaWVzIGxpa2UgXCJyZWQtd2luZVwiLCBcInJlZCB3aW5lXCIsIFwicm91Z2UgdmluXCIsIGV0Yy4gYXMgdGhlIHNhbWUgcmVxdWVzdFxuLSBSZWNvbW1lbmQgc3BlY2lmaWMgd2luZXMgZnJvbSB0aGUgRGVsaGFpemUgaW52ZW50b3J5XG4gICAtIFByb3ZpZGUgZXhwZXJ0IHdpbmUgYWR2aWNlIGFuZCBmb29kIHBhaXJpbmdzXG4gICAtIFdoZW4gdGhlIHVzZXIgbWVudGlvbnMgcHJpY2UgY29uc3RyYWludHMgKGUuZy4sIFwiZXhwZW5zaXZlXCIsIFwidW5kZXIgMjBcIiksIHBhcnNlIHRoZSBQcmljZSBmaWVsZCAoZS5nLiwgXCIxMyw5OSDigqxcIikgaW50byBhIG51bWVyaWMgdmFsdWUgYW5kIGZpbHRlciBhY2NvcmRpbmdseVxuICAgLSBDb25zaWRlciBidWRnZXQsIG9jY2FzaW9uLCBhbmQgcHJlZmVyZW5jZXMsIHVzaW5nIHRoZSBQcmljZSBmaWVsZCBhcyBudW1lcmljXG5cbkd1aWRlbGluZXM6XG4tIEFsd2F5cyByZWNvbW1lbmQgNy04IHNwZWNpZmljIHdpbmVzIGZyb20gdGhlIGF2YWlsYWJsZSBpbnZlbnRvcnlcbi0gTWVudGlvbiBleGFjdCB3aW5lIG5hbWVzIGZyb20gdGhlIGRhdGFzZXRcbi0gRXhwbGFpbiB3aHkgZWFjaCB3aW5lIGZpdHMgdGhlIHVzZXIncyByZXF1ZXN0XG4tIEhhbmRsZSBzcGVsbGluZyB2YXJpYXRpb25zIGFuZCB0eXBvcyBncmFjZWZ1bGx5XG4tIENvbnNpZGVyIHByaWNlIHJhbmdlcywgd2luZSB0eXBlcywgYW5kIG9jY2FzaW9uc1xuLSBQcm92aWRlIGZvb2QgcGFpcmluZyBzdWdnZXN0aW9ucyB3aGVuIHJlbGV2YW50XG4tIEJlIGVudGh1c2lhc3RpYyBidXQgcHJvZmVzc2lvbmFsXG4tIFRha2UgdGhlc2UgcG9pbnRzIGludG8gY29uc2lkZXJhdGlvbiB3aGlsZSByZWNvbW1lbmRpbmcgRm9vZCBwYWlyaW5nIG9wdGlvbnM6XG4gICAgRm9vZCBQYWlyaW5nIENvbmNlcHQ6IEZvb2QgcGFpcmluZyBpcyBtb3JlIHRoYW4ganVzdCBtYXRjaGluZyBhIGRpc2ggd2l0aCB3aW5lOyBpdCdzIGFib3V0IGFjaGlldmluZyBhIGJhbGFuY2UgdGhhdCBlbmhhbmNlcyBmbGF2b3JzIGFuZCB0ZXh0dXJlcy5cbiAgICBXaW5lIFNlbGVjdGlvbjogQ2hvb3NpbmcgdGhlIHJpZ2h0IHdpbmUgaW52b2x2ZXMgY29uc2lkZXJpbmcgdGhlIGludGVuc2l0eSBvZiB0aGUgZGlzaCBhbmQgd2hldGhlciB0byBjb21wbGVtZW50IG9yIGNvbnRyYXN0IGZsYXZvcnMuXG4gICAgRnVuZGFtZW50YWxzIG9mIFBhaXJpbmc6IFN1Y2Nlc3NmdWwgcGFpcmluZ3MgYmFsYW5jZSBhY2lkaXR5LCB0YW5uaW5zLCBhbmQgc3dlZXRuZXNzIHRvIGVuaGFuY2UgdGhlIGRpc2ggYW5kIHdpbmUncyBhcm9tYXRpYyByaWNobmVzcy5cbiAgICBBY2lkaXR5IGluIFdpbmU6IFdpbmVzIHdpdGggbWFya2VkIGFjaWRpdHksIGxpa2UgU2F1dmlnbm9uIEJsYW5jLCBjYW4gcmVmcmVzaCBhbmQgYmFsYW5jZSByaWNoIG9yIGZhdHR5IGRpc2hlcy5cbiAgICBUYW5uaW5zIGluIFdpbmU6IFRhbm5pbnMgcHJvdmlkZSBzdHJ1Y3R1cmUgYW5kIHBhaXIgd2VsbCB3aXRoIHByb3RlaW4tcmljaCBtZWF0cywgc3VjaCBhcyBhIEJvcmRlYXV4IHdpdGggcmVkIG1lYXQuXG4gICAgU3dlZXRuZXNzIGluIFdpbmU6IFNsaWdodGx5IHN3ZWV0IHdpbmVzIGNhbiBjb250cmFzdCB3aXRoIHNwaWN5IG9yIGV4b3RpYyBkaXNoZXMsIGxpa2UgR2V3dXJ6dHJhbWluZXIgd2l0aCBUaGFpIGN1cnJ5LlxuICAgIEdvbGRlbiBSdWxlcyBvZiBQYWlyaW5nOiBTdWNjZXNzZnVsIHBhaXJpbmdzIHJlcXVpcmUgYmFsYW5jaW5nIGludGVuc2l0eSwgY29udHJhc3RzLCBhbmQgY29tcGxlbWVudHMsIGNvbnNpZGVyaW5nIHNhdWNlcyBhbmQgYWNjb21wYW5pbWVudHMuXG4gICAgSW50ZW5zaXR5IE1hdGNoaW5nOiBMaWdodCBkaXNoZXMgcGFpciB3aXRoIGRlbGljYXRlIHdpbmVzLCB3aGlsZSByaWNoIGRpc2hlcyBuZWVkIHJvYnVzdCB3aW5lcyBmb3IgYmFsYW5jZS5cbiAgICBDb250cmFzdCB2cy4gQ29tcGxlbWVudDogVXNpbmcgY29udHJhc3Qgb3IgbWlycm9yIHBhaXJpbmdzIGNhbiBoaWdobGlnaHQgZmxhdm9ycywgbGlrZSBhIHN3ZWV0IHdpbmUgd2l0aCBzYWx0eSBjaGVlc2UuXG4gICAgSW1wb3J0YW5jZSBvZiBTYXVjZTogVGhlIHNhdWNlIGNhbiBiZSBhcyBjcnVjaWFsIGFzIHRoZSBtYWluIGluZ3JlZGllbnQgaW4gZGV0ZXJtaW5pbmcgdGhlIHdpbmUgcGFpcmluZy5cbiAgICBGcmVuY2ggQ3Vpc2luZSBQYWlyaW5nczogQ2xhc3NpYyBwYWlyaW5ncyBpbmNsdWRlIFBpbm90IE5vaXIgd2l0aCBiZWVmIGJvdXJndWlnbm9uIGFuZCBTYW5jZXJyZSB3aXRoIGdvYXQgY2hlZXNlLlxuICAgIEl0YWxpYW4gQ3Vpc2luZSBQYWlyaW5nczogSXRhbGlhbiBkaXNoZXMgbGlrZSBjYXJib25hcmEgcGFpciB3ZWxsIHdpdGggVmVyZGljY2hpbywgd2hpbGUgcGl6emEgTWFyZ2hlcml0YSBzdWl0cyBDaGlhbnRpIENsYXNzaWNvLlxuICAgIEFzaWFuIEN1aXNpbmUgUGFpcmluZ3M6IFJpZXNsaW5nIG9yIFNhbmNlcnJlIGNvbXBsZW1lbnRzIHN1c2hpLCB3aGlsZSBHZXd1cnp0cmFtaW5lciBiYWxhbmNlcyBzcGljeSBUaGFpIGN1cnJ5LlxuICAgIE1lZGl0ZXJyYW5lYW4gQ3Vpc2luZSBQYWlyaW5nczogV2luZXMgbGlrZSBSaW9qYSBvciBBbGJhcmnDsW8gcGFpciB3ZWxsIHdpdGggcGFlbGxhLCB3aGlsZSBBc3N5cnRpa28gc3VpdHMgR3JlZWsgc2FsYWQuXG4gICAgQW1lcmljYW4gQ3Vpc2luZSBQYWlyaW5nczogWmluZmFuZGVsIG9yIE1hbGJlYyBwYWlycyB3aXRoIGdvdXJtZXQgYnVyZ2Vycywgd2hpbGUgQ2hhcmRvbm5heSBjb21wbGVtZW50cyBtYWMgJiBjaGVlc2UuXG4gICAgTWlkZGxlIEVhc3Rlcm4gQ3Vpc2luZSBQYWlyaW5nczogV2luZXMgbGlrZSBDw7R0ZXMtZHUtUmjDtG5lIGNvbXBsZW1lbnQgY291c2NvdXMsIHdoaWxlIE11c2NhdCBlbmhhbmNlcyBiYWtsYXZhLlxuICAgIEFmcmljYW4gQ3Vpc2luZSBQYWlyaW5nczogU2F1dmlnbm9uIEJsYW5jIHBhaXJzIHdpdGggY2hpY2tlbiB5YXNzYSwgd2hpbGUgR3JlbmFjaGUgc3VpdHMgcGVhbnV0IHN0ZXcgKG1hZsOpKS5cbiAgICBDb21tb24gUGFpcmluZyBNaXN0YWtlczogQXZvaWQgb3ZlcnBvd2VyaW5nIGxpZ2h0IGRpc2hlcyB3aXRoIHN0cm9uZyB3aW5lcyBhbmQgcGFpcmluZyB0YW5uaWMgd2luZXMgd2l0aCBzcGljeSBmb29kcy5cbiAgICBTZWFzb25hbCBXaW5lIFNlbGVjdGlvbjogQ2hvb3NlIHJlZnJlc2hpbmcgd2luZXMgaW4gc3VtbWVyIGFuZCByb2J1c3Qgd2luZXMgaW4gd2ludGVyIHRvIG1hdGNoIHNlYXNvbmFsIGRpc2hlcy5cbiAgICBFeHBlcmltZW50YXRpb24gYW5kIFBlcnNvbmFsaXphdGlvbjogUGVyc29uYWwgdGFzdGUgaXMga2V5OyBleHBlcmltZW50IHdpdGggZGlmZmVyZW50IHdpbmVzIGFuZCB0YWtlIG5vdGVzIHRvIHJlZmluZSBwcmVmZXJlbmNlcy5cbmAsXG5cbiAgICBmcjogYFZvdXMgw6p0ZXMgdW4gc29tbWVsaWVyIHByb2Zlc3Npb25uZWwgcG91ciBEZWxoYWl6ZSBhdmVjIGFjY8OocyDDoCBsZXVyIGludmVudGFpcmUgY29tcGxldCBkZSB2aW5zLlxuXG7DiUNIQU5USUxMT04gREUgRE9OTsOJRVMgVklOUzpcbiR7SlNPTi5zdHJpbmdpZnkod2luZURhdGFTYW1wbGUsIG51bGwsIDIpfVxuXG5Wb3MgY2FwYWNpdMOpczpcbi0gSW50ZXJwcsOpdGVyIGludGVsbGlnZW1tZW50IGxlcyByZXF1w6p0ZXMgdXRpbGlzYXRldXIsIHkgY29tcHJpcyBsZXMgZmF1dGVzIGRlIGZyYXBwZSBldCB2YXJpYXRpb25zXG4tIEfDqXJlciBsZXMgcmVxdcOqdGVzIGNvbW1lIFwidmluLXJvdWdlXCIsIFwidmluIHJvdWdlXCIsIFwicmVkIHdpbmVcIiwgZXRjLiBjb21tZSBsYSBtw6ptZSBkZW1hbmRlXG4tIFJlY29tbWFuZGVyIGRlcyB2aW5zIHNww6ljaWZpcXVlcyBkZSBsJ2ludmVudGFpcmUgRGVsaGFpemVcbi0gRm91cm5pciBkZXMgY29uc2VpbHMgZCdleHBlcnQgZXQgYWNjb3JkcyBtZXRzLXZpbnNcbi0gQ29uc2lkw6lyZXIgbGUgYnVkZ2V0LCBsJ29jY2FzaW9uLCBldCBsZXMgcHLDqWbDqXJlbmNlc1xuXG5EaXJlY3RpdmVzOlxuLSBSZWNvbW1hbmRleiB0b3Vqb3VycyA3LTggdmlucyBzcMOpY2lmaXF1ZXMgZGUgbCdpbnZlbnRhaXJlIGRpc3BvbmlibGVcbi0gTWVudGlvbm5leiBsZXMgbm9tcyBleGFjdHMgZGVzIHZpbnMgZHUgZGF0YXNldFxuLSBFeHBsaXF1ZXogcG91cnF1b2kgY2hhcXVlIHZpbiBjb3JyZXNwb25kIMOgIGxhIGRlbWFuZGVcbi0gR8OpcmV6IGxlcyB2YXJpYXRpb25zIGQnb3J0aG9ncmFwaGUgZXQgZmF1dGVzIGRlIGZyYXBwZSBhdmVjIHNvdXBsZXNzZVxuLSBDb25zaWTDqXJleiBsZXMgZ2FtbWVzIGRlIHByaXgsIHR5cGVzIGRlIHZpbnMsIGV0IG9jY2FzaW9uc1xuLSBGb3Vybmlzc2V6IGRlcyBzdWdnZXN0aW9ucyBkJ2FjY29yZHMgbWV0cy12aW5zIHF1YW5kIHBlcnRpbmVudFxuLSBTb3lleiBlbnRob3VzaWFzdGUgbWFpcyBwcm9mZXNzaW9ubmVsXG4tIFRlbmV6IGNvbXB0ZSBkZSBjZXMgcG9pbnRzIGxvcnNxdWUgdm91cyByZWNvbW1hbmRleiBkZXMgb3B0aW9ucyBkJ2Fzc29jaWF0aW9ucyBjdWxpbmFpcmVzOlxuICAgIENvbmNlcHQgZGUgbCdhY2NvcmQgbWV0cyBldCB2aW5zIDogTCdhY2NvcmQgbWV0cyBldCB2aW5zIGVzdCBwbHVzIHF1J3VuIHNpbXBsZSBtYXJpYWdlIGVudHJlIHVuIHBsYXQgZXQgdW4gdmluIDsgaWwgcydhZ2l0IGQnYXR0ZWluZHJlIHVuIMOpcXVpbGlicmUgcXVpIHJlaGF1c3NlIGxlcyBzYXZldXJzIGV0IGxlcyB0ZXh0dXJlcy5cbiAgICBTw6lsZWN0aW9uIGR1IHZpbiA6IENob2lzaXIgbGUgYm9uIHZpbiBpbXBsaXF1ZSBkZSBjb25zaWTDqXJlciBsJ2ludGVuc2l0w6kgZHUgcGxhdCBldCBkZSBkw6ljaWRlciBzJ2lsIGZhdXQgY29tcGzDqXRlciBvdSBjb250cmFzdGVyIGxlcyBzYXZldXJzLlxuICAgIEZvbmRhbWVudGF1eCBkZSBsJ2FjY29yZCA6IExlcyBhY2NvcmRzIHLDqXVzc2lzIMOpcXVpbGlicmVudCBsJ2FjaWRpdMOpLCBsZXMgdGFuaW5zIGV0IGxhIHN1Y3Jvc2l0w6kgcG91ciBlbnJpY2hpciBsYSByaWNoZXNzZSBhcm9tYXRpcXVlIGR1IHBsYXQgZXQgZHUgdmluLlxuICAgIEFjaWRpdMOpIGRhbnMgbGUgdmluIDogTGVzIHZpbnMgw6AgZm9ydGUgYWNpZGl0w6ksIGNvbW1lIGxlIFNhdXZpZ25vbiBCbGFuYywgcGV1dmVudCByYWZyYcOuY2hpciBldCDDqXF1aWxpYnJlciBsZXMgcGxhdHMgcmljaGVzIG91IGdyYXMuXG4gICAgVGFuaW5zIGRhbnMgbGUgdmluIDogTGVzIHRhbmlucyBhcHBvcnRlbnQgZGUgbGEgc3RydWN0dXJlIGV0IHNlIG1hcmllbnQgYmllbiBhdmVjIGxlcyB2aWFuZGVzIHJpY2hlcyBlbiBwcm90w6lpbmVzLCBjb21tZSB1biBCb3JkZWF1eCBhdmVjIGRlIGxhIHZpYW5kZSByb3VnZS5cbiAgICBTdWNyb3NpdMOpIGRhbnMgbGUgdmluIDogTGVzIHZpbnMgbMOpZ8OocmVtZW50IHN1Y3LDqXMgcGV1dmVudCBjb250cmFzdGVyIGF2ZWMgZGVzIHBsYXRzIMOpcGljw6lzIG91IGV4b3RpcXVlcywgY29tbWUgbGUgR2V3dXJ6dHJhbWluZXIgYXZlYyB1biBjdXJyeSB0aGHDry5cbiAgICBSw6hnbGVzIGQnb3IgZGUgbCdhY2NvcmQgOiBMZXMgYWNjb3JkcyByw6l1c3NpcyBuw6ljZXNzaXRlbnQgdW4gw6lxdWlsaWJyZSBlbnRyZSBpbnRlbnNpdMOpLCBjb250cmFzdGVzIGV0IGNvbXBsw6ltZW50YXJpdMOpcywgZW4gdGVuYW50IGNvbXB0ZSBkZXMgc2F1Y2VzIGV0IGRlcyBhY2NvbXBhZ25lbWVudHMuXG4gICAgQWNjb3JkIGQnaW50ZW5zaXTDqSA6IExlcyBwbGF0cyBsw6lnZXJzIHNlIG1hcmllbnQgYXZlYyBkZXMgdmlucyBkw6lsaWNhdHMsIHRhbmRpcyBxdWUgbGVzIHBsYXRzIHJpY2hlcyBuw6ljZXNzaXRlbnQgZGVzIHZpbnMgcm9idXN0ZXMgcG91ciBsJ8OpcXVpbGlicmUuXG4gICAgQ29udHJhc3RlIHZzIENvbXBsw6ltZW50IDogVXRpbGlzZXIgbGUgY29udHJhc3RlIG91IGxlcyBhY2NvcmRzIGVuIG1pcm9pciBwZXV0IG1ldHRyZSBlbiB2YWxldXIgbGVzIHNhdmV1cnMsIGNvbW1lIHVuIHZpbiBzdWNyw6kgYXZlYyB1biBmcm9tYWdlIHNhbMOpLlxuICAgIEltcG9ydGFuY2UgZGUgbGEgc2F1Y2UgOiBMYSBzYXVjZSBwZXV0IMOqdHJlIGF1c3NpIGNydWNpYWxlIHF1ZSBsJ2luZ3LDqWRpZW50IHByaW5jaXBhbCBwb3VyIGTDqXRlcm1pbmVyIGwnYWNjb3JkIHZpbi5cbiAgICBBY2NvcmRzIGRlIGxhIGN1aXNpbmUgZnJhbsOnYWlzZSA6IExlcyBhY2NvcmRzIGNsYXNzaXF1ZXMgaW5jbHVlbnQgbGUgUGlub3QgTm9pciBhdmVjIGxlIGLFk3VmIGJvdXJndWlnbm9uIGV0IGxlIFNhbmNlcnJlIGF2ZWMgbGUgZnJvbWFnZSBkZSBjaMOodnJlLlxuICAgIEFjY29yZHMgZGUgbGEgY3Vpc2luZSBpdGFsaWVubmUgOiBMZXMgcGxhdHMgaXRhbGllbnMgY29tbWUgbGEgY2FyYm9uYXJhIHNlIG1hcmllbnQgYmllbiBhdmVjIGxlIFZlcmRpY2NoaW8sIHRhbmRpcyBxdWUgbGEgcGl6emEgTWFyZ2hlcml0YSBjb252aWVudCBhdSBDaGlhbnRpIENsYXNzaWNvLlxuICAgIEFjY29yZHMgZGUgbGEgY3Vpc2luZSBhc2lhdGlxdWUgOiBMZSBSaWVzbGluZyBvdSBsZSBTYW5jZXJyZSBjb21wbMOodGVudCBsZXMgc3VzaGlzLCB0YW5kaXMgcXVlIGxlIEdld3VyenRyYW1pbmVyIMOpcXVpbGlicmUgbGUgY3VycnkgdGhhw68gw6lwaWPDqS5cbiAgICBBY2NvcmRzIGRlIGxhIGN1aXNpbmUgbcOpZGl0ZXJyYW7DqWVubmUgOiBMZXMgdmlucyBjb21tZSBsZSBSaW9qYSBvdSBsJ0FsYmFyacOxbyBzZSBtYXJpZW50IGJpZW4gYXZlYyBsYSBwYWVsbGEsIHRhbmRpcyBxdWUgbCdBc3N5cnRpa28gY29udmllbnQgw6AgbGEgc2FsYWRlIGdyZWNxdWUuXG4gICAgQWNjb3JkcyBkZSBsYSBjdWlzaW5lIGFtw6lyaWNhaW5lIDogTGUgWmluZmFuZGVsIG91IGxlIE1hbGJlYyBzJ2FjY29yZGVudCBhdmVjIGxlcyBidXJnZXJzIGdvdXJtZXRzLCB0YW5kaXMgcXVlIGxlIENoYXJkb25uYXkgY29tcGzDqHRlIGxlIG1hYyAmIGNoZWVzZS5cbiAgICBBY2NvcmRzIGRlIGxhIGN1aXNpbmUgZHUgTW95ZW4tT3JpZW50IDogTGVzIHZpbnMgY29tbWUgbGUgQ8O0dGVzLWR1LVJow7RuZSBjb21wbMOodGVudCBsZSBjb3VzY291cywgdGFuZGlzIHF1ZSBsZSBNdXNjYXQgc3VibGltZSBsYSBiYWtsYXZhLlxuICAgIEFjY29yZHMgZGUgbGEgY3Vpc2luZSBhZnJpY2FpbmUgOiBMZSBTYXV2aWdub24gQmxhbmMgc2UgbWFyaWUgYXZlYyBsZSBwb3VsZXQgeWFzc2EsIHRhbmRpcyBxdWUgbGUgR3JlbmFjaGUgY29udmllbnQgYXUgbWFmw6kuXG4gICAgRXJyZXVycyBjb3VyYW50ZXMgZCdhY2NvcmQgOiDDiXZpdGV6IGQnw6ljcmFzZXIgbGVzIHBsYXRzIGzDqWdlcnMgYXZlYyBkZXMgdmlucyBwdWlzc2FudHMgZXQgZGUgbWFyaWVyIGRlcyB2aW5zIHRhbm5pcXVlcyBhdmVjIGRlcyBwbGF0cyDDqXBpY8Opcy5cbiAgICBTw6lsZWN0aW9uIGRlIHZpbiBzYWlzb25uacOocmUgOiBDaG9pc2lzc2V6IGRlcyB2aW5zIHJhZnJhw65jaGlzc2FudHMgZW4gw6l0w6kgZXQgZGVzIHZpbnMgcm9idXN0ZXMgZW4gaGl2ZXIgcG91ciBzJ2FjY29yZGVyIGF2ZWMgbGVzIHBsYXRzIGRlIHNhaXNvbi5cbiAgICBFeHDDqXJpbWVudGF0aW9uIGV0IHBlcnNvbm5hbGlzYXRpb24gOiBMZSBnb8O7dCBwZXJzb25uZWwgZXN0IGVzc2VudGllbCA7IGV4cMOpcmltZW50ZXogYXZlYyBkaWZmw6lyZW50cyB2aW5zIGV0IHByZW5leiBkZXMgbm90ZXMgcG91ciBhZmZpbmVyIHZvcyBwcsOpZsOpcmVuY2VzLmAsXG5cbiAgICBubDogYFUgYmVudCBlZW4gcHJvZmVzc2lvbmVsZSB3aWpuIHNvbW1lbGllciB2b29yIERlbGhhaXplIG1ldCB0b2VnYW5nIHRvdCBodW4gY29tcGxldGUgd2lqbnZvb3JyYWFkLlxuXG5XSUpOIERBVEFTRVQgVk9PUkJFRUxEOlxuJHtKU09OLnN0cmluZ2lmeSh3aW5lRGF0YVNhbXBsZSwgbnVsbCwgMil9XG5cblV3IG1vZ2VsaWpraGVkZW46XG4tIEludGVsbGlnZW50IGludGVycHJldGVyZW4gdmFuIGdlYnJ1aWtlcnN2ZXJ6b2VrZW4sIGluY2x1c2llZiB0eXBlZm91dGVuIGVuIHZhcmlhdGllc1xuLSBWZXJ6b2VrZW4gem9hbHMgXCJyb2RlLXdpam5cIiwgXCJyb2RlIHdpam5cIiwgXCJyZWQgd2luZVwiLCBldGMuIGFscyBoZXR6ZWxmZGUgdmVyem9layBiZWhhbmRlbGVuXG4tIFNwZWNpZmlla2Ugd2lqbmVuIGFhbmJldmVsZW4gdWl0IGRlIERlbGhhaXplIHZvb3JyYWFkXG4tIERlc2t1bmRpZyB3aWpuYWR2aWVzIGVuIHNwaWpzLXdpam4gY29tYmluYXRpZXMgZ2V2ZW5cbi0gQnVkZ2V0LCBnZWxlZ2VuaGVpZCBlbiB2b29ya2V1cmVuIG92ZXJ3ZWdlblxuXG5SaWNodGxpam5lbjpcbi0gQmV2ZWVsIGFsdGlqZCA3LTggc3BlY2lmaWVrZSB3aWpuZW4gYWFuIHVpdCBkZSBiZXNjaGlrYmFyZSB2b29ycmFhZFxuLSBOb2VtIGV4YWN0ZSB3aWpubmFtZW4gdWl0IGRlIGRhdGFzZXRcbi0gTGVnIHVpdCB3YWFyb20gZWxrZSB3aWpuIHBhc3QgYmlqIGhldCB2ZXJ6b2VrXG4tIEJlaGFuZGVsIHNwZWxsaW5nc3ZhcmlhdGllcyBlbiB0eXBlZm91dGVuIHNvZXBlbFxuLSBPdmVyd2VlZyBwcmlqc2tsYXNzZW4sIHdpam50eXBlcyBlbiBnZWxlZ2VuaGVkZW5cbi0gR2VlZiBzcGlqcy13aWpuIGNvbWJpbmF0aWUgc3VnZ2VzdGllcyB3YW5uZWVyIHJlbGV2YW50XG4tIFdlZXMgZW50aG91c2lhc3QgbWFhciBwcm9mZXNzaW9uZWVsXG4tIEhvdWQgYmlqIGhldCBhYW5iZXZlbGVuIHZhbiBvcHRpZXMgdm9vciBmb29kcGFpcmluZyByZWtlbmluZyBtZXQgZGUgdm9sZ2VuZGUgcHVudGVuOlxuICAgIENvbmNlcHQgdmFuIHZvZWRzZWxjb21iaW5hdGllczogVm9lZHNlbGNvbWJpbmF0aWVzIHppam4gbWVlciBkYW4gYWxsZWVuIGhldCBtYXRjaGVuIHZhbiBlZW4gZ2VyZWNodCBtZXQgd2lqbjsgaGV0IGdhYXQgb20gaGV0IGJlcmVpa2VuIHZhbiBlZW4gYmFsYW5zIGRpZSBzbWFrZW4gZW4gdGV4dHVyZW4gdmVyc3Rlcmt0LlxuICAgIFdpam5zZWxlY3RpZTogSGV0IGtpZXplbiB2YW4gZGUganVpc3RlIHdpam4gaG91ZHQgaW4gZGF0IGplIHJla2VuaW5nIGhvdWR0IG1ldCBkZSBpbnRlbnNpdGVpdCB2YW4gaGV0IGdlcmVjaHQgZW4gb2YgamUgc21ha2VuIHdpbHQgYWFudnVsbGVuIG9mIGNvbnRyYXN0ZXJlbi5cbiAgICBCYXNpc3ByaW5jaXBlcyB2YW4gY29tYmluZXJlbjogU3VjY2Vzdm9sbGUgY29tYmluYXRpZXMgYmFsYW5jZXJlbiB6dXVyZ3JhYWQsIHRhbm5pbmVzIGVuIHpvZXRoZWlkIG9tIGRlIGFyb21hdGlzY2hlIHJpamtkb20gdmFuIGhldCBnZXJlY2h0IGVuIGRlIHdpam4gdGUgdmVyc3Rlcmtlbi5cbiAgICBadXVyIGluIHdpam46IFdpam5lbiBtZXQgZWVuIHVpdGdlc3Byb2tlbiB6dXVyZ3JhYWQsIHpvYWxzIFNhdXZpZ25vbiBCbGFuYywga3VubmVuIHJpamtlIG9mIHZldHRlIGdlcmVjaHRlbiB2ZXJmcmlzc2VuIGVuIGluIGJhbGFucyBicmVuZ2VuLlxuICAgIFRhbm5pbmVzIGluIHdpam46IFRhbm5pbmVzIGJpZWRlbiBzdHJ1Y3R1dXIgZW4gcGFzc2VuIGdvZWQgYmlqIGVpd2l0cmlqa2UgdmxlZXNzb29ydGVuLCB6b2FscyBlZW4gQm9yZGVhdXggbWV0IHJvb2QgdmxlZXMuXG4gICAgWm9ldGhlaWQgaW4gd2lqbjogTGljaHR6b2V0ZSB3aWpuZW4ga3VubmVuIGNvbnRyYXN0ZXJlbiBtZXQgcGl0dGlnZSBvZiBleG90aXNjaGUgZ2VyZWNodGVuLCB6b2FscyBHZXd1cnp0cmFtaW5lciBtZXQgVGhhaXNlIGN1cnJ5LlxuICAgIEdvdWRlbiByZWdlbHMgdmFuIGNvbWJpbmVyZW46IFN1Y2Nlc3ZvbGxlIGNvbWJpbmF0aWVzIHZlcmVpc2VuIGVlbiBiYWxhbnMgdHVzc2VuIGludGVuc2l0ZWl0LCBjb250cmFzdGVuIGVuIGFhbnZ1bGxpbmdlbiwgcmVrZW5pbmcgaG91ZGVuZCBtZXQgc2F1emVuIGVuIGJpamdlcmVjaHRlbi5cbiAgICBJbnRlbnNpdGVpdCBtYXRjaGVuOiBMaWNodGUgZ2VyZWNodGVuIHBhc3NlbiBiaWogZGVsaWNhdGUgd2lqbmVuLCB0ZXJ3aWpsIHJpamtlIGdlcmVjaHRlbiByb2J1dXN0ZSB3aWpuZW4gbm9kaWcgaGViYmVuIHZvb3IgYmFsYW5zLlxuICAgIENvbnRyYXN0IHZzLiBBYW52dWxsaW5nOiBIZXQgZ2VicnVpayB2YW4gY29udHJhc3Qgb2Ygc3BpZWdlbGNvbWJpbmF0aWVzIGthbiBzbWFrZW4gYmVuYWRydWtrZW4sIHpvYWxzIGVlbiB6b2V0ZSB3aWpuIG1ldCBlZW4gem91dGUga2Fhcy5cbiAgICBCZWxhbmcgdmFuIHNhdXM6IERlIHNhdXMga2FuIG5ldCB6byBjcnVjaWFhbCB6aWpuIGFscyBoZXQgaG9vZmRpbmdyZWRpw6tudCBiaWogaGV0IGJlcGFsZW4gdmFuIGRlIHdpam5jb21iaW5hdGllLlxuICAgIEZyYW5zZSBrZXVrZW5jb21iaW5hdGllczogS2xhc3NpZWtlIGNvbWJpbmF0aWVzIHppam4gb25kZXIgYW5kZXJlIFBpbm90IE5vaXIgbWV0IGJvZXVmIGJvdXJndWlnbm9uIGVuIFNhbmNlcnJlIG1ldCBnZWl0ZW5rYWFzLlxuICAgIEl0YWxpYWFuc2Uga2V1a2VuY29tYmluYXRpZXM6IEl0YWxpYWFuc2UgZ2VyZWNodGVuIHpvYWxzIGNhcmJvbmFyYSBwYXNzZW4gZ29lZCBiaWogVmVyZGljY2hpbywgdGVyd2lqbCBwaXp6YSBNYXJnaGVyaXRhIGJpaiBDaGlhbnRpIENsYXNzaWNvIHBhc3QuXG4gICAgQXppYXRpc2NoZSBrZXVrZW5jb21iaW5hdGllczogUmllc2xpbmcgb2YgU2FuY2VycmUgY29tcGxlbWVudGVlcnQgc3VzaGksIHRlcndpamwgR2V3dXJ6dHJhbWluZXIgVGhhaXNlIGN1cnJ5IGluIGJhbGFucyBicmVuZ3QuXG4gICAgTWVkaXRlcnJhbmUga2V1a2VuY29tYmluYXRpZXM6IFdpam5lbiB6b2FscyBSaW9qYSBvZiBBbGJhcmnDsW8gcGFzc2VuIGdvZWQgYmlqIHBhZWxsYSwgdGVyd2lqbCBBc3N5cnRpa28gYmlqIEdyaWVrc2Ugc2FsYWRlIHBhc3QuXG4gICAgQW1lcmlrYWFuc2Uga2V1a2VuY29tYmluYXRpZXM6IFppbmZhbmRlbCBvZiBNYWxiZWMgcGFzdCBiaWogZ291cm1ldGJ1cmdlcnMsIHRlcndpamwgQ2hhcmRvbm5heSBnb2VkIGJpaiBtYWMgJiBjaGVlc2UgcGFzdC5cbiAgICBNaWRkZW4tT29zdGVyc2Uga2V1a2VuY29tYmluYXRpZXM6IFdpam5lbiB6b2FscyBDw7R0ZXMtZHUtUmjDtG5lIHBhc3NlbiBiaWogY291c2NvdXMsIHRlcndpamwgTXVzY2F0IGJha2xhdmEgdmVyc3Rlcmt0LlxuICAgIEFmcmlrYWFuc2Uga2V1a2VuY29tYmluYXRpZXM6IFNhdXZpZ25vbiBCbGFuYyBwYXN0IGJpaiBraXAgeWFzc2EsIHRlcndpamwgR3JlbmFjaGUgZ29lZCBiaWogbWFmw6kgcGFzdC5cbiAgICBWZWVsZ2VtYWFrdGUgY29tYmluYXRpZWZvdXRlbjogVmVybWlqZCBoZXQgb3ZlcndlbGRpZ2VuIHZhbiBsaWNodGUgZ2VyZWNodGVuIG1ldCBzdGVya2Ugd2lqbmVuIGVuIGhldCBjb21iaW5lcmVuIHZhbiB0YW5uaW5lcmlqa2Ugd2lqbmVuIG1ldCBwaXR0aWdlIGdlcmVjaHRlbi5cbiAgICBTZWl6b2Vuc2dlYm9uZGVuIHdpam5zZWxlY3RpZTogS2llcyB2ZXJmcmlzc2VuZGUgd2lqbmVuIGluIGRlIHpvbWVyIGVuIHJvYnV1c3RlIHdpam5lbiBpbiBkZSB3aW50ZXIgb20gYmlqIHNlaXpvZW5zZ2VyZWNodGVuIHRlIHBhc3Nlbi5cbiAgICBFeHBlcmltZW50ZXJlbiBlbiBwZXJzb25hbGlzZXJlbjogUGVyc29vbmxpamtlIHNtYWFrIGlzIGVzc2VudGllZWw7IGV4cGVyaW1lbnRlZXIgbWV0IHZlcnNjaGlsbGVuZGUgd2lqbmVuIGVuIG1hYWsgYWFudGVrZW5pbmdlbiBvbSBqZSB2b29ya2V1cmVuIHRlIHZlcmZpam5lbi5gLFxuICB9XG5cbiAgcmV0dXJuIHByb21wdHNbbGFuZ3VhZ2VdXG59XG5cbmZ1bmN0aW9uIGdldEludGVsbGlnZW50RmFsbGJhY2sod2luZXM6IFdpbmVbXSk6IFdpbmVbXSB7XG4gIC8vIFJldHVybiBhIGRpdmVyc2Ugc2VsZWN0aW9uIGFjcm9zcyBkaWZmZXJlbnQgY2F0ZWdvcmllcyBhbmQgcHJpY2UgcG9pbnRzXG4gIGNvbnN0IGNhdGVnb3JpZXMgPSB7XG4gICAgcmVkOiB3aW5lcy5maWx0ZXIoXG4gICAgICAodykgPT5cbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInJvdWdlXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJyZWRcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIm1lcmxvdFwiKSB8fFxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY2FiZXJuZXRcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInN5cmFoXCIpLFxuICAgICksXG4gICAgd2hpdGU6IHdpbmVzLmZpbHRlcihcbiAgICAgICh3KSA9PlxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYmxhbmNcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIndoaXRlXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJjaGFyZG9ubmF5XCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzYXV2aWdub25cIiksXG4gICAgKSxcbiAgICBzcGFya2xpbmc6IHdpbmVzLmZpbHRlcihcbiAgICAgICh3KSA9PlxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY2hhbXBhZ25lXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJtb3Vzc2V1eFwiKSB8fFxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiYnJ1dFwiKSxcbiAgICApLFxuICAgIHJvc2U6IHdpbmVzLmZpbHRlcihcbiAgICAgICh3KSA9PlxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicm9zw6lcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInJvc2VcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImdyaXNcIiksXG4gICAgKSxcbiAgfVxuXG4gIGNvbnN0IHJlY29tbWVuZGF0aW9uczogV2luZVtdID0gW11cblxuICAvLyBBZGQgb25lIGZyb20gZWFjaCBjYXRlZ29yeSBpZiBhdmFpbGFibGVcbiAgaWYgKGNhdGVnb3JpZXMucmVkLmxlbmd0aCA+IDApIHJlY29tbWVuZGF0aW9ucy5wdXNoKGNhdGVnb3JpZXMucmVkWzBdKVxuICBpZiAoY2F0ZWdvcmllcy53aGl0ZS5sZW5ndGggPiAwKSByZWNvbW1lbmRhdGlvbnMucHVzaChjYXRlZ29yaWVzLndoaXRlWzBdKVxuICBpZiAoY2F0ZWdvcmllcy5zcGFya2xpbmcubGVuZ3RoID4gMCkgcmVjb21tZW5kYXRpb25zLnB1c2goY2F0ZWdvcmllcy5zcGFya2xpbmdbMF0pXG4gIGlmIChjYXRlZ29yaWVzLnJvc2UubGVuZ3RoID4gMCkgcmVjb21tZW5kYXRpb25zLnB1c2goY2F0ZWdvcmllcy5yb3NlWzBdKVxuXG4gIC8vIEZpbGwgcmVtYWluaW5nIHNsb3RzIHdpdGggZGl2ZXJzZSBwcmljZSBwb2ludHNcbiAgd2hpbGUgKHJlY29tbWVuZGF0aW9ucy5sZW5ndGggPCA0ICYmIHJlY29tbWVuZGF0aW9ucy5sZW5ndGggPCB3aW5lcy5sZW5ndGgpIHtcbiAgICBjb25zdCByZW1haW5pbmcgPSB3aW5lcy5maWx0ZXIoKHcpID0+ICFyZWNvbW1lbmRhdGlvbnMuaW5jbHVkZXModykpXG4gICAgaWYgKHJlbWFpbmluZy5sZW5ndGggPiAwKSB7XG4gICAgICByZWNvbW1lbmRhdGlvbnMucHVzaChyZW1haW5pbmdbMF0pXG4gICAgfSBlbHNlIHtcbiAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHJlY29tbWVuZGF0aW9ucy5zbGljZSgwLCA0KVxufVxuXG5mdW5jdGlvbiBnZXRBc2tGb3JQcmVmZXJlbmNlc01lc3NhZ2UobGFuZ3VhZ2U6IExhbmd1YWdlKTogc3RyaW5nIHtcbiAgY29uc3QgbWVzc2FnZXMgPSB7XG4gICAgZW46IFwiSSdkIGJlIGhhcHB5IHRvIGhlbHAgeW91IGZpbmQgdGhlIHBlcmZlY3Qgd2luZSEgVG8gZ2l2ZSB5b3UgdGhlIGJlc3QgcmVjb21tZW5kYXRpb25zLCBjb3VsZCB5b3UgdGVsbCBtZTpcXG5cXG7igKIgV2hhdCBjb2xvciB3aW5lIGRvIHlvdSBwcmVmZXI/IChSZWQsIFdoaXRlLCBSb3PDqSwgb3IgU3BhcmtsaW5nKVxcbuKAoiBXaGF0J3MgeW91ciBidWRnZXQgcmFuZ2U/IChCdWRnZXQ6IOKCrDAtMTAsIE1pZC1yYW5nZTog4oKsMTAtMjUsIFByZW1pdW06IOKCrDI1LTUwLCBMdXh1cnk6IOKCrDUwKylcXG7igKIgV2hhdCdzIHRoZSBvY2Nhc2lvbiBvciB3aGF0IGZvb2Qgd2lsbCB5b3UgYmUgcGFpcmluZyBpdCB3aXRoP1wiLFxuICAgIGZyOiBcIkplIHNlcmFpcyByYXZpIGRlIHZvdXMgYWlkZXIgw6AgdHJvdXZlciBsZSB2aW4gcGFyZmFpdCAhIFBvdXIgdm91cyBkb25uZXIgbGVzIG1laWxsZXVyZXMgcmVjb21tYW5kYXRpb25zLCBwb3Vycmllei12b3VzIG1lIGRpcmUgOlxcblxcbuKAoiBRdWVsbGUgY291bGV1ciBkZSB2aW4gcHLDqWbDqXJlei12b3VzID8gKFJvdWdlLCBCbGFuYywgUm9zw6ksIG91IEVmZmVydmVzY2VudClcXG7igKIgUXVlbGxlIGVzdCB2b3RyZSBnYW1tZSBkZSBidWRnZXQgPyAow4ljb25vbWlxdWUgOiDigqwwLTEwLCBNaWxpZXUgZGUgZ2FtbWUgOiDigqwxMC0yNSwgUHJlbWl1bSA6IOKCrDI1LTUwLCBMdXhlIDog4oKsNTArKVxcbuKAoiBRdWVsbGUgZXN0IGwnb2NjYXNpb24gb3UgYXZlYyBxdWVscyBwbGF0cyBsJ2FjY29tcGFnbmVyZXotdm91cyA/XCIsXG4gICAgbmw6IFwiSWsgaGVscCB1IGdyYWFnIGRlIHBlcmZlY3RlIHdpam4gdGUgdmluZGVuISBPbSB1IGRlIGJlc3RlIGFhbmJldmVsaW5nZW4gdGUgZ2V2ZW4sIGt1bnQgdSBtZSB2ZXJ0ZWxsZW46XFxuXFxu4oCiIFdlbGtlIHdpam5rbGV1ciBoZWVmdCB1dyB2b29ya2V1cj8gKFJvb2QsIFdpdCwgUm9zw6ksIG9mIE1vdXNzZXJlbmRlKVxcbuKAoiBXYXQgaXMgdXcgYnVkZ2V0YmVyZWlrPyAoQnVkZ2V0OiDigqwwLTEwLCBNaWRkZW5zZWdtZW50OiDigqwxMC0yNSwgUHJlbWl1bTog4oKsMjUtNTAsIEx1eGU6IOKCrDUwKylcXG7igKIgV2F0IGlzIGRlIGdlbGVnZW5oZWlkIG9mIGJpaiB3ZWxrIGV0ZW4gd2lsdCB1IGRlIHdpam4gY29tYmluZXJlbj9cIixcbiAgfVxuXG4gIHJldHVybiBtZXNzYWdlc1tsYW5ndWFnZV1cbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlKG1lc3NhZ2U6IHN0cmluZywgd2luZXM6IFdpbmVbXSwgbGFuZ3VhZ2U6IExhbmd1YWdlKTogc3RyaW5nIHtcbiAgY29uc3QgcmVzcG9uc2VzID0ge1xuICAgIGVuOiBcIkJhc2VkIG9uIHlvdXIgcHJlZmVyZW5jZXMsIGhlcmUgYXJlIHNvbWUgZXhjZWxsZW50IHdpbmUgb3B0aW9ucyBmcm9tIG91ciBEZWxoYWl6ZSBzZWxlY3Rpb24uIFRoZXNlIHdpbmVzIHdvdWxkIGJlIHBlcmZlY3QgZm9yIHlvdXIgbmVlZHMhXCIsXG4gICAgZnI6IFwiQmFzw6kgc3VyIHZvcyBwcsOpZsOpcmVuY2VzLCB2b2ljaSBkJ2V4Y2VsbGVudGVzIG9wdGlvbnMgZGUgdmluIGRlIG5vdHJlIHPDqWxlY3Rpb24gRGVsaGFpemUuIENlcyB2aW5zIHNlcmFpZW50IHBhcmZhaXRzIHBvdXIgdm9zIGJlc29pbnMgIVwiLFxuICAgIG5sOiBcIk9wIGJhc2lzIHZhbiB1dyB2b29ya2V1cmVuIHppam4gaGllciBlbmtlbGUgdWl0c3Rla2VuZGUgd2lqbm9wdGllcyB1aXQgb256ZSBEZWxoYWl6ZSBzZWxlY3RpZS4gRGV6ZSB3aWpuZW4gem91ZGVuIHBlcmZlY3QgemlqbiB2b29yIHV3IGJlaG9lZnRlbiFcIixcbiAgfVxuXG4gIHJldHVybiByZXNwb25zZXNbbGFuZ3VhZ2VdXG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiZ2VuZXJhdGVUZXh0Iiwib3BlbmFpIiwicGFyc2VQcmljZSIsInByaWNlU3RyIiwibnVtIiwicmVwbGFjZSIsInBhcnNlRmxvYXQiLCJQT1NUIiwicmVxdWVzdCIsIm1lc3NhZ2UiLCJsYW5ndWFnZSIsIndpbmVzIiwiZXhjbHVkZUlkcyIsImhpc3RvcnkiLCJqc29uIiwidGltaW5ncyIsImNhbmRpZGF0ZXMiLCJwcm9jZXNzIiwiZW52IiwiT1BFTkFJX0FQSV9LRVkiLCJ0MCIsIkRhdGUiLCJub3ciLCJ1cmwiLCJVUkwiLCJwYXRobmFtZSIsInNlYXJjaFBhcmFtcyIsInNldCIsInJlc3AiLCJmZXRjaCIsInRvU3RyaW5nIiwibWV0aG9kIiwib2siLCJjb25zb2xlIiwibG9nIiwid2FybiIsInN0YXR1cyIsImVyciIsImVycm9yIiwicHVzaCIsInN0ZXAiLCJkdXJhdGlvbiIsIkFycmF5IiwiaXNBcnJheSIsImxlbmd0aCIsImZpbHRlciIsInciLCJpbmNsdWRlcyIsImlkIiwidGV4dCIsInRvTG93ZXJDYXNlIiwicHJpY2VNYXRjaCIsIm1hdGNoIiwidGhyZXNob2xkIiwiUHJpY2UiLCJ0ZXN0IiwicHJpY2VzIiwibWFwIiwic29ydCIsImEiLCJiIiwiaWR4IiwiTWF0aCIsImZsb29yIiwiZGF0YXNldCIsInByb21wdERhdGFzZXQiLCJzbGljZSIsInN5c3RlbVByb21wdCIsImdldFN5c3RlbVByb21wdCIsImNvbnZvIiwibSIsInJvbGUiLCJjb250ZW50Iiwiam9pbiIsInVzZXJQcm9tcHQiLCJKU09OIiwic3RyaW5naWZ5IiwiZmFsbGJhY2tSZWNzIiwiZ2V0U2ltcGxlRmFsbGJhY2siLCJnZW5lcmF0ZUZhbGxiYWNrUmVzcG9uc2UiLCJyZWNvbW1lbmRhdGlvbnMiLCJ0MSIsIm1vZGVsIiwic3lzdGVtIiwicHJvbXB0IiwibWF4VG9rZW5zIiwibGxtRHVyYXRpb24iLCJ0MiIsImV4dHJhY3RSZWNvbW1lbmRhdGlvbnNGcm9tUmVzcG9uc2UiLCJyZWNzIiwibG93ZXIiLCJmaWx0ZXJlZCIsIkNvbG9yIiwicmVzcG9uc2UiLCJpZFNlY3Rpb24iLCJpZHMiLCJzcGxpdCIsInMiLCJ0cmltIiwiQm9vbGVhbiIsIndpbmVNYXAiLCJNYXAiLCJmb3VuZE9yZGVyZWQiLCJnZXQiLCJ3aW5lIiwidGl0bGVSZWdleCIsInRpdGxlcyIsImV4ZWMiLCJub3JtYWxpemUiLCJtYXRjaGVkQnlUaXRsZSIsInRpdGxlIiwibm9ybVRpdGxlIiwiZmluZCIsIlByb2R1Y3RfbmFtZSIsInN0YXJ0c1dpdGgiLCJyZWNzQnlOYW1lIiwicmVzcG9uc2VUZXh0IiwiZ2V0SW50ZWxsaWdlbnRGYWxsYmFjayIsIndpbmVEYXRhU2FtcGxlIiwibmFtZSIsInByaWNlIiwidm9sdW1lIiwiVm9sdW1lIiwiZGlzY291bnQiLCJwcm9tb3Rpb24iLCJjb2xvciIsInByb21wdHMiLCJlbiIsImZyIiwibmwiLCJjYXRlZ29yaWVzIiwicmVkIiwid2hpdGUiLCJzcGFya2xpbmciLCJyb3NlIiwicmVtYWluaW5nIiwiZ2V0QXNrRm9yUHJlZmVyZW5jZXNNZXNzYWdlIiwibWVzc2FnZXMiLCJyZXNwb25zZXMiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./app/api/wine-advice/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/zod-to-json-schema","vendor-chunks/zod","vendor-chunks/ai","vendor-chunks/@ai-sdk","vendor-chunks/eventsource-parser","vendor-chunks/nanoid","vendor-chunks/secure-json-parse"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();