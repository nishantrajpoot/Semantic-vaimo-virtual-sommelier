"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/wine-advice/route";
exports.ids = ["app/api/wine-advice/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _home_nishant_project_v0_UI_Semantic_vaimo_virtual_sommelier_app_api_wine_advice_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./app/api/wine-advice/route.ts */ \"(rsc)/./app/api/wine-advice/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/wine-advice/route\",\n        pathname: \"/api/wine-advice\",\n        filename: \"route\",\n        bundlePath: \"app/api/wine-advice/route\"\n    },\n    resolvedPagePath: \"/home/nishant/project/v0/UI/Semantic-vaimo-virtual-sommelier/app/api/wine-advice/route.ts\",\n    nextConfigOutput,\n    userland: _home_nishant_project_v0_UI_Semantic_vaimo_virtual_sommelier_app_api_wine_advice_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/wine-advice/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZ3aW5lLWFkdmljZSUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGd2luZS1hZHZpY2UlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZ3aW5lLWFkdmljZSUyRnJvdXRlLnRzJmFwcERpcj0lMkZob21lJTJGbmlzaGFudCUyRnByb2plY3QlMkZ2MCUyRlVJJTJGU2VtYW50aWMtdmFpbW8tdmlydHVhbC1zb21tZWxpZXIlMkZhcHAmcGFnZUV4dGVuc2lvbnM9dHN4JnBhZ2VFeHRlbnNpb25zPXRzJnBhZ2VFeHRlbnNpb25zPWpzeCZwYWdlRXh0ZW5zaW9ucz1qcyZyb290RGlyPSUyRmhvbWUlMkZuaXNoYW50JTJGcHJvamVjdCUyRnYwJTJGVUklMkZTZW1hbnRpYy12YWltby12aXJ0dWFsLXNvbW1lbGllciZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ2M7QUFDeUM7QUFDdEg7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLGdIQUFtQjtBQUMzQztBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBLFlBQVk7QUFDWixDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0EsUUFBUSxpRUFBaUU7QUFDekU7QUFDQTtBQUNBLFdBQVcsNEVBQVc7QUFDdEI7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUN1SDs7QUFFdkgiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aW5lLXNvbW1lbGllci1hZ2VudC8/NjkyZiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIvaG9tZS9uaXNoYW50L3Byb2plY3QvdjAvVUkvU2VtYW50aWMtdmFpbW8tdmlydHVhbC1zb21tZWxpZXIvYXBwL2FwaS93aW5lLWFkdmljZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS93aW5lLWFkdmljZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvaG9tZS9uaXNoYW50L3Byb2plY3QvdjAvVUkvU2VtYW50aWMtdmFpbW8tdmlydHVhbC1zb21tZWxpZXIvYXBwL2FwaS93aW5lLWFkdmljZS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvd2luZS1hZHZpY2Uvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./app/api/wine-advice/route.ts":
/*!**************************************!*\
  !*** ./app/api/wine-advice/route.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var ai__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ai */ \"(rsc)/./node_modules/ai/dist/index.mjs\");\n/* harmony import */ var _ai_sdk_openai__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @ai-sdk/openai */ \"(rsc)/./node_modules/@ai-sdk/openai/dist/index.mjs\");\n// @ts-nocheck\n\n\n\n// Helper to parse price strings like \"13,99 €\" -> 13.99\nfunction parsePrice(priceStr) {\n    const num = priceStr.replace(/[^0-9,.-]/g, \"\").replace(\",\", \".\");\n    return parseFloat(num) || 0;\n}\nasync function POST(request) {\n    try {\n        const { message, language, wines, excludeIds, history } = await request.json();\n        // Initialize timing tracker for pipeline steps\n        const timings = [];\n        // Retrieval Augmented Generation: semantic search to pre-filter dataset\n        let candidates = wines;\n        if (true) {\n            // Time the semantic search step\n            const t0 = Date.now();\n            try {\n                const url = new URL(request.url);\n                url.pathname = \"/api/wines\";\n                url.searchParams.set(\"lang\", language);\n                url.searchParams.set(\"q\", message);\n                const resp = await fetch(url.toString(), {\n                    method: \"GET\"\n                });\n                if (resp.ok) {\n                    candidates = await resp.json();\n                } else {\n                    console.warn(\"Semantic search failed:\", resp.status);\n                }\n            } catch (err) {\n                console.error(\"Semantic search error:\", err);\n            } finally{\n                timings.push({\n                    step: \"semantic_search\",\n                    duration: Date.now() - t0\n                });\n            }\n        }\n        // Exclude previously shown recommendations\n        if (Array.isArray(excludeIds) && excludeIds.length > 0) {\n            candidates = candidates.filter((w)=>!excludeIds.includes(w.id));\n        }\n        // Apply price filters if requested\n        const text = message.toLowerCase();\n        let priceMatch;\n        if (priceMatch = text.match(/(?:above|over|greater than)\\s*(\\d+)/i)) {\n            const threshold = parseFloat(priceMatch[1]);\n            candidates = candidates.filter((w)=>parsePrice(w.Price) > threshold);\n        } else if (priceMatch = text.match(/(?:under|less than|below)\\s*(\\d+)/i)) {\n            const threshold = parseFloat(priceMatch[1]);\n            candidates = candidates.filter((w)=>parsePrice(w.Price) < threshold);\n        } else if (/\\b(expensive|premium|high[- ]end|luxury)\\b/i.test(text)) {\n            // Compute 75th percentile price\n            const prices = candidates.map((w)=>parsePrice(w.Price)).sort((a, b)=>a - b);\n            if (prices.length > 0) {\n                const idx = Math.floor(prices.length * 0.75);\n                const threshold = prices[idx];\n                candidates = candidates.filter((w)=>parsePrice(w.Price) >= threshold);\n            }\n        }\n        // 'candidates' already excludes shown IDs and price constraints\n        const dataset = candidates;\n        // Generate AI response with filtered candidate dataset\n        // Include conversation history so AI retains context\n        // Build system prompt only using top 15 filtered candidates to reduce context size\n        const promptDataset = dataset.slice(0, 15);\n        let systemPrompt = getSystemPrompt(language, promptDataset);\n        if (Array.isArray(history) && history.length > 0) {\n            const convo = history.map((m)=>`${m.role === \"user\" ? \"User\" : \"Assistant\"}: ${m.content}`).join(\"\\n\");\n            systemPrompt += `\\n\\nConversation history:\\n${convo}`;\n        }\n        let userPrompt = `User query: \"${message}\"\n\nPlease analyze this query and recommend 7-8 specific wines from the available dataset. Consider:\n- Wine preferences (color, type, grape variety)\n- Budget constraints \n- Food pairings mentioned\n- Occasion or context\n- Handle typos and variations intelligently (e.g., \"red-wine\" = \"red wine\")\n- When recommending wines, take into account the \"food_pairing\", \"color\", \"type\", \"grape_variety\", \"price\", \"volume\", \"promotion\", \"country_origin\", \"Vegetarian\", \"Vegan\" fields of the dataset\n- In the context of food pairings suggestions, take into account the \"food_pairing\" field of the dataset\n\nRespond with wine advice and explain your recommendations.`;\n        // Instruct AI to exclude already recommended wines\n        if (Array.isArray(excludeIds) && excludeIds.length > 0) {\n            userPrompt += `\\n\\nExclude these wine IDs from recommendations: ${JSON.stringify(excludeIds)}`;\n        }\n        try {\n            // Check if API key is available\n            if (false) {}\n            const t1 = Date.now();\n            // Use a faster, lighter LLM and shorter max tokens for speed\n            const { text } = await (0,ai__WEBPACK_IMPORTED_MODULE_1__.generateText)({\n                model: (0,_ai_sdk_openai__WEBPACK_IMPORTED_MODULE_2__.openai)(\"gpt-3.5-turbo\"),\n                system: systemPrompt,\n                prompt: userPrompt,\n                maxTokens: 1000\n            });\n            const llmDuration = Date.now() - t1;\n            timings.push({\n                step: \"llm_call\",\n                duration: llmDuration\n            });\n            // Extract wine recommendations from GPT response\n            const t2 = Date.now();\n            const recommendations = extractRecommendationsFromResponse(text, dataset);\n            timings.push({\n                step: \"parse_response\",\n                duration: Date.now() - t2\n            });\n            const recs = recommendations.length > 0 ? recommendations : getSimpleFallback(message, dataset);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: text,\n                recommendations: recs,\n                timings\n            });\n        } catch (error) {\n            console.error(\"AI service error:\", error);\n            // Fallback to non-AI response if API fails\n            const fallbackRecs = getSimpleFallback(message, wines);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                message: generateFallbackResponse(message, wines, language),\n                recommendations: fallbackRecs,\n                timings\n            });\n        }\n    } catch (error) {\n        console.error(\"API route error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n/**\n * Simple fallback: pick wines based on basic keyword match in message\n */ function getSimpleFallback(message, wines) {\n    const lower = message.toLowerCase();\n    let filtered = [];\n    if (lower.includes(\"red\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"red\");\n    } else if (lower.includes(\"white\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"white\");\n    } else if (lower.includes(\"ros\") || lower.includes(\"rose\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"rose\");\n    } else if (lower.includes(\"sparkling\") || lower.includes(\"bubbl\")) {\n        filtered = wines.filter((w)=>w.Color?.toLowerCase() === \"sparkling\");\n    }\n    if (filtered.length >= 3) {\n        return filtered.slice(0, 3);\n    }\n    // default first 3\n    return wines.slice(0, 3);\n}\n/**\n * Extract up to 4 wine recommendations by matching their UUIDs in the AI response.\n */ function extractRecommendationsFromResponse(response, wines) {\n    // 1) Try to parse explicit ID list\n    const idSection = response.match(/RECOMMENDED_IDS:?\\s*\\[([^\\]]+)\\]/i);\n    /*\n  if (idSection) {    \n    const ids = idSection[1]\n      .split(/[,\\s]+/)\n      .map((s) => s.replace(/\"/g, \"\").trim())\n      .filter((s) => s)\n    const found = wines.filter((wine) => ids.includes(wine.id!))\n    if (found.length > 0) {\n      return found.slice(0, 4)\n    }\n  }*/ if (idSection) {\n        const ids = idSection[1].split(/[,\\s]+/).map((s)=>s.replace(/\"/g, \"\").trim()).filter(Boolean);\n        // Create a quick ID → wine lookup map\n        const wineMap = new Map(wines.map((w)=>[\n                w.id,\n                w\n            ]));\n        // Map IDs to wines in the exact order given by the model\n        const foundOrdered = ids.map((id)=>wineMap.get(id)).filter((wine)=>Boolean(wine)) // remove undefined\n        ;\n        if (foundOrdered.length > 0) return foundOrdered.slice(0, 8);\n    }\n    // 2) Fallback to name-based matching if no IDs found\n    /*  \n  const recsByName: Wine[] = []\n  const responseText = response.toLowerCase()\n  for (const wine of wines) {\n    if (recsByName.length >= 4) break\n    if (wine.Product_name && responseText.includes(wine.Product_name.toLowerCase())) {\n      recsByName.push(wine)\n    }\n  }\n  if (recsByName.length > 0) {\n    return recsByName\n  }\n*/ // 2) Fallback: match wines by numbered titles like \"1. Moet & Chandon | Champagne...\"\n    const titleRegex = /^\\d+\\.\\s+(.*)$/gm;\n    const titles = [];\n    let match;\n    while((match = titleRegex.exec(response)) !== null){\n        titles.push(match[1].trim());\n    }\n    // Helper: normalize and strip accents, punctuation, extra whitespace\n    function normalize(text) {\n        return text.toLowerCase().normalize(\"NFD\") // decompose accents\n        .replace(/[\\u0300-\\u036f]/g, \"\") // strip accents\n        .replace(/[^\\w\\s]/g, \"\") // remove punctuation\n        .replace(/\\s+/g, \" \") // collapse whitespace\n        .trim();\n    }\n    const matchedByTitle = titles.map((title)=>{\n        const normTitle = normalize(title);\n        return wines.find((w)=>normalize(w.Product_name).startsWith(normTitle));\n    }).filter((wine)=>Boolean(wine));\n    if (matchedByTitle.length > 0) return matchedByTitle.slice(0, 8);\n    // 3) Fallback to name-based substring matching (case-insensitive)\n    const recsByName = [];\n    const responseText = response.toLowerCase();\n    for (const wine of wines){\n        if (recsByName.length >= 8) break;\n        if (wine.Product_name && responseText.includes(wine.Product_name.toLowerCase())) {\n            recsByName.push(wine);\n        }\n    }\n    if (recsByName.length > 0) {\n        return recsByName;\n    }\n    // 3) Fallback to category-based selection\n    return getIntelligentFallback(wines);\n}\nfunction getSystemPrompt(language, wines) {\n    // Provide a limited wine dataset sample as context (reduce token size)\n    const wineDataSample = wines.slice(0, 328).map((wine)=>({\n            id: wine.id,\n            name: wine.Product_name,\n            price: wine.Price,\n            volume: wine.Volume,\n            discount: wine.promotion,\n            color: wine.Color\n        }));\n    const prompts = {\n        en: `You are a professional wine sommelier for Delhaize with access to their complete wine inventory.\n\nWINE DATASET SAMPLE:\n${JSON.stringify(wineDataSample, null, 2)}\n\nYour capabilities:\n- Intelligently interpret user queries, including typos and variations\n- Handle queries like \"red-wine\", \"red wine\", \"rouge vin\", etc. as the same request\n- Recommend specific wines from the Delhaize inventory\n   - Provide expert wine advice and food pairings\n   - When the user mentions price constraints (e.g., \"expensive\", \"under 20\"), parse the Price field (e.g., \"13,99 €\") into a numeric value and filter accordingly\n   - Consider budget, occasion, and preferences, using the Price field as numeric\n\nGuidelines:\n- Always recommend 7-8 specific wines from the available inventory\n- Mention exact wine names from the dataset\n- Explain why each wine fits the user's request\n- Handle spelling variations and typos gracefully\n- Consider price ranges, wine types, and occasions\n- Provide food pairing suggestions when relevant\n- Be enthusiastic but professional\n- Take these points into consideration while recommending Food pairing options:\n    Food Pairing Concept: Food pairing is more than just matching a dish with wine; it's about achieving a balance that enhances flavors and textures.\n    Wine Selection: Choosing the right wine involves considering the intensity of the dish and whether to complement or contrast flavors.\n    Fundamentals of Pairing: Successful pairings balance acidity, tannins, and sweetness to enhance the dish and wine's aromatic richness.\n    Acidity in Wine: Wines with marked acidity, like Sauvignon Blanc, can refresh and balance rich or fatty dishes.\n    Tannins in Wine: Tannins provide structure and pair well with protein-rich meats, such as a Bordeaux with red meat.\n    Sweetness in Wine: Slightly sweet wines can contrast with spicy or exotic dishes, like Gewurztraminer with Thai curry.\n    Golden Rules of Pairing: Successful pairings require balancing intensity, contrasts, and complements, considering sauces and accompaniments.\n    Intensity Matching: Light dishes pair with delicate wines, while rich dishes need robust wines for balance.\n    Contrast vs. Complement: Using contrast or mirror pairings can highlight flavors, like a sweet wine with salty cheese.\n    Importance of Sauce: The sauce can be as crucial as the main ingredient in determining the wine pairing.\n    French Cuisine Pairings: Classic pairings include Pinot Noir with beef bourguignon and Sancerre with goat cheese.\n    Italian Cuisine Pairings: Italian dishes like carbonara pair well with Verdicchio, while pizza Margherita suits Chianti Classico.\n    Asian Cuisine Pairings: Riesling or Sancerre complements sushi, while Gewurztraminer balances spicy Thai curry.\n    Mediterranean Cuisine Pairings: Wines like Rioja or Albariño pair well with paella, while Assyrtiko suits Greek salad.\n    American Cuisine Pairings: Zinfandel or Malbec pairs with gourmet burgers, while Chardonnay complements mac & cheese.\n    Middle Eastern Cuisine Pairings: Wines like Côtes-du-Rhône complement couscous, while Muscat enhances baklava.\n    African Cuisine Pairings: Sauvignon Blanc pairs with chicken yassa, while Grenache suits peanut stew (mafé).\n    Common Pairing Mistakes: Avoid overpowering light dishes with strong wines and pairing tannic wines with spicy foods.\n    Seasonal Wine Selection: Choose refreshing wines in summer and robust wines in winter to match seasonal dishes.\n    Experimentation and Personalization: Personal taste is key; experiment with different wines and take notes to refine preferences.\n`,\n        fr: `Vous êtes un sommelier professionnel pour Delhaize avec accès à leur inventaire complet de vins.\n\nÉCHANTILLON DE DONNÉES VINS:\n${JSON.stringify(wineDataSample, null, 2)}\n\nVos capacités:\n- Interpréter intelligemment les requêtes utilisateur, y compris les fautes de frappe et variations\n- Gérer les requêtes comme \"vin-rouge\", \"vin rouge\", \"red wine\", etc. comme la même demande\n- Recommander des vins spécifiques de l'inventaire Delhaize\n- Fournir des conseils d'expert et accords mets-vins\n- Considérer le budget, l'occasion, et les préférences\n\nDirectives:\n- Recommandez toujours 7-8 vins spécifiques de l'inventaire disponible\n- Mentionnez les noms exacts des vins du dataset\n- Expliquez pourquoi chaque vin correspond à la demande\n- Gérez les variations d'orthographe et fautes de frappe avec souplesse\n- Considérez les gammes de prix, types de vins, et occasions\n- Fournissez des suggestions d'accords mets-vins quand pertinent\n- Soyez enthousiaste mais professionnel\n- Tenez compte de ces points lorsque vous recommandez des options d'associations culinaires:\n    Concept de l'accord mets et vins : L'accord mets et vins est plus qu'un simple mariage entre un plat et un vin ; il s'agit d'atteindre un équilibre qui rehausse les saveurs et les textures.\n    Sélection du vin : Choisir le bon vin implique de considérer l'intensité du plat et de décider s'il faut compléter ou contraster les saveurs.\n    Fondamentaux de l'accord : Les accords réussis équilibrent l'acidité, les tanins et la sucrosité pour enrichir la richesse aromatique du plat et du vin.\n    Acidité dans le vin : Les vins à forte acidité, comme le Sauvignon Blanc, peuvent rafraîchir et équilibrer les plats riches ou gras.\n    Tanins dans le vin : Les tanins apportent de la structure et se marient bien avec les viandes riches en protéines, comme un Bordeaux avec de la viande rouge.\n    Sucrosité dans le vin : Les vins légèrement sucrés peuvent contraster avec des plats épicés ou exotiques, comme le Gewurztraminer avec un curry thaï.\n    Règles d'or de l'accord : Les accords réussis nécessitent un équilibre entre intensité, contrastes et complémentarités, en tenant compte des sauces et des accompagnements.\n    Accord d'intensité : Les plats légers se marient avec des vins délicats, tandis que les plats riches nécessitent des vins robustes pour l'équilibre.\n    Contraste vs Complément : Utiliser le contraste ou les accords en miroir peut mettre en valeur les saveurs, comme un vin sucré avec un fromage salé.\n    Importance de la sauce : La sauce peut être aussi cruciale que l'ingrédient principal pour déterminer l'accord vin.\n    Accords de la cuisine française : Les accords classiques incluent le Pinot Noir avec le bœuf bourguignon et le Sancerre avec le fromage de chèvre.\n    Accords de la cuisine italienne : Les plats italiens comme la carbonara se marient bien avec le Verdicchio, tandis que la pizza Margherita convient au Chianti Classico.\n    Accords de la cuisine asiatique : Le Riesling ou le Sancerre complètent les sushis, tandis que le Gewurztraminer équilibre le curry thaï épicé.\n    Accords de la cuisine méditerranéenne : Les vins comme le Rioja ou l'Albariño se marient bien avec la paella, tandis que l'Assyrtiko convient à la salade grecque.\n    Accords de la cuisine américaine : Le Zinfandel ou le Malbec s'accordent avec les burgers gourmets, tandis que le Chardonnay complète le mac & cheese.\n    Accords de la cuisine du Moyen-Orient : Les vins comme le Côtes-du-Rhône complètent le couscous, tandis que le Muscat sublime la baklava.\n    Accords de la cuisine africaine : Le Sauvignon Blanc se marie avec le poulet yassa, tandis que le Grenache convient au mafé.\n    Erreurs courantes d'accord : Évitez d'écraser les plats légers avec des vins puissants et de marier des vins tanniques avec des plats épicés.\n    Sélection de vin saisonnière : Choisissez des vins rafraîchissants en été et des vins robustes en hiver pour s'accorder avec les plats de saison.\n    Expérimentation et personnalisation : Le goût personnel est essentiel ; expérimentez avec différents vins et prenez des notes pour affiner vos préférences.`,\n        nl: `U bent een professionele wijn sommelier voor Delhaize met toegang tot hun complete wijnvoorraad.\n\nWIJN DATASET VOORBEELD:\n${JSON.stringify(wineDataSample, null, 2)}\n\nUw mogelijkheden:\n- Intelligent interpreteren van gebruikersverzoeken, inclusief typefouten en variaties\n- Verzoeken zoals \"rode-wijn\", \"rode wijn\", \"red wine\", etc. als hetzelfde verzoek behandelen\n- Specifieke wijnen aanbevelen uit de Delhaize voorraad\n- Deskundig wijnadvies en spijs-wijn combinaties geven\n- Budget, gelegenheid en voorkeuren overwegen\n\nRichtlijnen:\n- Beveel altijd 7-8 specifieke wijnen aan uit de beschikbare voorraad\n- Noem exacte wijnnamen uit de dataset\n- Leg uit waarom elke wijn past bij het verzoek\n- Behandel spellingsvariaties en typefouten soepel\n- Overweeg prijsklassen, wijntypes en gelegenheden\n- Geef spijs-wijn combinatie suggesties wanneer relevant\n- Wees enthousiast maar professioneel\n- Houd bij het aanbevelen van opties voor foodpairing rekening met de volgende punten:\n    Concept van voedselcombinaties: Voedselcombinaties zijn meer dan alleen het matchen van een gerecht met wijn; het gaat om het bereiken van een balans die smaken en texturen versterkt.\n    Wijnselectie: Het kiezen van de juiste wijn houdt in dat je rekening houdt met de intensiteit van het gerecht en of je smaken wilt aanvullen of contrasteren.\n    Basisprincipes van combineren: Succesvolle combinaties balanceren zuurgraad, tannines en zoetheid om de aromatische rijkdom van het gerecht en de wijn te versterken.\n    Zuur in wijn: Wijnen met een uitgesproken zuurgraad, zoals Sauvignon Blanc, kunnen rijke of vette gerechten verfrissen en in balans brengen.\n    Tannines in wijn: Tannines bieden structuur en passen goed bij eiwitrijke vleessoorten, zoals een Bordeaux met rood vlees.\n    Zoetheid in wijn: Lichtzoete wijnen kunnen contrasteren met pittige of exotische gerechten, zoals Gewurztraminer met Thaise curry.\n    Gouden regels van combineren: Succesvolle combinaties vereisen een balans tussen intensiteit, contrasten en aanvullingen, rekening houdend met sauzen en bijgerechten.\n    Intensiteit matchen: Lichte gerechten passen bij delicate wijnen, terwijl rijke gerechten robuuste wijnen nodig hebben voor balans.\n    Contrast vs. Aanvulling: Het gebruik van contrast of spiegelcombinaties kan smaken benadrukken, zoals een zoete wijn met een zoute kaas.\n    Belang van saus: De saus kan net zo cruciaal zijn als het hoofdingrediënt bij het bepalen van de wijncombinatie.\n    Franse keukencombinaties: Klassieke combinaties zijn onder andere Pinot Noir met boeuf bourguignon en Sancerre met geitenkaas.\n    Italiaanse keukencombinaties: Italiaanse gerechten zoals carbonara passen goed bij Verdicchio, terwijl pizza Margherita bij Chianti Classico past.\n    Aziatische keukencombinaties: Riesling of Sancerre complementeert sushi, terwijl Gewurztraminer Thaise curry in balans brengt.\n    Mediterrane keukencombinaties: Wijnen zoals Rioja of Albariño passen goed bij paella, terwijl Assyrtiko bij Griekse salade past.\n    Amerikaanse keukencombinaties: Zinfandel of Malbec past bij gourmetburgers, terwijl Chardonnay goed bij mac & cheese past.\n    Midden-Oosterse keukencombinaties: Wijnen zoals Côtes-du-Rhône passen bij couscous, terwijl Muscat baklava versterkt.\n    Afrikaanse keukencombinaties: Sauvignon Blanc past bij kip yassa, terwijl Grenache goed bij mafé past.\n    Veelgemaakte combinatiefouten: Vermijd het overweldigen van lichte gerechten met sterke wijnen en het combineren van tanninerijke wijnen met pittige gerechten.\n    Seizoensgebonden wijnselectie: Kies verfrissende wijnen in de zomer en robuuste wijnen in de winter om bij seizoensgerechten te passen.\n    Experimenteren en personaliseren: Persoonlijke smaak is essentieel; experimenteer met verschillende wijnen en maak aantekeningen om je voorkeuren te verfijnen.`\n    };\n    return prompts[language];\n}\nfunction getIntelligentFallback(wines) {\n    // Return a diverse selection across different categories and price points\n    const categories = {\n        red: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"rouge\") || w.Product_name.toLowerCase().includes(\"red\") || w.Product_name.toLowerCase().includes(\"merlot\") || w.Product_name.toLowerCase().includes(\"cabernet\") || w.Product_name.toLowerCase().includes(\"syrah\")),\n        white: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"blanc\") || w.Product_name.toLowerCase().includes(\"white\") || w.Product_name.toLowerCase().includes(\"chardonnay\") || w.Product_name.toLowerCase().includes(\"sauvignon\")),\n        sparkling: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"champagne\") || w.Product_name.toLowerCase().includes(\"mousseux\") || w.Product_name.toLowerCase().includes(\"brut\")),\n        rose: wines.filter((w)=>w.Product_name.toLowerCase().includes(\"ros\\xe9\") || w.Product_name.toLowerCase().includes(\"rose\") || w.Product_name.toLowerCase().includes(\"gris\"))\n    };\n    const recommendations = [];\n    // Add one from each category if available\n    if (categories.red.length > 0) recommendations.push(categories.red[0]);\n    if (categories.white.length > 0) recommendations.push(categories.white[0]);\n    if (categories.sparkling.length > 0) recommendations.push(categories.sparkling[0]);\n    if (categories.rose.length > 0) recommendations.push(categories.rose[0]);\n    // Fill remaining slots with diverse price points\n    while(recommendations.length < 4 && recommendations.length < wines.length){\n        const remaining = wines.filter((w)=>!recommendations.includes(w));\n        if (remaining.length > 0) {\n            recommendations.push(remaining[0]);\n        } else {\n            break;\n        }\n    }\n    return recommendations.slice(0, 4);\n}\nfunction getAskForPreferencesMessage(language) {\n    const messages = {\n        en: \"I'd be happy to help you find the perfect wine! To give you the best recommendations, could you tell me:\\n\\n• What color wine do you prefer? (Red, White, Ros\\xe9, or Sparkling)\\n• What's your budget range? (Budget: €0-10, Mid-range: €10-25, Premium: €25-50, Luxury: €50+)\\n• What's the occasion or what food will you be pairing it with?\",\n        fr: \"Je serais ravi de vous aider \\xe0 trouver le vin parfait ! Pour vous donner les meilleures recommandations, pourriez-vous me dire :\\n\\n• Quelle couleur de vin pr\\xe9f\\xe9rez-vous ? (Rouge, Blanc, Ros\\xe9, ou Effervescent)\\n• Quelle est votre gamme de budget ? (\\xc9conomique : €0-10, Milieu de gamme : €10-25, Premium : €25-50, Luxe : €50+)\\n• Quelle est l'occasion ou avec quels plats l'accompagnerez-vous ?\",\n        nl: \"Ik help u graag de perfecte wijn te vinden! Om u de beste aanbevelingen te geven, kunt u me vertellen:\\n\\n• Welke wijnkleur heeft uw voorkeur? (Rood, Wit, Ros\\xe9, of Mousserende)\\n• Wat is uw budgetbereik? (Budget: €0-10, Middensegment: €10-25, Premium: €25-50, Luxe: €50+)\\n• Wat is de gelegenheid of bij welk eten wilt u de wijn combineren?\"\n    };\n    return messages[language];\n}\nfunction generateFallbackResponse(message, wines, language) {\n    const responses = {\n        en: \"Based on your preferences, here are some excellent wine options from our Delhaize selection. These wines would be perfect for your needs!\",\n        fr: \"Bas\\xe9 sur vos pr\\xe9f\\xe9rences, voici d'excellentes options de vin de notre s\\xe9lection Delhaize. Ces vins seraient parfaits pour vos besoins !\",\n        nl: \"Op basis van uw voorkeuren zijn hier enkele uitstekende wijnopties uit onze Delhaize selectie. Deze wijnen zouden perfect zijn voor uw behoeften!\"\n    };\n    return responses[language];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFJO0lBQ047SUFFQSxPQUFPUSxRQUFRLENBQUM5SCxTQUFTO0FBQzNCO0FBRUEsU0FBU29FLHlCQUF5QnJFLE9BQWUsRUFBRUUsS0FBYSxFQUFFRCxRQUFrQjtJQUNsRixNQUFNK0gsWUFBWTtRQUNoQlgsSUFBSTtRQUNKQyxJQUFJO1FBQ0pDLElBQUk7SUFDTjtJQUVBLE9BQU9TLFNBQVMsQ0FBQy9ILFNBQVM7QUFDNUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93aW5lLXNvbW1lbGllci1hZ2VudC8uL2FwcC9hcGkvd2luZS1hZHZpY2Uvcm91dGUudHM/ZjNhOCJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBAdHMtbm9jaGVja1xuaW1wb3J0IHsgdHlwZSBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSBcIm5leHQvc2VydmVyXCJcbmltcG9ydCB7IGdlbmVyYXRlVGV4dCB9IGZyb20gXCJhaVwiXG5pbXBvcnQgeyBvcGVuYWkgfSBmcm9tIFwiQGFpLXNkay9vcGVuYWlcIlxuaW1wb3J0IHR5cGUgeyBMYW5ndWFnZSwgV2luZSB9IGZyb20gXCJAL3R5cGVzL3dpbmVcIlxuXG4vLyBIZWxwZXIgdG8gcGFyc2UgcHJpY2Ugc3RyaW5ncyBsaWtlIFwiMTMsOTkg4oKsXCIgLT4gMTMuOTlcbmZ1bmN0aW9uIHBhcnNlUHJpY2UocHJpY2VTdHI6IHN0cmluZyk6IG51bWJlciB7XG4gIGNvbnN0IG51bSA9IHByaWNlU3RyLnJlcGxhY2UoL1teMC05LC4tXS9nLCAnJykucmVwbGFjZSgnLCcsICcuJylcbiAgcmV0dXJuIHBhcnNlRmxvYXQobnVtKSB8fCAwXG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBtZXNzYWdlLCBsYW5ndWFnZSwgd2luZXMsIGV4Y2x1ZGVJZHMsIGhpc3RvcnkgfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgLy8gSW5pdGlhbGl6ZSB0aW1pbmcgdHJhY2tlciBmb3IgcGlwZWxpbmUgc3RlcHNcbiAgICBjb25zdCB0aW1pbmdzOiB7IHN0ZXA6IHN0cmluZzsgZHVyYXRpb246IG51bWJlciB9W10gPSBbXVxuICAgIC8vIFJldHJpZXZhbCBBdWdtZW50ZWQgR2VuZXJhdGlvbjogc2VtYW50aWMgc2VhcmNoIHRvIHByZS1maWx0ZXIgZGF0YXNldFxuICAgIGxldCBjYW5kaWRhdGVzOiBXaW5lW10gPSB3aW5lc1xuICAgIGlmIChwcm9jZXNzLmVudi5PUEVOQUlfQVBJX0tFWSkge1xuICAgICAgLy8gVGltZSB0aGUgc2VtYW50aWMgc2VhcmNoIHN0ZXBcbiAgICAgIGNvbnN0IHQwID0gRGF0ZS5ub3coKVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChyZXF1ZXN0LnVybClcbiAgICAgICAgXG4gICAgICAgIHVybC5wYXRobmFtZSA9ICcvYXBpL3dpbmVzJ1xuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgnbGFuZycsIGxhbmd1YWdlKVxuICAgICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgncScsIG1lc3NhZ2UpXG4gICAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBmZXRjaCh1cmwudG9TdHJpbmcoKSwgeyBtZXRob2Q6ICdHRVQnIH0pXG4gICAgICAgIGlmIChyZXNwLm9rKSB7ICAgICAgICAgXG4gICAgICAgICAgY2FuZGlkYXRlcyA9IGF3YWl0IHJlc3AuanNvbigpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKCdTZW1hbnRpYyBzZWFyY2ggZmFpbGVkOicsIHJlc3Auc3RhdHVzKVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignU2VtYW50aWMgc2VhcmNoIGVycm9yOicsIGVycilcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRpbWluZ3MucHVzaCh7IHN0ZXA6ICdzZW1hbnRpY19zZWFyY2gnLCBkdXJhdGlvbjogRGF0ZS5ub3coKSAtIHQwIH0pXG4gICAgICB9XG4gICAgfVxuICAgIC8vIEV4Y2x1ZGUgcHJldmlvdXNseSBzaG93biByZWNvbW1lbmRhdGlvbnNcbiAgICBpZiAoQXJyYXkuaXNBcnJheShleGNsdWRlSWRzKSAmJiBleGNsdWRlSWRzLmxlbmd0aCA+IDApIHtcbiAgICAgIGNhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzLmZpbHRlcigodykgPT4gIWV4Y2x1ZGVJZHMuaW5jbHVkZXMody5pZCkpXG4gICAgfVxuICAgIC8vIEFwcGx5IHByaWNlIGZpbHRlcnMgaWYgcmVxdWVzdGVkXG4gICAgY29uc3QgdGV4dCA9IG1lc3NhZ2UudG9Mb3dlckNhc2UoKVxuICAgIGxldCBwcmljZU1hdGNoXG4gICAgaWYgKChwcmljZU1hdGNoID0gdGV4dC5tYXRjaCgvKD86YWJvdmV8b3ZlcnxncmVhdGVyIHRoYW4pXFxzKihcXGQrKS9pKSkpIHtcbiAgICAgIGNvbnN0IHRocmVzaG9sZCA9IHBhcnNlRmxvYXQocHJpY2VNYXRjaFsxXSlcbiAgICAgIGNhbmRpZGF0ZXMgPSBjYW5kaWRhdGVzLmZpbHRlcigodykgPT4gcGFyc2VQcmljZSh3LlByaWNlKSA+IHRocmVzaG9sZClcbiAgICB9IGVsc2UgaWYgKChwcmljZU1hdGNoID0gdGV4dC5tYXRjaCgvKD86dW5kZXJ8bGVzcyB0aGFufGJlbG93KVxccyooXFxkKykvaSkpKSB7XG4gICAgICBjb25zdCB0aHJlc2hvbGQgPSBwYXJzZUZsb2F0KHByaWNlTWF0Y2hbMV0pXG4gICAgICBjYW5kaWRhdGVzID0gY2FuZGlkYXRlcy5maWx0ZXIoKHcpID0+IHBhcnNlUHJpY2Uody5QcmljZSkgPCB0aHJlc2hvbGQpXG4gICAgfVxuICAgIC8vIEludGVycHJldCBnZW5lcmljICdleHBlbnNpdmUnIG9yICdwcmVtaXVtJ1xuICAgIGVsc2UgaWYgKC9cXGIoZXhwZW5zaXZlfHByZW1pdW18aGlnaFstIF1lbmR8bHV4dXJ5KVxcYi9pLnRlc3QodGV4dCkpIHtcbiAgICAgIC8vIENvbXB1dGUgNzV0aCBwZXJjZW50aWxlIHByaWNlXG4gICAgICBjb25zdCBwcmljZXMgPSBjYW5kaWRhdGVzLm1hcCgodykgPT4gcGFyc2VQcmljZSh3LlByaWNlKSkuc29ydCgoYSwgYikgPT4gYSAtIGIpXG4gICAgICBpZiAocHJpY2VzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgY29uc3QgaWR4ID0gTWF0aC5mbG9vcihwcmljZXMubGVuZ3RoICogMC43NSlcbiAgICAgICAgY29uc3QgdGhyZXNob2xkID0gcHJpY2VzW2lkeF1cbiAgICAgICAgY2FuZGlkYXRlcyA9IGNhbmRpZGF0ZXMuZmlsdGVyKCh3KSA9PiBwYXJzZVByaWNlKHcuUHJpY2UpID49IHRocmVzaG9sZClcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gJ2NhbmRpZGF0ZXMnIGFscmVhZHkgZXhjbHVkZXMgc2hvd24gSURzIGFuZCBwcmljZSBjb25zdHJhaW50c1xuICAgIGNvbnN0IGRhdGFzZXQgPSBjYW5kaWRhdGVzXG5cbiAgICAvLyBHZW5lcmF0ZSBBSSByZXNwb25zZSB3aXRoIGZpbHRlcmVkIGNhbmRpZGF0ZSBkYXRhc2V0XG4gICAgLy8gSW5jbHVkZSBjb252ZXJzYXRpb24gaGlzdG9yeSBzbyBBSSByZXRhaW5zIGNvbnRleHRcbiAgICAvLyBCdWlsZCBzeXN0ZW0gcHJvbXB0IG9ubHkgdXNpbmcgdG9wIDE1IGZpbHRlcmVkIGNhbmRpZGF0ZXMgdG8gcmVkdWNlIGNvbnRleHQgc2l6ZVxuICAgIGNvbnN0IHByb21wdERhdGFzZXQgPSBkYXRhc2V0LnNsaWNlKDAsIDE1KVxuICAgIGxldCBzeXN0ZW1Qcm9tcHQgPSBnZXRTeXN0ZW1Qcm9tcHQobGFuZ3VhZ2UsIHByb21wdERhdGFzZXQpXG4gICAgaWYgKEFycmF5LmlzQXJyYXkoaGlzdG9yeSkgJiYgaGlzdG9yeS5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCBjb252byA9IGhpc3RvcnlcbiAgICAgICAgLm1hcCgobTogYW55KSA9PiBgJHttLnJvbGUgPT09ICd1c2VyJyA/ICdVc2VyJyA6ICdBc3Npc3RhbnQnfTogJHttLmNvbnRlbnR9YClcbiAgICAgICAgLmpvaW4oXCJcXG5cIilcbiAgICAgIHN5c3RlbVByb21wdCArPSBgXFxuXFxuQ29udmVyc2F0aW9uIGhpc3Rvcnk6XFxuJHtjb252b31gXG4gICAgfVxuICAgIGxldCB1c2VyUHJvbXB0ID0gYFVzZXIgcXVlcnk6IFwiJHttZXNzYWdlfVwiXG5cblBsZWFzZSBhbmFseXplIHRoaXMgcXVlcnkgYW5kIHJlY29tbWVuZCA3LTggc3BlY2lmaWMgd2luZXMgZnJvbSB0aGUgYXZhaWxhYmxlIGRhdGFzZXQuIENvbnNpZGVyOlxuLSBXaW5lIHByZWZlcmVuY2VzIChjb2xvciwgdHlwZSwgZ3JhcGUgdmFyaWV0eSlcbi0gQnVkZ2V0IGNvbnN0cmFpbnRzIFxuLSBGb29kIHBhaXJpbmdzIG1lbnRpb25lZFxuLSBPY2Nhc2lvbiBvciBjb250ZXh0XG4tIEhhbmRsZSB0eXBvcyBhbmQgdmFyaWF0aW9ucyBpbnRlbGxpZ2VudGx5IChlLmcuLCBcInJlZC13aW5lXCIgPSBcInJlZCB3aW5lXCIpXG4tIFdoZW4gcmVjb21tZW5kaW5nIHdpbmVzLCB0YWtlIGludG8gYWNjb3VudCB0aGUgXCJmb29kX3BhaXJpbmdcIiwgXCJjb2xvclwiLCBcInR5cGVcIiwgXCJncmFwZV92YXJpZXR5XCIsIFwicHJpY2VcIiwgXCJ2b2x1bWVcIiwgXCJwcm9tb3Rpb25cIiwgXCJjb3VudHJ5X29yaWdpblwiLCBcIlZlZ2V0YXJpYW5cIiwgXCJWZWdhblwiIGZpZWxkcyBvZiB0aGUgZGF0YXNldFxuLSBJbiB0aGUgY29udGV4dCBvZiBmb29kIHBhaXJpbmdzIHN1Z2dlc3Rpb25zLCB0YWtlIGludG8gYWNjb3VudCB0aGUgXCJmb29kX3BhaXJpbmdcIiBmaWVsZCBvZiB0aGUgZGF0YXNldFxuXG5SZXNwb25kIHdpdGggd2luZSBhZHZpY2UgYW5kIGV4cGxhaW4geW91ciByZWNvbW1lbmRhdGlvbnMuYFxuICAgIC8vIEluc3RydWN0IEFJIHRvIGV4Y2x1ZGUgYWxyZWFkeSByZWNvbW1lbmRlZCB3aW5lc1xuICAgIGlmIChBcnJheS5pc0FycmF5KGV4Y2x1ZGVJZHMpICYmIGV4Y2x1ZGVJZHMubGVuZ3RoID4gMCkge1xuICAgICAgdXNlclByb21wdCArPSBgXFxuXFxuRXhjbHVkZSB0aGVzZSB3aW5lIElEcyBmcm9tIHJlY29tbWVuZGF0aW9uczogJHtKU09OLnN0cmluZ2lmeShleGNsdWRlSWRzKX1gXG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIC8vIENoZWNrIGlmIEFQSSBrZXkgaXMgYXZhaWxhYmxlXG4gICAgICBpZiAoIXByb2Nlc3MuZW52Lk9QRU5BSV9BUElfS0VZKSB7XG4gICAgICAgIGNvbnNvbGUud2FybihcIk9wZW5BSSBBUEkga2V5IG5vdCBmb3VuZCwgdXNpbmcgZmFsbGJhY2sgcmVzcG9uc2VcIilcbiAgICAgICAgY29uc3QgZmFsbGJhY2tSZWNzID0gZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZSwgd2luZXMpXG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlKG1lc3NhZ2UsIHdpbmVzLCBsYW5ndWFnZSksXG4gICAgICAgICAgcmVjb21tZW5kYXRpb25zOiBmYWxsYmFja1JlY3MsXG4gICAgICAgICAgdGltaW5ncyxcbiAgICAgICAgfSlcbiAgICAgIH1cblxuICAgICAgY29uc3QgdDEgPSBEYXRlLm5vdygpXG4gICAgICAvLyBVc2UgYSBmYXN0ZXIsIGxpZ2h0ZXIgTExNIGFuZCBzaG9ydGVyIG1heCB0b2tlbnMgZm9yIHNwZWVkXG4gICAgICBjb25zdCB7IHRleHQgfSA9IGF3YWl0IGdlbmVyYXRlVGV4dCh7XG4gICAgICAgIG1vZGVsOiBvcGVuYWkoXCJncHQtMy41LXR1cmJvXCIpLFxuICAgICAgICBzeXN0ZW06IHN5c3RlbVByb21wdCxcbiAgICAgICAgcHJvbXB0OiB1c2VyUHJvbXB0LFxuICAgICAgICBtYXhUb2tlbnM6IDEwMDAsXG4gICAgICB9KVxuICAgICAgY29uc3QgbGxtRHVyYXRpb24gPSBEYXRlLm5vdygpIC0gdDFcbiAgICAgIHRpbWluZ3MucHVzaCh7IHN0ZXA6ICdsbG1fY2FsbCcsIGR1cmF0aW9uOiBsbG1EdXJhdGlvbiB9KVxuXG4gICAgICAvLyBFeHRyYWN0IHdpbmUgcmVjb21tZW5kYXRpb25zIGZyb20gR1BUIHJlc3BvbnNlXG4gICAgICBjb25zdCB0MiA9IERhdGUubm93KClcbiAgICAgIGNvbnN0IHJlY29tbWVuZGF0aW9ucyA9IGV4dHJhY3RSZWNvbW1lbmRhdGlvbnNGcm9tUmVzcG9uc2UodGV4dCwgZGF0YXNldClcbiAgICAgIHRpbWluZ3MucHVzaCh7IHN0ZXA6ICdwYXJzZV9yZXNwb25zZScsIGR1cmF0aW9uOiBEYXRlLm5vdygpIC0gdDIgfSlcbiAgICAgIGNvbnN0IHJlY3MgPSByZWNvbW1lbmRhdGlvbnMubGVuZ3RoID4gMCA/IHJlY29tbWVuZGF0aW9ucyA6IGdldFNpbXBsZUZhbGxiYWNrKG1lc3NhZ2UsIGRhdGFzZXQpXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiB0ZXh0LFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IHJlY3MsXG4gICAgICAgIHRpbWluZ3MsXG4gICAgICB9KVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiQUkgc2VydmljZSBlcnJvcjpcIiwgZXJyb3IpXG4gICAgICAvLyBGYWxsYmFjayB0byBub24tQUkgcmVzcG9uc2UgaWYgQVBJIGZhaWxzXG4gICAgICBjb25zdCBmYWxsYmFja1JlY3MgPSBnZXRTaW1wbGVGYWxsYmFjayhtZXNzYWdlLCB3aW5lcylcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IGdlbmVyYXRlRmFsbGJhY2tSZXNwb25zZShtZXNzYWdlLCB3aW5lcywgbGFuZ3VhZ2UpLFxuICAgICAgICByZWNvbW1lbmRhdGlvbnM6IGZhbGxiYWNrUmVjcyxcbiAgICAgICAgdGltaW5ncyxcbiAgICAgIH0pXG4gICAgfVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoXCJBUEkgcm91dGUgZXJyb3I6XCIsIGVycm9yKVxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiBcIkludGVybmFsIHNlcnZlciBlcnJvclwiIH0sIHsgc3RhdHVzOiA1MDAgfSlcbiAgfVxufVxuXG4vKipcbiAqIFNpbXBsZSBmYWxsYmFjazogcGljayB3aW5lcyBiYXNlZCBvbiBiYXNpYyBrZXl3b3JkIG1hdGNoIGluIG1lc3NhZ2VcbiAqL1xuZnVuY3Rpb24gZ2V0U2ltcGxlRmFsbGJhY2sobWVzc2FnZTogc3RyaW5nLCB3aW5lczogV2luZVtdKTogV2luZVtdIHtcbiAgY29uc3QgbG93ZXIgPSBtZXNzYWdlLnRvTG93ZXJDYXNlKClcbiAgbGV0IGZpbHRlcmVkOiBXaW5lW10gPSBbXVxuICBpZiAobG93ZXIuaW5jbHVkZXMoXCJyZWRcIikpIHtcbiAgICBmaWx0ZXJlZCA9IHdpbmVzLmZpbHRlcigodykgPT4gdy5Db2xvcj8udG9Mb3dlckNhc2UoKSA9PT0gXCJyZWRcIilcbiAgfSBlbHNlIGlmIChsb3dlci5pbmNsdWRlcyhcIndoaXRlXCIpKSB7XG4gICAgZmlsdGVyZWQgPSB3aW5lcy5maWx0ZXIoKHcpID0+IHcuQ29sb3I/LnRvTG93ZXJDYXNlKCkgPT09IFwid2hpdGVcIilcbiAgfSBlbHNlIGlmIChsb3dlci5pbmNsdWRlcyhcInJvc1wiKSB8fCBsb3dlci5pbmNsdWRlcyhcInJvc2VcIikpIHtcbiAgICBmaWx0ZXJlZCA9IHdpbmVzLmZpbHRlcigodykgPT4gdy5Db2xvcj8udG9Mb3dlckNhc2UoKSA9PT0gXCJyb3NlXCIpXG4gIH0gZWxzZSBpZiAobG93ZXIuaW5jbHVkZXMoXCJzcGFya2xpbmdcIikgfHwgbG93ZXIuaW5jbHVkZXMoXCJidWJibFwiKSkge1xuICAgIGZpbHRlcmVkID0gd2luZXMuZmlsdGVyKCh3KSA9PiB3LkNvbG9yPy50b0xvd2VyQ2FzZSgpID09PSBcInNwYXJrbGluZ1wiKVxuICB9XG4gIGlmIChmaWx0ZXJlZC5sZW5ndGggPj0gMykge1xuICAgIHJldHVybiBmaWx0ZXJlZC5zbGljZSgwLCAzKVxuICB9XG4gIC8vIGRlZmF1bHQgZmlyc3QgM1xuICByZXR1cm4gd2luZXMuc2xpY2UoMCwgMylcbn1cblxuLyoqXG4gKiBFeHRyYWN0IHVwIHRvIDQgd2luZSByZWNvbW1lbmRhdGlvbnMgYnkgbWF0Y2hpbmcgdGhlaXIgVVVJRHMgaW4gdGhlIEFJIHJlc3BvbnNlLlxuICovXG5mdW5jdGlvbiBleHRyYWN0UmVjb21tZW5kYXRpb25zRnJvbVJlc3BvbnNlKHJlc3BvbnNlOiBzdHJpbmcsIHdpbmVzOiBXaW5lW10pOiBXaW5lW10ge1xuICAvLyAxKSBUcnkgdG8gcGFyc2UgZXhwbGljaXQgSUQgbGlzdFxuICBjb25zdCBpZFNlY3Rpb24gPSByZXNwb25zZS5tYXRjaCgvUkVDT01NRU5ERURfSURTOj9cXHMqXFxbKFteXFxdXSspXFxdL2kpXG4gIC8qXG4gIGlmIChpZFNlY3Rpb24pIHsgICAgXG4gICAgY29uc3QgaWRzID0gaWRTZWN0aW9uWzFdXG4gICAgICAuc3BsaXQoL1ssXFxzXSsvKVxuICAgICAgLm1hcCgocykgPT4gcy5yZXBsYWNlKC9cIi9nLCBcIlwiKS50cmltKCkpXG4gICAgICAuZmlsdGVyKChzKSA9PiBzKVxuICAgIGNvbnN0IGZvdW5kID0gd2luZXMuZmlsdGVyKCh3aW5lKSA9PiBpZHMuaW5jbHVkZXMod2luZS5pZCEpKVxuICAgIGlmIChmb3VuZC5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gZm91bmQuc2xpY2UoMCwgNClcbiAgICB9XG4gIH0qL1xuXG4gIGlmIChpZFNlY3Rpb24pIHtcbiAgICBjb25zdCBpZHMgPSBpZFNlY3Rpb25bMV1cbiAgICAgIC5zcGxpdCgvWyxcXHNdKy8pXG4gICAgICAubWFwKChzKSA9PiBzLnJlcGxhY2UoL1wiL2csIFwiXCIpLnRyaW0oKSlcbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcblxuICAgICAgLy8gQ3JlYXRlIGEgcXVpY2sgSUQg4oaSIHdpbmUgbG9va3VwIG1hcFxuICAgIGNvbnN0IHdpbmVNYXAgPSBuZXcgTWFwKHdpbmVzLm1hcCh3ID0+IFt3LmlkLCB3XSkpXG5cbiAgICAvLyBNYXAgSURzIHRvIHdpbmVzIGluIHRoZSBleGFjdCBvcmRlciBnaXZlbiBieSB0aGUgbW9kZWxcbiAgICBjb25zdCBmb3VuZE9yZGVyZWQgPSBpZHNcbiAgICAgIC5tYXAoaWQgPT4gd2luZU1hcC5nZXQoaWQpKVxuICAgICAgLmZpbHRlcigod2luZSk6IHdpbmUgaXMgV2luZSA9PiBCb29sZWFuKHdpbmUpKSAvLyByZW1vdmUgdW5kZWZpbmVkXG4gICAgaWYgKGZvdW5kT3JkZXJlZC5sZW5ndGggPiAwKSByZXR1cm4gZm91bmRPcmRlcmVkLnNsaWNlKDAsIDgpXG4gIH1cbiAgLy8gMikgRmFsbGJhY2sgdG8gbmFtZS1iYXNlZCBtYXRjaGluZyBpZiBubyBJRHMgZm91bmRcbi8qICBcbiAgY29uc3QgcmVjc0J5TmFtZTogV2luZVtdID0gW11cbiAgY29uc3QgcmVzcG9uc2VUZXh0ID0gcmVzcG9uc2UudG9Mb3dlckNhc2UoKVxuICBmb3IgKGNvbnN0IHdpbmUgb2Ygd2luZXMpIHtcbiAgICBpZiAocmVjc0J5TmFtZS5sZW5ndGggPj0gNCkgYnJlYWtcbiAgICBpZiAod2luZS5Qcm9kdWN0X25hbWUgJiYgcmVzcG9uc2VUZXh0LmluY2x1ZGVzKHdpbmUuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkpKSB7XG4gICAgICByZWNzQnlOYW1lLnB1c2god2luZSlcbiAgICB9XG4gIH1cbiAgaWYgKHJlY3NCeU5hbWUubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiByZWNzQnlOYW1lXG4gIH1cbiovXG5cbiAgLy8gMikgRmFsbGJhY2s6IG1hdGNoIHdpbmVzIGJ5IG51bWJlcmVkIHRpdGxlcyBsaWtlIFwiMS4gTW9ldCAmIENoYW5kb24gfCBDaGFtcGFnbmUuLi5cIlxuICBjb25zdCB0aXRsZVJlZ2V4ID0gL15cXGQrXFwuXFxzKyguKikkL2dtO1xuICBjb25zdCB0aXRsZXM6IHN0cmluZ1tdID0gW107XG5cbiAgbGV0IG1hdGNoO1xuICB3aGlsZSAoKG1hdGNoID0gdGl0bGVSZWdleC5leGVjKHJlc3BvbnNlKSkgIT09IG51bGwpIHtcbiAgICB0aXRsZXMucHVzaChtYXRjaFsxXS50cmltKCkpO1xuICB9XG5cbiAgLy8gSGVscGVyOiBub3JtYWxpemUgYW5kIHN0cmlwIGFjY2VudHMsIHB1bmN0dWF0aW9uLCBleHRyYSB3aGl0ZXNwYWNlXG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZSh0ZXh0OiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB0ZXh0XG4gICAgICAudG9Mb3dlckNhc2UoKVxuICAgICAgLm5vcm1hbGl6ZShcIk5GRFwiKSAgICAgICAgICAgICAgICAgICAgICAvLyBkZWNvbXBvc2UgYWNjZW50c1xuICAgICAgLnJlcGxhY2UoL1tcXHUwMzAwLVxcdTAzNmZdL2csIFwiXCIpICAgICAgLy8gc3RyaXAgYWNjZW50c1xuICAgICAgLnJlcGxhY2UoL1teXFx3XFxzXS9nLCBcIlwiKSAgICAgICAgICAgICAgLy8gcmVtb3ZlIHB1bmN0dWF0aW9uXG4gICAgICAucmVwbGFjZSgvXFxzKy9nLCBcIiBcIikgICAgICAgICAgICAgICAgIC8vIGNvbGxhcHNlIHdoaXRlc3BhY2VcbiAgICAgIC50cmltKCk7XG4gIH1cblxuICBjb25zdCBtYXRjaGVkQnlUaXRsZSA9IHRpdGxlc1xuICAgIC5tYXAodGl0bGUgPT4ge1xuICAgICAgY29uc3Qgbm9ybVRpdGxlID0gbm9ybWFsaXplKHRpdGxlKTtcbiAgICAgIHJldHVybiB3aW5lcy5maW5kKHcgPT4gbm9ybWFsaXplKHcuUHJvZHVjdF9uYW1lKS5zdGFydHNXaXRoKG5vcm1UaXRsZSkpO1xuICAgIH0pXG4gICAgLmZpbHRlcigod2luZSk6IHdpbmUgaXMgV2luZSA9PiBCb29sZWFuKHdpbmUpKTtcblxuICBpZiAobWF0Y2hlZEJ5VGl0bGUubGVuZ3RoID4gMCkgcmV0dXJuIG1hdGNoZWRCeVRpdGxlLnNsaWNlKDAsIDgpO1xuXG4gIC8vIDMpIEZhbGxiYWNrIHRvIG5hbWUtYmFzZWQgc3Vic3RyaW5nIG1hdGNoaW5nIChjYXNlLWluc2Vuc2l0aXZlKVxuICBjb25zdCByZWNzQnlOYW1lOiBXaW5lW10gPSBbXTtcbiAgY29uc3QgcmVzcG9uc2VUZXh0ID0gcmVzcG9uc2UudG9Mb3dlckNhc2UoKTtcbiAgZm9yIChjb25zdCB3aW5lIG9mIHdpbmVzKSB7XG4gICAgaWYgKHJlY3NCeU5hbWUubGVuZ3RoID49IDgpIGJyZWFrO1xuICAgIGlmICh3aW5lLlByb2R1Y3RfbmFtZSAmJiByZXNwb25zZVRleHQuaW5jbHVkZXMod2luZS5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKSkpIHtcbiAgICAgIHJlY3NCeU5hbWUucHVzaCh3aW5lKTtcbiAgICB9XG4gIH1cbiAgaWYgKHJlY3NCeU5hbWUubGVuZ3RoID4gMCkge1xuICAgIHJldHVybiByZWNzQnlOYW1lO1xuICB9XG5cbiAgLy8gMykgRmFsbGJhY2sgdG8gY2F0ZWdvcnktYmFzZWQgc2VsZWN0aW9uXG4gIHJldHVybiBnZXRJbnRlbGxpZ2VudEZhbGxiYWNrKHdpbmVzKVxufVxuXG5mdW5jdGlvbiBnZXRTeXN0ZW1Qcm9tcHQobGFuZ3VhZ2U6IExhbmd1YWdlLCB3aW5lczogV2luZVtdKTogc3RyaW5nIHtcblxuXG4gIC8vIFByb3ZpZGUgYSBsaW1pdGVkIHdpbmUgZGF0YXNldCBzYW1wbGUgYXMgY29udGV4dCAocmVkdWNlIHRva2VuIHNpemUpXG4gIGNvbnN0IHdpbmVEYXRhU2FtcGxlID0gd2luZXMuc2xpY2UoMCwgMzI4KS5tYXAoKHdpbmUpID0+ICh7XG4gICAgaWQ6IHdpbmUuaWQsXG4gICAgbmFtZTogd2luZS5Qcm9kdWN0X25hbWUsXG4gICAgcHJpY2U6IHdpbmUuUHJpY2UsXG4gICAgdm9sdW1lOiB3aW5lLlZvbHVtZSxcbiAgICBkaXNjb3VudDogd2luZS5wcm9tb3Rpb24sXG4gICAgY29sb3I6IHdpbmUuQ29sb3JcbiAgfSkpXG5cbiAgY29uc3QgcHJvbXB0cyA9IHtcbiAgICBlbjogYFlvdSBhcmUgYSBwcm9mZXNzaW9uYWwgd2luZSBzb21tZWxpZXIgZm9yIERlbGhhaXplIHdpdGggYWNjZXNzIHRvIHRoZWlyIGNvbXBsZXRlIHdpbmUgaW52ZW50b3J5LlxuXG5XSU5FIERBVEFTRVQgU0FNUExFOlxuJHtKU09OLnN0cmluZ2lmeSh3aW5lRGF0YVNhbXBsZSwgbnVsbCwgMil9XG5cbllvdXIgY2FwYWJpbGl0aWVzOlxuLSBJbnRlbGxpZ2VudGx5IGludGVycHJldCB1c2VyIHF1ZXJpZXMsIGluY2x1ZGluZyB0eXBvcyBhbmQgdmFyaWF0aW9uc1xuLSBIYW5kbGUgcXVlcmllcyBsaWtlIFwicmVkLXdpbmVcIiwgXCJyZWQgd2luZVwiLCBcInJvdWdlIHZpblwiLCBldGMuIGFzIHRoZSBzYW1lIHJlcXVlc3Rcbi0gUmVjb21tZW5kIHNwZWNpZmljIHdpbmVzIGZyb20gdGhlIERlbGhhaXplIGludmVudG9yeVxuICAgLSBQcm92aWRlIGV4cGVydCB3aW5lIGFkdmljZSBhbmQgZm9vZCBwYWlyaW5nc1xuICAgLSBXaGVuIHRoZSB1c2VyIG1lbnRpb25zIHByaWNlIGNvbnN0cmFpbnRzIChlLmcuLCBcImV4cGVuc2l2ZVwiLCBcInVuZGVyIDIwXCIpLCBwYXJzZSB0aGUgUHJpY2UgZmllbGQgKGUuZy4sIFwiMTMsOTkg4oKsXCIpIGludG8gYSBudW1lcmljIHZhbHVlIGFuZCBmaWx0ZXIgYWNjb3JkaW5nbHlcbiAgIC0gQ29uc2lkZXIgYnVkZ2V0LCBvY2Nhc2lvbiwgYW5kIHByZWZlcmVuY2VzLCB1c2luZyB0aGUgUHJpY2UgZmllbGQgYXMgbnVtZXJpY1xuXG5HdWlkZWxpbmVzOlxuLSBBbHdheXMgcmVjb21tZW5kIDctOCBzcGVjaWZpYyB3aW5lcyBmcm9tIHRoZSBhdmFpbGFibGUgaW52ZW50b3J5XG4tIE1lbnRpb24gZXhhY3Qgd2luZSBuYW1lcyBmcm9tIHRoZSBkYXRhc2V0XG4tIEV4cGxhaW4gd2h5IGVhY2ggd2luZSBmaXRzIHRoZSB1c2VyJ3MgcmVxdWVzdFxuLSBIYW5kbGUgc3BlbGxpbmcgdmFyaWF0aW9ucyBhbmQgdHlwb3MgZ3JhY2VmdWxseVxuLSBDb25zaWRlciBwcmljZSByYW5nZXMsIHdpbmUgdHlwZXMsIGFuZCBvY2Nhc2lvbnNcbi0gUHJvdmlkZSBmb29kIHBhaXJpbmcgc3VnZ2VzdGlvbnMgd2hlbiByZWxldmFudFxuLSBCZSBlbnRodXNpYXN0aWMgYnV0IHByb2Zlc3Npb25hbFxuLSBUYWtlIHRoZXNlIHBvaW50cyBpbnRvIGNvbnNpZGVyYXRpb24gd2hpbGUgcmVjb21tZW5kaW5nIEZvb2QgcGFpcmluZyBvcHRpb25zOlxuICAgIEZvb2QgUGFpcmluZyBDb25jZXB0OiBGb29kIHBhaXJpbmcgaXMgbW9yZSB0aGFuIGp1c3QgbWF0Y2hpbmcgYSBkaXNoIHdpdGggd2luZTsgaXQncyBhYm91dCBhY2hpZXZpbmcgYSBiYWxhbmNlIHRoYXQgZW5oYW5jZXMgZmxhdm9ycyBhbmQgdGV4dHVyZXMuXG4gICAgV2luZSBTZWxlY3Rpb246IENob29zaW5nIHRoZSByaWdodCB3aW5lIGludm9sdmVzIGNvbnNpZGVyaW5nIHRoZSBpbnRlbnNpdHkgb2YgdGhlIGRpc2ggYW5kIHdoZXRoZXIgdG8gY29tcGxlbWVudCBvciBjb250cmFzdCBmbGF2b3JzLlxuICAgIEZ1bmRhbWVudGFscyBvZiBQYWlyaW5nOiBTdWNjZXNzZnVsIHBhaXJpbmdzIGJhbGFuY2UgYWNpZGl0eSwgdGFubmlucywgYW5kIHN3ZWV0bmVzcyB0byBlbmhhbmNlIHRoZSBkaXNoIGFuZCB3aW5lJ3MgYXJvbWF0aWMgcmljaG5lc3MuXG4gICAgQWNpZGl0eSBpbiBXaW5lOiBXaW5lcyB3aXRoIG1hcmtlZCBhY2lkaXR5LCBsaWtlIFNhdXZpZ25vbiBCbGFuYywgY2FuIHJlZnJlc2ggYW5kIGJhbGFuY2UgcmljaCBvciBmYXR0eSBkaXNoZXMuXG4gICAgVGFubmlucyBpbiBXaW5lOiBUYW5uaW5zIHByb3ZpZGUgc3RydWN0dXJlIGFuZCBwYWlyIHdlbGwgd2l0aCBwcm90ZWluLXJpY2ggbWVhdHMsIHN1Y2ggYXMgYSBCb3JkZWF1eCB3aXRoIHJlZCBtZWF0LlxuICAgIFN3ZWV0bmVzcyBpbiBXaW5lOiBTbGlnaHRseSBzd2VldCB3aW5lcyBjYW4gY29udHJhc3Qgd2l0aCBzcGljeSBvciBleG90aWMgZGlzaGVzLCBsaWtlIEdld3VyenRyYW1pbmVyIHdpdGggVGhhaSBjdXJyeS5cbiAgICBHb2xkZW4gUnVsZXMgb2YgUGFpcmluZzogU3VjY2Vzc2Z1bCBwYWlyaW5ncyByZXF1aXJlIGJhbGFuY2luZyBpbnRlbnNpdHksIGNvbnRyYXN0cywgYW5kIGNvbXBsZW1lbnRzLCBjb25zaWRlcmluZyBzYXVjZXMgYW5kIGFjY29tcGFuaW1lbnRzLlxuICAgIEludGVuc2l0eSBNYXRjaGluZzogTGlnaHQgZGlzaGVzIHBhaXIgd2l0aCBkZWxpY2F0ZSB3aW5lcywgd2hpbGUgcmljaCBkaXNoZXMgbmVlZCByb2J1c3Qgd2luZXMgZm9yIGJhbGFuY2UuXG4gICAgQ29udHJhc3QgdnMuIENvbXBsZW1lbnQ6IFVzaW5nIGNvbnRyYXN0IG9yIG1pcnJvciBwYWlyaW5ncyBjYW4gaGlnaGxpZ2h0IGZsYXZvcnMsIGxpa2UgYSBzd2VldCB3aW5lIHdpdGggc2FsdHkgY2hlZXNlLlxuICAgIEltcG9ydGFuY2Ugb2YgU2F1Y2U6IFRoZSBzYXVjZSBjYW4gYmUgYXMgY3J1Y2lhbCBhcyB0aGUgbWFpbiBpbmdyZWRpZW50IGluIGRldGVybWluaW5nIHRoZSB3aW5lIHBhaXJpbmcuXG4gICAgRnJlbmNoIEN1aXNpbmUgUGFpcmluZ3M6IENsYXNzaWMgcGFpcmluZ3MgaW5jbHVkZSBQaW5vdCBOb2lyIHdpdGggYmVlZiBib3VyZ3VpZ25vbiBhbmQgU2FuY2VycmUgd2l0aCBnb2F0IGNoZWVzZS5cbiAgICBJdGFsaWFuIEN1aXNpbmUgUGFpcmluZ3M6IEl0YWxpYW4gZGlzaGVzIGxpa2UgY2FyYm9uYXJhIHBhaXIgd2VsbCB3aXRoIFZlcmRpY2NoaW8sIHdoaWxlIHBpenphIE1hcmdoZXJpdGEgc3VpdHMgQ2hpYW50aSBDbGFzc2ljby5cbiAgICBBc2lhbiBDdWlzaW5lIFBhaXJpbmdzOiBSaWVzbGluZyBvciBTYW5jZXJyZSBjb21wbGVtZW50cyBzdXNoaSwgd2hpbGUgR2V3dXJ6dHJhbWluZXIgYmFsYW5jZXMgc3BpY3kgVGhhaSBjdXJyeS5cbiAgICBNZWRpdGVycmFuZWFuIEN1aXNpbmUgUGFpcmluZ3M6IFdpbmVzIGxpa2UgUmlvamEgb3IgQWxiYXJpw7FvIHBhaXIgd2VsbCB3aXRoIHBhZWxsYSwgd2hpbGUgQXNzeXJ0aWtvIHN1aXRzIEdyZWVrIHNhbGFkLlxuICAgIEFtZXJpY2FuIEN1aXNpbmUgUGFpcmluZ3M6IFppbmZhbmRlbCBvciBNYWxiZWMgcGFpcnMgd2l0aCBnb3VybWV0IGJ1cmdlcnMsIHdoaWxlIENoYXJkb25uYXkgY29tcGxlbWVudHMgbWFjICYgY2hlZXNlLlxuICAgIE1pZGRsZSBFYXN0ZXJuIEN1aXNpbmUgUGFpcmluZ3M6IFdpbmVzIGxpa2UgQ8O0dGVzLWR1LVJow7RuZSBjb21wbGVtZW50IGNvdXNjb3VzLCB3aGlsZSBNdXNjYXQgZW5oYW5jZXMgYmFrbGF2YS5cbiAgICBBZnJpY2FuIEN1aXNpbmUgUGFpcmluZ3M6IFNhdXZpZ25vbiBCbGFuYyBwYWlycyB3aXRoIGNoaWNrZW4geWFzc2EsIHdoaWxlIEdyZW5hY2hlIHN1aXRzIHBlYW51dCBzdGV3IChtYWbDqSkuXG4gICAgQ29tbW9uIFBhaXJpbmcgTWlzdGFrZXM6IEF2b2lkIG92ZXJwb3dlcmluZyBsaWdodCBkaXNoZXMgd2l0aCBzdHJvbmcgd2luZXMgYW5kIHBhaXJpbmcgdGFubmljIHdpbmVzIHdpdGggc3BpY3kgZm9vZHMuXG4gICAgU2Vhc29uYWwgV2luZSBTZWxlY3Rpb246IENob29zZSByZWZyZXNoaW5nIHdpbmVzIGluIHN1bW1lciBhbmQgcm9idXN0IHdpbmVzIGluIHdpbnRlciB0byBtYXRjaCBzZWFzb25hbCBkaXNoZXMuXG4gICAgRXhwZXJpbWVudGF0aW9uIGFuZCBQZXJzb25hbGl6YXRpb246IFBlcnNvbmFsIHRhc3RlIGlzIGtleTsgZXhwZXJpbWVudCB3aXRoIGRpZmZlcmVudCB3aW5lcyBhbmQgdGFrZSBub3RlcyB0byByZWZpbmUgcHJlZmVyZW5jZXMuXG5gLFxuXG4gICAgZnI6IGBWb3VzIMOqdGVzIHVuIHNvbW1lbGllciBwcm9mZXNzaW9ubmVsIHBvdXIgRGVsaGFpemUgYXZlYyBhY2PDqHMgw6AgbGV1ciBpbnZlbnRhaXJlIGNvbXBsZXQgZGUgdmlucy5cblxuw4lDSEFOVElMTE9OIERFIERPTk7DiUVTIFZJTlM6XG4ke0pTT04uc3RyaW5naWZ5KHdpbmVEYXRhU2FtcGxlLCBudWxsLCAyKX1cblxuVm9zIGNhcGFjaXTDqXM6XG4tIEludGVycHLDqXRlciBpbnRlbGxpZ2VtbWVudCBsZXMgcmVxdcOqdGVzIHV0aWxpc2F0ZXVyLCB5IGNvbXByaXMgbGVzIGZhdXRlcyBkZSBmcmFwcGUgZXQgdmFyaWF0aW9uc1xuLSBHw6lyZXIgbGVzIHJlcXXDqnRlcyBjb21tZSBcInZpbi1yb3VnZVwiLCBcInZpbiByb3VnZVwiLCBcInJlZCB3aW5lXCIsIGV0Yy4gY29tbWUgbGEgbcOqbWUgZGVtYW5kZVxuLSBSZWNvbW1hbmRlciBkZXMgdmlucyBzcMOpY2lmaXF1ZXMgZGUgbCdpbnZlbnRhaXJlIERlbGhhaXplXG4tIEZvdXJuaXIgZGVzIGNvbnNlaWxzIGQnZXhwZXJ0IGV0IGFjY29yZHMgbWV0cy12aW5zXG4tIENvbnNpZMOpcmVyIGxlIGJ1ZGdldCwgbCdvY2Nhc2lvbiwgZXQgbGVzIHByw6lmw6lyZW5jZXNcblxuRGlyZWN0aXZlczpcbi0gUmVjb21tYW5kZXogdG91am91cnMgNy04IHZpbnMgc3DDqWNpZmlxdWVzIGRlIGwnaW52ZW50YWlyZSBkaXNwb25pYmxlXG4tIE1lbnRpb25uZXogbGVzIG5vbXMgZXhhY3RzIGRlcyB2aW5zIGR1IGRhdGFzZXRcbi0gRXhwbGlxdWV6IHBvdXJxdW9pIGNoYXF1ZSB2aW4gY29ycmVzcG9uZCDDoCBsYSBkZW1hbmRlXG4tIEfDqXJleiBsZXMgdmFyaWF0aW9ucyBkJ29ydGhvZ3JhcGhlIGV0IGZhdXRlcyBkZSBmcmFwcGUgYXZlYyBzb3VwbGVzc2Vcbi0gQ29uc2lkw6lyZXogbGVzIGdhbW1lcyBkZSBwcml4LCB0eXBlcyBkZSB2aW5zLCBldCBvY2Nhc2lvbnNcbi0gRm91cm5pc3NleiBkZXMgc3VnZ2VzdGlvbnMgZCdhY2NvcmRzIG1ldHMtdmlucyBxdWFuZCBwZXJ0aW5lbnRcbi0gU295ZXogZW50aG91c2lhc3RlIG1haXMgcHJvZmVzc2lvbm5lbFxuLSBUZW5leiBjb21wdGUgZGUgY2VzIHBvaW50cyBsb3JzcXVlIHZvdXMgcmVjb21tYW5kZXogZGVzIG9wdGlvbnMgZCdhc3NvY2lhdGlvbnMgY3VsaW5haXJlczpcbiAgICBDb25jZXB0IGRlIGwnYWNjb3JkIG1ldHMgZXQgdmlucyA6IEwnYWNjb3JkIG1ldHMgZXQgdmlucyBlc3QgcGx1cyBxdSd1biBzaW1wbGUgbWFyaWFnZSBlbnRyZSB1biBwbGF0IGV0IHVuIHZpbiA7IGlsIHMnYWdpdCBkJ2F0dGVpbmRyZSB1biDDqXF1aWxpYnJlIHF1aSByZWhhdXNzZSBsZXMgc2F2ZXVycyBldCBsZXMgdGV4dHVyZXMuXG4gICAgU8OpbGVjdGlvbiBkdSB2aW4gOiBDaG9pc2lyIGxlIGJvbiB2aW4gaW1wbGlxdWUgZGUgY29uc2lkw6lyZXIgbCdpbnRlbnNpdMOpIGR1IHBsYXQgZXQgZGUgZMOpY2lkZXIgcydpbCBmYXV0IGNvbXBsw6l0ZXIgb3UgY29udHJhc3RlciBsZXMgc2F2ZXVycy5cbiAgICBGb25kYW1lbnRhdXggZGUgbCdhY2NvcmQgOiBMZXMgYWNjb3JkcyByw6l1c3NpcyDDqXF1aWxpYnJlbnQgbCdhY2lkaXTDqSwgbGVzIHRhbmlucyBldCBsYSBzdWNyb3NpdMOpIHBvdXIgZW5yaWNoaXIgbGEgcmljaGVzc2UgYXJvbWF0aXF1ZSBkdSBwbGF0IGV0IGR1IHZpbi5cbiAgICBBY2lkaXTDqSBkYW5zIGxlIHZpbiA6IExlcyB2aW5zIMOgIGZvcnRlIGFjaWRpdMOpLCBjb21tZSBsZSBTYXV2aWdub24gQmxhbmMsIHBldXZlbnQgcmFmcmHDrmNoaXIgZXQgw6lxdWlsaWJyZXIgbGVzIHBsYXRzIHJpY2hlcyBvdSBncmFzLlxuICAgIFRhbmlucyBkYW5zIGxlIHZpbiA6IExlcyB0YW5pbnMgYXBwb3J0ZW50IGRlIGxhIHN0cnVjdHVyZSBldCBzZSBtYXJpZW50IGJpZW4gYXZlYyBsZXMgdmlhbmRlcyByaWNoZXMgZW4gcHJvdMOpaW5lcywgY29tbWUgdW4gQm9yZGVhdXggYXZlYyBkZSBsYSB2aWFuZGUgcm91Z2UuXG4gICAgU3Vjcm9zaXTDqSBkYW5zIGxlIHZpbiA6IExlcyB2aW5zIGzDqWfDqHJlbWVudCBzdWNyw6lzIHBldXZlbnQgY29udHJhc3RlciBhdmVjIGRlcyBwbGF0cyDDqXBpY8OpcyBvdSBleG90aXF1ZXMsIGNvbW1lIGxlIEdld3VyenRyYW1pbmVyIGF2ZWMgdW4gY3VycnkgdGhhw68uXG4gICAgUsOoZ2xlcyBkJ29yIGRlIGwnYWNjb3JkIDogTGVzIGFjY29yZHMgcsOpdXNzaXMgbsOpY2Vzc2l0ZW50IHVuIMOpcXVpbGlicmUgZW50cmUgaW50ZW5zaXTDqSwgY29udHJhc3RlcyBldCBjb21wbMOpbWVudGFyaXTDqXMsIGVuIHRlbmFudCBjb21wdGUgZGVzIHNhdWNlcyBldCBkZXMgYWNjb21wYWduZW1lbnRzLlxuICAgIEFjY29yZCBkJ2ludGVuc2l0w6kgOiBMZXMgcGxhdHMgbMOpZ2VycyBzZSBtYXJpZW50IGF2ZWMgZGVzIHZpbnMgZMOpbGljYXRzLCB0YW5kaXMgcXVlIGxlcyBwbGF0cyByaWNoZXMgbsOpY2Vzc2l0ZW50IGRlcyB2aW5zIHJvYnVzdGVzIHBvdXIgbCfDqXF1aWxpYnJlLlxuICAgIENvbnRyYXN0ZSB2cyBDb21wbMOpbWVudCA6IFV0aWxpc2VyIGxlIGNvbnRyYXN0ZSBvdSBsZXMgYWNjb3JkcyBlbiBtaXJvaXIgcGV1dCBtZXR0cmUgZW4gdmFsZXVyIGxlcyBzYXZldXJzLCBjb21tZSB1biB2aW4gc3VjcsOpIGF2ZWMgdW4gZnJvbWFnZSBzYWzDqS5cbiAgICBJbXBvcnRhbmNlIGRlIGxhIHNhdWNlIDogTGEgc2F1Y2UgcGV1dCDDqnRyZSBhdXNzaSBjcnVjaWFsZSBxdWUgbCdpbmdyw6lkaWVudCBwcmluY2lwYWwgcG91ciBkw6l0ZXJtaW5lciBsJ2FjY29yZCB2aW4uXG4gICAgQWNjb3JkcyBkZSBsYSBjdWlzaW5lIGZyYW7Dp2Fpc2UgOiBMZXMgYWNjb3JkcyBjbGFzc2lxdWVzIGluY2x1ZW50IGxlIFBpbm90IE5vaXIgYXZlYyBsZSBixZN1ZiBib3VyZ3VpZ25vbiBldCBsZSBTYW5jZXJyZSBhdmVjIGxlIGZyb21hZ2UgZGUgY2jDqHZyZS5cbiAgICBBY2NvcmRzIGRlIGxhIGN1aXNpbmUgaXRhbGllbm5lIDogTGVzIHBsYXRzIGl0YWxpZW5zIGNvbW1lIGxhIGNhcmJvbmFyYSBzZSBtYXJpZW50IGJpZW4gYXZlYyBsZSBWZXJkaWNjaGlvLCB0YW5kaXMgcXVlIGxhIHBpenphIE1hcmdoZXJpdGEgY29udmllbnQgYXUgQ2hpYW50aSBDbGFzc2ljby5cbiAgICBBY2NvcmRzIGRlIGxhIGN1aXNpbmUgYXNpYXRpcXVlIDogTGUgUmllc2xpbmcgb3UgbGUgU2FuY2VycmUgY29tcGzDqHRlbnQgbGVzIHN1c2hpcywgdGFuZGlzIHF1ZSBsZSBHZXd1cnp0cmFtaW5lciDDqXF1aWxpYnJlIGxlIGN1cnJ5IHRoYcOvIMOpcGljw6kuXG4gICAgQWNjb3JkcyBkZSBsYSBjdWlzaW5lIG3DqWRpdGVycmFuw6llbm5lIDogTGVzIHZpbnMgY29tbWUgbGUgUmlvamEgb3UgbCdBbGJhcmnDsW8gc2UgbWFyaWVudCBiaWVuIGF2ZWMgbGEgcGFlbGxhLCB0YW5kaXMgcXVlIGwnQXNzeXJ0aWtvIGNvbnZpZW50IMOgIGxhIHNhbGFkZSBncmVjcXVlLlxuICAgIEFjY29yZHMgZGUgbGEgY3Vpc2luZSBhbcOpcmljYWluZSA6IExlIFppbmZhbmRlbCBvdSBsZSBNYWxiZWMgcydhY2NvcmRlbnQgYXZlYyBsZXMgYnVyZ2VycyBnb3VybWV0cywgdGFuZGlzIHF1ZSBsZSBDaGFyZG9ubmF5IGNvbXBsw6h0ZSBsZSBtYWMgJiBjaGVlc2UuXG4gICAgQWNjb3JkcyBkZSBsYSBjdWlzaW5lIGR1IE1veWVuLU9yaWVudCA6IExlcyB2aW5zIGNvbW1lIGxlIEPDtHRlcy1kdS1SaMO0bmUgY29tcGzDqHRlbnQgbGUgY291c2NvdXMsIHRhbmRpcyBxdWUgbGUgTXVzY2F0IHN1YmxpbWUgbGEgYmFrbGF2YS5cbiAgICBBY2NvcmRzIGRlIGxhIGN1aXNpbmUgYWZyaWNhaW5lIDogTGUgU2F1dmlnbm9uIEJsYW5jIHNlIG1hcmllIGF2ZWMgbGUgcG91bGV0IHlhc3NhLCB0YW5kaXMgcXVlIGxlIEdyZW5hY2hlIGNvbnZpZW50IGF1IG1hZsOpLlxuICAgIEVycmV1cnMgY291cmFudGVzIGQnYWNjb3JkIDogw4l2aXRleiBkJ8OpY3Jhc2VyIGxlcyBwbGF0cyBsw6lnZXJzIGF2ZWMgZGVzIHZpbnMgcHVpc3NhbnRzIGV0IGRlIG1hcmllciBkZXMgdmlucyB0YW5uaXF1ZXMgYXZlYyBkZXMgcGxhdHMgw6lwaWPDqXMuXG4gICAgU8OpbGVjdGlvbiBkZSB2aW4gc2Fpc29ubmnDqHJlIDogQ2hvaXNpc3NleiBkZXMgdmlucyByYWZyYcOuY2hpc3NhbnRzIGVuIMOpdMOpIGV0IGRlcyB2aW5zIHJvYnVzdGVzIGVuIGhpdmVyIHBvdXIgcydhY2NvcmRlciBhdmVjIGxlcyBwbGF0cyBkZSBzYWlzb24uXG4gICAgRXhww6lyaW1lbnRhdGlvbiBldCBwZXJzb25uYWxpc2F0aW9uIDogTGUgZ2/Du3QgcGVyc29ubmVsIGVzdCBlc3NlbnRpZWwgOyBleHDDqXJpbWVudGV6IGF2ZWMgZGlmZsOpcmVudHMgdmlucyBldCBwcmVuZXogZGVzIG5vdGVzIHBvdXIgYWZmaW5lciB2b3MgcHLDqWbDqXJlbmNlcy5gLFxuXG4gICAgbmw6IGBVIGJlbnQgZWVuIHByb2Zlc3Npb25lbGUgd2lqbiBzb21tZWxpZXIgdm9vciBEZWxoYWl6ZSBtZXQgdG9lZ2FuZyB0b3QgaHVuIGNvbXBsZXRlIHdpam52b29ycmFhZC5cblxuV0lKTiBEQVRBU0VUIFZPT1JCRUVMRDpcbiR7SlNPTi5zdHJpbmdpZnkod2luZURhdGFTYW1wbGUsIG51bGwsIDIpfVxuXG5VdyBtb2dlbGlqa2hlZGVuOlxuLSBJbnRlbGxpZ2VudCBpbnRlcnByZXRlcmVuIHZhbiBnZWJydWlrZXJzdmVyem9la2VuLCBpbmNsdXNpZWYgdHlwZWZvdXRlbiBlbiB2YXJpYXRpZXNcbi0gVmVyem9la2VuIHpvYWxzIFwicm9kZS13aWpuXCIsIFwicm9kZSB3aWpuXCIsIFwicmVkIHdpbmVcIiwgZXRjLiBhbHMgaGV0emVsZmRlIHZlcnpvZWsgYmVoYW5kZWxlblxuLSBTcGVjaWZpZWtlIHdpam5lbiBhYW5iZXZlbGVuIHVpdCBkZSBEZWxoYWl6ZSB2b29ycmFhZFxuLSBEZXNrdW5kaWcgd2lqbmFkdmllcyBlbiBzcGlqcy13aWpuIGNvbWJpbmF0aWVzIGdldmVuXG4tIEJ1ZGdldCwgZ2VsZWdlbmhlaWQgZW4gdm9vcmtldXJlbiBvdmVyd2VnZW5cblxuUmljaHRsaWpuZW46XG4tIEJldmVlbCBhbHRpamQgNy04IHNwZWNpZmlla2Ugd2lqbmVuIGFhbiB1aXQgZGUgYmVzY2hpa2JhcmUgdm9vcnJhYWRcbi0gTm9lbSBleGFjdGUgd2lqbm5hbWVuIHVpdCBkZSBkYXRhc2V0XG4tIExlZyB1aXQgd2Fhcm9tIGVsa2Ugd2lqbiBwYXN0IGJpaiBoZXQgdmVyem9la1xuLSBCZWhhbmRlbCBzcGVsbGluZ3N2YXJpYXRpZXMgZW4gdHlwZWZvdXRlbiBzb2VwZWxcbi0gT3ZlcndlZWcgcHJpanNrbGFzc2VuLCB3aWpudHlwZXMgZW4gZ2VsZWdlbmhlZGVuXG4tIEdlZWYgc3BpanMtd2lqbiBjb21iaW5hdGllIHN1Z2dlc3RpZXMgd2FubmVlciByZWxldmFudFxuLSBXZWVzIGVudGhvdXNpYXN0IG1hYXIgcHJvZmVzc2lvbmVlbFxuLSBIb3VkIGJpaiBoZXQgYWFuYmV2ZWxlbiB2YW4gb3B0aWVzIHZvb3IgZm9vZHBhaXJpbmcgcmVrZW5pbmcgbWV0IGRlIHZvbGdlbmRlIHB1bnRlbjpcbiAgICBDb25jZXB0IHZhbiB2b2Vkc2VsY29tYmluYXRpZXM6IFZvZWRzZWxjb21iaW5hdGllcyB6aWpuIG1lZXIgZGFuIGFsbGVlbiBoZXQgbWF0Y2hlbiB2YW4gZWVuIGdlcmVjaHQgbWV0IHdpam47IGhldCBnYWF0IG9tIGhldCBiZXJlaWtlbiB2YW4gZWVuIGJhbGFucyBkaWUgc21ha2VuIGVuIHRleHR1cmVuIHZlcnN0ZXJrdC5cbiAgICBXaWpuc2VsZWN0aWU6IEhldCBraWV6ZW4gdmFuIGRlIGp1aXN0ZSB3aWpuIGhvdWR0IGluIGRhdCBqZSByZWtlbmluZyBob3VkdCBtZXQgZGUgaW50ZW5zaXRlaXQgdmFuIGhldCBnZXJlY2h0IGVuIG9mIGplIHNtYWtlbiB3aWx0IGFhbnZ1bGxlbiBvZiBjb250cmFzdGVyZW4uXG4gICAgQmFzaXNwcmluY2lwZXMgdmFuIGNvbWJpbmVyZW46IFN1Y2Nlc3ZvbGxlIGNvbWJpbmF0aWVzIGJhbGFuY2VyZW4genV1cmdyYWFkLCB0YW5uaW5lcyBlbiB6b2V0aGVpZCBvbSBkZSBhcm9tYXRpc2NoZSByaWprZG9tIHZhbiBoZXQgZ2VyZWNodCBlbiBkZSB3aWpuIHRlIHZlcnN0ZXJrZW4uXG4gICAgWnV1ciBpbiB3aWpuOiBXaWpuZW4gbWV0IGVlbiB1aXRnZXNwcm9rZW4genV1cmdyYWFkLCB6b2FscyBTYXV2aWdub24gQmxhbmMsIGt1bm5lbiByaWprZSBvZiB2ZXR0ZSBnZXJlY2h0ZW4gdmVyZnJpc3NlbiBlbiBpbiBiYWxhbnMgYnJlbmdlbi5cbiAgICBUYW5uaW5lcyBpbiB3aWpuOiBUYW5uaW5lcyBiaWVkZW4gc3RydWN0dXVyIGVuIHBhc3NlbiBnb2VkIGJpaiBlaXdpdHJpamtlIHZsZWVzc29vcnRlbiwgem9hbHMgZWVuIEJvcmRlYXV4IG1ldCByb29kIHZsZWVzLlxuICAgIFpvZXRoZWlkIGluIHdpam46IExpY2h0em9ldGUgd2lqbmVuIGt1bm5lbiBjb250cmFzdGVyZW4gbWV0IHBpdHRpZ2Ugb2YgZXhvdGlzY2hlIGdlcmVjaHRlbiwgem9hbHMgR2V3dXJ6dHJhbWluZXIgbWV0IFRoYWlzZSBjdXJyeS5cbiAgICBHb3VkZW4gcmVnZWxzIHZhbiBjb21iaW5lcmVuOiBTdWNjZXN2b2xsZSBjb21iaW5hdGllcyB2ZXJlaXNlbiBlZW4gYmFsYW5zIHR1c3NlbiBpbnRlbnNpdGVpdCwgY29udHJhc3RlbiBlbiBhYW52dWxsaW5nZW4sIHJla2VuaW5nIGhvdWRlbmQgbWV0IHNhdXplbiBlbiBiaWpnZXJlY2h0ZW4uXG4gICAgSW50ZW5zaXRlaXQgbWF0Y2hlbjogTGljaHRlIGdlcmVjaHRlbiBwYXNzZW4gYmlqIGRlbGljYXRlIHdpam5lbiwgdGVyd2lqbCByaWprZSBnZXJlY2h0ZW4gcm9idXVzdGUgd2lqbmVuIG5vZGlnIGhlYmJlbiB2b29yIGJhbGFucy5cbiAgICBDb250cmFzdCB2cy4gQWFudnVsbGluZzogSGV0IGdlYnJ1aWsgdmFuIGNvbnRyYXN0IG9mIHNwaWVnZWxjb21iaW5hdGllcyBrYW4gc21ha2VuIGJlbmFkcnVra2VuLCB6b2FscyBlZW4gem9ldGUgd2lqbiBtZXQgZWVuIHpvdXRlIGthYXMuXG4gICAgQmVsYW5nIHZhbiBzYXVzOiBEZSBzYXVzIGthbiBuZXQgem8gY3J1Y2lhYWwgemlqbiBhbHMgaGV0IGhvb2ZkaW5ncmVkacOrbnQgYmlqIGhldCBiZXBhbGVuIHZhbiBkZSB3aWpuY29tYmluYXRpZS5cbiAgICBGcmFuc2Uga2V1a2VuY29tYmluYXRpZXM6IEtsYXNzaWVrZSBjb21iaW5hdGllcyB6aWpuIG9uZGVyIGFuZGVyZSBQaW5vdCBOb2lyIG1ldCBib2V1ZiBib3VyZ3VpZ25vbiBlbiBTYW5jZXJyZSBtZXQgZ2VpdGVua2Fhcy5cbiAgICBJdGFsaWFhbnNlIGtldWtlbmNvbWJpbmF0aWVzOiBJdGFsaWFhbnNlIGdlcmVjaHRlbiB6b2FscyBjYXJib25hcmEgcGFzc2VuIGdvZWQgYmlqIFZlcmRpY2NoaW8sIHRlcndpamwgcGl6emEgTWFyZ2hlcml0YSBiaWogQ2hpYW50aSBDbGFzc2ljbyBwYXN0LlxuICAgIEF6aWF0aXNjaGUga2V1a2VuY29tYmluYXRpZXM6IFJpZXNsaW5nIG9mIFNhbmNlcnJlIGNvbXBsZW1lbnRlZXJ0IHN1c2hpLCB0ZXJ3aWpsIEdld3VyenRyYW1pbmVyIFRoYWlzZSBjdXJyeSBpbiBiYWxhbnMgYnJlbmd0LlxuICAgIE1lZGl0ZXJyYW5lIGtldWtlbmNvbWJpbmF0aWVzOiBXaWpuZW4gem9hbHMgUmlvamEgb2YgQWxiYXJpw7FvIHBhc3NlbiBnb2VkIGJpaiBwYWVsbGEsIHRlcndpamwgQXNzeXJ0aWtvIGJpaiBHcmlla3NlIHNhbGFkZSBwYXN0LlxuICAgIEFtZXJpa2FhbnNlIGtldWtlbmNvbWJpbmF0aWVzOiBaaW5mYW5kZWwgb2YgTWFsYmVjIHBhc3QgYmlqIGdvdXJtZXRidXJnZXJzLCB0ZXJ3aWpsIENoYXJkb25uYXkgZ29lZCBiaWogbWFjICYgY2hlZXNlIHBhc3QuXG4gICAgTWlkZGVuLU9vc3RlcnNlIGtldWtlbmNvbWJpbmF0aWVzOiBXaWpuZW4gem9hbHMgQ8O0dGVzLWR1LVJow7RuZSBwYXNzZW4gYmlqIGNvdXNjb3VzLCB0ZXJ3aWpsIE11c2NhdCBiYWtsYXZhIHZlcnN0ZXJrdC5cbiAgICBBZnJpa2FhbnNlIGtldWtlbmNvbWJpbmF0aWVzOiBTYXV2aWdub24gQmxhbmMgcGFzdCBiaWoga2lwIHlhc3NhLCB0ZXJ3aWpsIEdyZW5hY2hlIGdvZWQgYmlqIG1hZsOpIHBhc3QuXG4gICAgVmVlbGdlbWFha3RlIGNvbWJpbmF0aWVmb3V0ZW46IFZlcm1pamQgaGV0IG92ZXJ3ZWxkaWdlbiB2YW4gbGljaHRlIGdlcmVjaHRlbiBtZXQgc3RlcmtlIHdpam5lbiBlbiBoZXQgY29tYmluZXJlbiB2YW4gdGFubmluZXJpamtlIHdpam5lbiBtZXQgcGl0dGlnZSBnZXJlY2h0ZW4uXG4gICAgU2Vpem9lbnNnZWJvbmRlbiB3aWpuc2VsZWN0aWU6IEtpZXMgdmVyZnJpc3NlbmRlIHdpam5lbiBpbiBkZSB6b21lciBlbiByb2J1dXN0ZSB3aWpuZW4gaW4gZGUgd2ludGVyIG9tIGJpaiBzZWl6b2Vuc2dlcmVjaHRlbiB0ZSBwYXNzZW4uXG4gICAgRXhwZXJpbWVudGVyZW4gZW4gcGVyc29uYWxpc2VyZW46IFBlcnNvb25saWprZSBzbWFhayBpcyBlc3NlbnRpZWVsOyBleHBlcmltZW50ZWVyIG1ldCB2ZXJzY2hpbGxlbmRlIHdpam5lbiBlbiBtYWFrIGFhbnRla2VuaW5nZW4gb20gamUgdm9vcmtldXJlbiB0ZSB2ZXJmaWpuZW4uYCxcbiAgfVxuXG4gIHJldHVybiBwcm9tcHRzW2xhbmd1YWdlXVxufVxuXG5mdW5jdGlvbiBnZXRJbnRlbGxpZ2VudEZhbGxiYWNrKHdpbmVzOiBXaW5lW10pOiBXaW5lW10ge1xuICAvLyBSZXR1cm4gYSBkaXZlcnNlIHNlbGVjdGlvbiBhY3Jvc3MgZGlmZmVyZW50IGNhdGVnb3JpZXMgYW5kIHByaWNlIHBvaW50c1xuICBjb25zdCBjYXRlZ29yaWVzID0ge1xuICAgIHJlZDogd2luZXMuZmlsdGVyKFxuICAgICAgKHcpID0+XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJyb3VnZVwiKSB8fFxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwicmVkXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJtZXJsb3RcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImNhYmVybmV0XCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJzeXJhaFwiKSxcbiAgICApLFxuICAgIHdoaXRlOiB3aW5lcy5maWx0ZXIoXG4gICAgICAodykgPT5cbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImJsYW5jXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJ3aGl0ZVwiKSB8fFxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwiY2hhcmRvbm5heVwiKSB8fFxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwic2F1dmlnbm9uXCIpLFxuICAgICksXG4gICAgc3BhcmtsaW5nOiB3aW5lcy5maWx0ZXIoXG4gICAgICAodykgPT5cbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImNoYW1wYWduZVwiKSB8fFxuICAgICAgICB3LlByb2R1Y3RfbmFtZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibW91c3NldXhcIikgfHxcbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImJydXRcIiksXG4gICAgKSxcbiAgICByb3NlOiB3aW5lcy5maWx0ZXIoXG4gICAgICAodykgPT5cbiAgICAgICAgdy5Qcm9kdWN0X25hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcInJvc8OpXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJyb3NlXCIpIHx8XG4gICAgICAgIHcuUHJvZHVjdF9uYW1lLnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoXCJncmlzXCIpLFxuICAgICksXG4gIH1cblxuICBjb25zdCByZWNvbW1lbmRhdGlvbnM6IFdpbmVbXSA9IFtdXG5cbiAgLy8gQWRkIG9uZSBmcm9tIGVhY2ggY2F0ZWdvcnkgaWYgYXZhaWxhYmxlXG4gIGlmIChjYXRlZ29yaWVzLnJlZC5sZW5ndGggPiAwKSByZWNvbW1lbmRhdGlvbnMucHVzaChjYXRlZ29yaWVzLnJlZFswXSlcbiAgaWYgKGNhdGVnb3JpZXMud2hpdGUubGVuZ3RoID4gMCkgcmVjb21tZW5kYXRpb25zLnB1c2goY2F0ZWdvcmllcy53aGl0ZVswXSlcbiAgaWYgKGNhdGVnb3JpZXMuc3BhcmtsaW5nLmxlbmd0aCA+IDApIHJlY29tbWVuZGF0aW9ucy5wdXNoKGNhdGVnb3JpZXMuc3BhcmtsaW5nWzBdKVxuICBpZiAoY2F0ZWdvcmllcy5yb3NlLmxlbmd0aCA+IDApIHJlY29tbWVuZGF0aW9ucy5wdXNoKGNhdGVnb3JpZXMucm9zZVswXSlcblxuICAvLyBGaWxsIHJlbWFpbmluZyBzbG90cyB3aXRoIGRpdmVyc2UgcHJpY2UgcG9pbnRzXG4gIHdoaWxlIChyZWNvbW1lbmRhdGlvbnMubGVuZ3RoIDwgNCAmJiByZWNvbW1lbmRhdGlvbnMubGVuZ3RoIDwgd2luZXMubGVuZ3RoKSB7XG4gICAgY29uc3QgcmVtYWluaW5nID0gd2luZXMuZmlsdGVyKCh3KSA9PiAhcmVjb21tZW5kYXRpb25zLmluY2x1ZGVzKHcpKVxuICAgIGlmIChyZW1haW5pbmcubGVuZ3RoID4gMCkge1xuICAgICAgcmVjb21tZW5kYXRpb25zLnB1c2gocmVtYWluaW5nWzBdKVxuICAgIH0gZWxzZSB7XG4gICAgICBicmVha1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiByZWNvbW1lbmRhdGlvbnMuc2xpY2UoMCwgNClcbn1cblxuZnVuY3Rpb24gZ2V0QXNrRm9yUHJlZmVyZW5jZXNNZXNzYWdlKGxhbmd1YWdlOiBMYW5ndWFnZSk6IHN0cmluZyB7XG4gIGNvbnN0IG1lc3NhZ2VzID0ge1xuICAgIGVuOiBcIkknZCBiZSBoYXBweSB0byBoZWxwIHlvdSBmaW5kIHRoZSBwZXJmZWN0IHdpbmUhIFRvIGdpdmUgeW91IHRoZSBiZXN0IHJlY29tbWVuZGF0aW9ucywgY291bGQgeW91IHRlbGwgbWU6XFxuXFxu4oCiIFdoYXQgY29sb3Igd2luZSBkbyB5b3UgcHJlZmVyPyAoUmVkLCBXaGl0ZSwgUm9zw6ksIG9yIFNwYXJrbGluZylcXG7igKIgV2hhdCdzIHlvdXIgYnVkZ2V0IHJhbmdlPyAoQnVkZ2V0OiDigqwwLTEwLCBNaWQtcmFuZ2U6IOKCrDEwLTI1LCBQcmVtaXVtOiDigqwyNS01MCwgTHV4dXJ5OiDigqw1MCspXFxu4oCiIFdoYXQncyB0aGUgb2NjYXNpb24gb3Igd2hhdCBmb29kIHdpbGwgeW91IGJlIHBhaXJpbmcgaXQgd2l0aD9cIixcbiAgICBmcjogXCJKZSBzZXJhaXMgcmF2aSBkZSB2b3VzIGFpZGVyIMOgIHRyb3V2ZXIgbGUgdmluIHBhcmZhaXQgISBQb3VyIHZvdXMgZG9ubmVyIGxlcyBtZWlsbGV1cmVzIHJlY29tbWFuZGF0aW9ucywgcG91cnJpZXotdm91cyBtZSBkaXJlIDpcXG5cXG7igKIgUXVlbGxlIGNvdWxldXIgZGUgdmluIHByw6lmw6lyZXotdm91cyA/IChSb3VnZSwgQmxhbmMsIFJvc8OpLCBvdSBFZmZlcnZlc2NlbnQpXFxu4oCiIFF1ZWxsZSBlc3Qgdm90cmUgZ2FtbWUgZGUgYnVkZ2V0ID8gKMOJY29ub21pcXVlIDog4oKsMC0xMCwgTWlsaWV1IGRlIGdhbW1lIDog4oKsMTAtMjUsIFByZW1pdW0gOiDigqwyNS01MCwgTHV4ZSA6IOKCrDUwKylcXG7igKIgUXVlbGxlIGVzdCBsJ29jY2FzaW9uIG91IGF2ZWMgcXVlbHMgcGxhdHMgbCdhY2NvbXBhZ25lcmV6LXZvdXMgP1wiLFxuICAgIG5sOiBcIklrIGhlbHAgdSBncmFhZyBkZSBwZXJmZWN0ZSB3aWpuIHRlIHZpbmRlbiEgT20gdSBkZSBiZXN0ZSBhYW5iZXZlbGluZ2VuIHRlIGdldmVuLCBrdW50IHUgbWUgdmVydGVsbGVuOlxcblxcbuKAoiBXZWxrZSB3aWpua2xldXIgaGVlZnQgdXcgdm9vcmtldXI/IChSb29kLCBXaXQsIFJvc8OpLCBvZiBNb3Vzc2VyZW5kZSlcXG7igKIgV2F0IGlzIHV3IGJ1ZGdldGJlcmVpaz8gKEJ1ZGdldDog4oKsMC0xMCwgTWlkZGVuc2VnbWVudDog4oKsMTAtMjUsIFByZW1pdW06IOKCrDI1LTUwLCBMdXhlOiDigqw1MCspXFxu4oCiIFdhdCBpcyBkZSBnZWxlZ2VuaGVpZCBvZiBiaWogd2VsayBldGVuIHdpbHQgdSBkZSB3aWpuIGNvbWJpbmVyZW4/XCIsXG4gIH1cblxuICByZXR1cm4gbWVzc2FnZXNbbGFuZ3VhZ2VdXG59XG5cbmZ1bmN0aW9uIGdlbmVyYXRlRmFsbGJhY2tSZXNwb25zZShtZXNzYWdlOiBzdHJpbmcsIHdpbmVzOiBXaW5lW10sIGxhbmd1YWdlOiBMYW5ndWFnZSk6IHN0cmluZyB7XG4gIGNvbnN0IHJlc3BvbnNlcyA9IHtcbiAgICBlbjogXCJCYXNlZCBvbiB5b3VyIHByZWZlcmVuY2VzLCBoZXJlIGFyZSBzb21lIGV4Y2VsbGVudCB3aW5lIG9wdGlvbnMgZnJvbSBvdXIgRGVsaGFpemUgc2VsZWN0aW9uLiBUaGVzZSB3aW5lcyB3b3VsZCBiZSBwZXJmZWN0IGZvciB5b3VyIG5lZWRzIVwiLFxuICAgIGZyOiBcIkJhc8OpIHN1ciB2b3MgcHLDqWbDqXJlbmNlcywgdm9pY2kgZCdleGNlbGxlbnRlcyBvcHRpb25zIGRlIHZpbiBkZSBub3RyZSBzw6lsZWN0aW9uIERlbGhhaXplLiBDZXMgdmlucyBzZXJhaWVudCBwYXJmYWl0cyBwb3VyIHZvcyBiZXNvaW5zICFcIixcbiAgICBubDogXCJPcCBiYXNpcyB2YW4gdXcgdm9vcmtldXJlbiB6aWpuIGhpZXIgZW5rZWxlIHVpdHN0ZWtlbmRlIHdpam5vcHRpZXMgdWl0IG9uemUgRGVsaGFpemUgc2VsZWN0aWUuIERlemUgd2lqbmVuIHpvdWRlbiBwZXJmZWN0IHppam4gdm9vciB1dyBiZWhvZWZ0ZW4hXCIsXG4gIH1cblxuICByZXR1cm4gcmVzcG9uc2VzW2xhbmd1YWdlXVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImdlbmVyYXRlVGV4dCIsIm9wZW5haSIsInBhcnNlUHJpY2UiLCJwcmljZVN0ciIsIm51bSIsInJlcGxhY2UiLCJwYXJzZUZsb2F0IiwiUE9TVCIsInJlcXVlc3QiLCJtZXNzYWdlIiwibGFuZ3VhZ2UiLCJ3aW5lcyIsImV4Y2x1ZGVJZHMiLCJoaXN0b3J5IiwianNvbiIsInRpbWluZ3MiLCJjYW5kaWRhdGVzIiwicHJvY2VzcyIsImVudiIsIk9QRU5BSV9BUElfS0VZIiwidDAiLCJEYXRlIiwibm93IiwidXJsIiwiVVJMIiwicGF0aG5hbWUiLCJzZWFyY2hQYXJhbXMiLCJzZXQiLCJyZXNwIiwiZmV0Y2giLCJ0b1N0cmluZyIsIm1ldGhvZCIsIm9rIiwiY29uc29sZSIsIndhcm4iLCJzdGF0dXMiLCJlcnIiLCJlcnJvciIsInB1c2giLCJzdGVwIiwiZHVyYXRpb24iLCJBcnJheSIsImlzQXJyYXkiLCJsZW5ndGgiLCJmaWx0ZXIiLCJ3IiwiaW5jbHVkZXMiLCJpZCIsInRleHQiLCJ0b0xvd2VyQ2FzZSIsInByaWNlTWF0Y2giLCJtYXRjaCIsInRocmVzaG9sZCIsIlByaWNlIiwidGVzdCIsInByaWNlcyIsIm1hcCIsInNvcnQiLCJhIiwiYiIsImlkeCIsIk1hdGgiLCJmbG9vciIsImRhdGFzZXQiLCJwcm9tcHREYXRhc2V0Iiwic2xpY2UiLCJzeXN0ZW1Qcm9tcHQiLCJnZXRTeXN0ZW1Qcm9tcHQiLCJjb252byIsIm0iLCJyb2xlIiwiY29udGVudCIsImpvaW4iLCJ1c2VyUHJvbXB0IiwiSlNPTiIsInN0cmluZ2lmeSIsImZhbGxiYWNrUmVjcyIsImdldFNpbXBsZUZhbGxiYWNrIiwiZ2VuZXJhdGVGYWxsYmFja1Jlc3BvbnNlIiwicmVjb21tZW5kYXRpb25zIiwidDEiLCJtb2RlbCIsInN5c3RlbSIsInByb21wdCIsIm1heFRva2VucyIsImxsbUR1cmF0aW9uIiwidDIiLCJleHRyYWN0UmVjb21tZW5kYXRpb25zRnJvbVJlc3BvbnNlIiwicmVjcyIsImxvd2VyIiwiZmlsdGVyZWQiLCJDb2xvciIsInJlc3BvbnNlIiwiaWRTZWN0aW9uIiwiaWRzIiwic3BsaXQiLCJzIiwidHJpbSIsIkJvb2xlYW4iLCJ3aW5lTWFwIiwiTWFwIiwiZm91bmRPcmRlcmVkIiwiZ2V0Iiwid2luZSIsInRpdGxlUmVnZXgiLCJ0aXRsZXMiLCJleGVjIiwibm9ybWFsaXplIiwibWF0Y2hlZEJ5VGl0bGUiLCJ0aXRsZSIsIm5vcm1UaXRsZSIsImZpbmQiLCJQcm9kdWN0X25hbWUiLCJzdGFydHNXaXRoIiwicmVjc0J5TmFtZSIsInJlc3BvbnNlVGV4dCIsImdldEludGVsbGlnZW50RmFsbGJhY2siLCJ3aW5lRGF0YVNhbXBsZSIsIm5hbWUiLCJwcmljZSIsInZvbHVtZSIsIlZvbHVtZSIsImRpc2NvdW50IiwicHJvbW90aW9uIiwiY29sb3IiLCJwcm9tcHRzIiwiZW4iLCJmciIsIm5sIiwiY2F0ZWdvcmllcyIsInJlZCIsIndoaXRlIiwic3BhcmtsaW5nIiwicm9zZSIsInJlbWFpbmluZyIsImdldEFza0ZvclByZWZlcmVuY2VzTWVzc2FnZSIsIm1lc3NhZ2VzIiwicmVzcG9uc2VzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./app/api/wine-advice/route.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry","vendor-chunks/zod-to-json-schema","vendor-chunks/zod","vendor-chunks/ai","vendor-chunks/@ai-sdk","vendor-chunks/eventsource-parser","vendor-chunks/nanoid","vendor-chunks/secure-json-parse"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fwine-advice%2Froute&page=%2Fapi%2Fwine-advice%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwine-advice%2Froute.ts&appDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2Fhome%2Fnishant%2Fproject%2Fv0%2FUI%2FSemantic-vaimo-virtual-sommelier&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();